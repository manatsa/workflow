import{a as ee}from"./chunk-YFSTPTS4.js";import{a as Z,b as $}from"./chunk-AIS23OW2.js";import{a as W,c as X,d as Y}from"./chunk-XZVKBWV7.js";import{b as H,c as J,e as K,i as Q}from"./chunk-IGML5J3D.js";import"./chunk-DLMMVLF7.js";import"./chunk-X4PFBHKL.js";import"./chunk-ORAJKTE5.js";import{b as P,d as g,f as N,g as I,j as F,l as y,m as O,o as T,q as w}from"./chunk-DUSDXFBS.js";import{a as j,b as k,c as q,d as G,f as V,g as z,h as R}from"./chunk-PWNKGTLH.js";import"./chunk-PSOPTTCW.js";import"./chunk-NMO4AZKI.js";import{a as U}from"./chunk-3QXD4PCM.js";import"./chunk-JQUVUDJB.js";import{j as b,m as E,qa as A,ra as B,ta as D,va as L}from"./chunk-A3I6STGM.js";import{Ab as h,Fb as u,Kb as t,Lb as e,Mb as l,Ub as _,bb as o,dc as i,ec as d,gb as p,nb as x,pc as v,rc as C,tb as f}from"./chunk-2HR56SRD.js";function te(a,c){a&1&&(t(0,"mat-error"),i(1,"Please enter a valid email"),e())}function ie(a,c){a&1&&(t(0,"mat-error"),i(1,"First name is required"),e())}function ne(a,c){a&1&&(t(0,"mat-error"),i(1,"Last name is required"),e())}function re(a,c){a&1&&i(0," Saving... ")}function ae(a,c){a&1&&i(0," Save Changes ")}var Pe=(()=>{class a{fb;authService;userService;snackBar;profileForm;loading=!1;lastLogin=null;createdAt=null;constructor(n,m,r,s){this.fb=n,this.authService=m,this.userService=r,this.snackBar=s,this.profileForm=this.fb.group({username:[""],email:["",g.email],firstName:["",g.required],lastName:["",g.required],phone:[""],staffId:[""],department:[""]})}ngOnInit(){this.loadProfile()}get fullName(){return this.authService.currentUser?.fullName||"User"}get userInitials(){return this.fullName.split(" ").map(m=>m[0]).join("").substring(0,2).toUpperCase()}get userType(){return this.authService.currentUser?.userType||"STAFF"}get roles(){return this.authService.currentUser?.roles?.join(", ")||"None"}loadProfile(){let n=this.authService.currentUser;n&&(this.profileForm.patchValue({username:n.username,email:n.email,firstName:n.firstName,lastName:n.lastName,phone:n.phone,staffId:n.staffId,department:n.department}),this.lastLogin=n.lastLogin?new Date(n.lastLogin):null,this.createdAt=n.createdAt?new Date(n.createdAt):null)}onSubmit(){if(this.profileForm.invalid)return;this.loading=!0;let n={email:this.profileForm.value.email,firstName:this.profileForm.value.firstName,lastName:this.profileForm.value.lastName,phone:this.profileForm.value.phone,department:this.profileForm.value.department};this.userService.updateProfile(n).subscribe({next:m=>{this.loading=!1,m.success?(this.snackBar.open("Profile updated successfully","Close",{duration:3e3}),this.authService.refreshCurrentUser()):this.snackBar.open(m.message||"Failed to update profile","Close",{duration:3e3})},error:m=>{this.loading=!1,this.snackBar.open(m.error?.message||"An error occurred","Close",{duration:3e3})}})}static \u0275fac=function(m){return new(m||a)(p(T),p(U),p(ee),p(Z))};static \u0275cmp=x({type:a,selectors:[["app-profile"]],decls:85,vars:19,consts:[[1,"profile-container"],[1,"profile-card"],["mat-card-avatar","",1,"avatar"],[3,"ngSubmit","formGroup"],[1,"form-row"],["appearance","outline",1,"form-field"],["matInput","","formControlName","username","readonly",""],["matPrefix",""],["matInput","","formControlName","email","type","email"],["matInput","","formControlName","firstName"],["matInput","","formControlName","lastName"],["matInput","","formControlName","phone"],["matInput","","formControlName","staffId","readonly",""],["appearance","outline",1,"form-field","full-width"],["matInput","","formControlName","department"],[1,"info-section"],[1,"info-grid"],[1,"info-item"],[1,"label"],[1,"value"],[1,"form-actions"],["mat-raised-button","","color","primary","type","submit",3,"disabled"]],template:function(m,r){if(m&1&&(t(0,"div",0)(1,"mat-card",1)(2,"mat-card-header")(3,"div",2),i(4),e(),t(5,"mat-card-title"),i(6),e(),t(7,"mat-card-subtitle"),i(8),e()(),t(9,"mat-card-content")(10,"form",3),_("ngSubmit",function(){return r.onSubmit()}),t(11,"div",4)(12,"mat-form-field",5)(13,"mat-label"),i(14,"Username"),e(),l(15,"input",6),t(16,"mat-icon",7),i(17,"person"),e()(),t(18,"mat-form-field",5)(19,"mat-label"),i(20,"Email"),e(),l(21,"input",8),t(22,"mat-icon",7),i(23,"email"),e(),f(24,te,2,0,"mat-error"),e()(),t(25,"div",4)(26,"mat-form-field",5)(27,"mat-label"),i(28,"First Name"),e(),l(29,"input",9),f(30,ie,2,0,"mat-error"),e(),t(31,"mat-form-field",5)(32,"mat-label"),i(33,"Last Name"),e(),l(34,"input",10),f(35,ne,2,0,"mat-error"),e()(),t(36,"div",4)(37,"mat-form-field",5)(38,"mat-label"),i(39,"Phone"),e(),l(40,"input",11),t(41,"mat-icon",7),i(42,"phone"),e()(),t(43,"mat-form-field",5)(44,"mat-label"),i(45,"Staff ID"),e(),l(46,"input",12),t(47,"mat-icon",7),i(48,"badge"),e()()(),t(49,"mat-form-field",13)(50,"mat-label"),i(51,"Department"),e(),l(52,"input",14),t(53,"mat-icon",7),i(54,"business"),e()(),t(55,"div",15)(56,"h4"),i(57,"Account Information"),e(),t(58,"div",16)(59,"div",17)(60,"span",18),i(61,"User Type"),e(),t(62,"span",19),i(63),e()(),t(64,"div",17)(65,"span",18),i(66,"Last Login"),e(),t(67,"span",19),i(68),v(69,"date"),e()(),t(70,"div",17)(71,"span",18),i(72,"Account Created"),e(),t(73,"span",19),i(74),v(75,"date"),e()(),t(76,"div",17)(77,"span",18),i(78,"Roles"),e(),t(79,"span",19),i(80),e()()()(),t(81,"div",20)(82,"button",21),f(83,re,1,0)(84,ae,1,0),e()()()()()()),m&2){let s,S,M;o(4),d(r.userInitials),o(2),d(r.fullName),o(2),d(r.userType),o(2),h("formGroup",r.profileForm),o(14),u((s=r.profileForm.get("email"))!=null&&s.hasError("email")?24:-1),o(6),u((S=r.profileForm.get("firstName"))!=null&&S.hasError("required")?30:-1),o(5),u((M=r.profileForm.get("lastName"))!=null&&M.hasError("required")?35:-1),o(28),d(r.userType),o(5),d(C(69,13,r.lastLogin,"medium")),o(6),d(C(75,16,r.createdAt,"medium")),o(6),d(r.roles),o(2),h("disabled",r.loading),o(),u(r.loading?83:84)}},dependencies:[E,b,w,F,P,N,I,y,O,R,j,z,q,V,G,k,W,Q,H,J,K,Y,X,L,D,B,A,$],styles:[".profile-container[_ngcontent-%COMP%]{padding:1rem;display:flex;justify-content:center}.profile-card[_ngcontent-%COMP%]{width:100%;max-width:700px}.avatar[_ngcontent-%COMP%]{width:56px!important;height:56px!important;border-radius:50%;background:#1976d2;color:#fff;display:flex;align-items:center;justify-content:center;font-size:1.25rem;font-weight:500}mat-card-header[_ngcontent-%COMP%]{margin-bottom:1.5rem}.form-row[_ngcontent-%COMP%]{display:flex;gap:1rem}.form-field[_ngcontent-%COMP%]{flex:1;margin-bottom:.5rem}.full-width[_ngcontent-%COMP%]{width:100%}.info-section[_ngcontent-%COMP%]{background:#f5f5f5;padding:1rem;border-radius:4px;margin:1rem 0}.info-section[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 .75rem;color:#333}.info-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);gap:.75rem}.info-item[_ngcontent-%COMP%]{display:flex;flex-direction:column}.info-item[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-size:.75rem;color:#666}.info-item[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-weight:500}.form-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;margin-top:1rem}"]})}return a})();export{Pe as ProfileComponent};
