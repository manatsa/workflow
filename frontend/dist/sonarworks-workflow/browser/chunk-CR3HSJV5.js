import{c as Ie,g as Re}from"./chunk-SHMTZN3K.js";import{c as U,d as Te,e as v,f as Ee,g as Pe}from"./chunk-JR55QIKH.js";import{a as De,b as Oe}from"./chunk-OJT3OVWQ.js";import"./chunk-M4AVZ6G2.js";import"./chunk-5LBLILVL.js";import{a as ce,b as de,c as ue,d as pe}from"./chunk-6Y7BGRIJ.js";import"./chunk-LAGNR76Q.js";import{a as fe,b as _e,c as Ce,d as ge,e as Me,f as he,g as xe,h as Se,i as be,j as Ue,k as ve,l as ke}from"./chunk-FEDFXP2D.js";import"./chunk-T6FL6ZBG.js";import{a as Le}from"./chunk-YFSTPTS4.js";import{a as we,b as ye}from"./chunk-AIS23OW2.js";import{a as le,c as me,d as se}from"./chunk-XZVKBWV7.js";import{b as oe,e as ae,i as re}from"./chunk-IGML5J3D.js";import"./chunk-DLMMVLF7.js";import"./chunk-X4PFBHKL.js";import"./chunk-ORAJKTE5.js";import{b as W,f as q,i as G,p as J}from"./chunk-DUSDXFBS.js";import{a as te,c as ie,h as ne}from"./chunk-PWNKGTLH.js";import"./chunk-PSOPTTCW.js";import"./chunk-NMO4AZKI.js";import{d as j,g as A}from"./chunk-JQUVUDJB.js";import{j as z,m as Q,qa as K,ra as X,sa as Y,ta as Z,va as ee}from"./chunk-A3I6STGM.js";import{$b as L,Ab as f,Db as P,Fb as S,Ib as D,Jb as O,Kb as i,Lb as n,Mb as h,Nb as u,Ob as p,Qb as b,Ub as C,Vb as d,Zb as w,_b as y,bb as l,cc as I,dc as o,ec as _,fc as T,gb as x,hc as R,ic as B,jc as F,mc as V,na as g,nb as E,nc as $,oa as M,pc as H,rc as N,tb as c}from"./chunk-2HR56SRD.js";var Be=()=>[10,25,50,100],Fe=e=>["/users",e],Ve=(e,a)=>a.id;function $e(e,a){e&1&&(i(0,"th",22),o(1,"Name"),n())}function He(e,a){if(e&1&&(i(0,"td",23)(1,"div",24)(2,"div",25),o(3),n(),i(4,"div")(5,"div",26),o(6),n(),i(7,"div",27),o(8),n()()()()),e&2){let t=a.$implicit,r=d();l(3),_(r.getInitials(t)),l(3),_(t.fullName),l(2),_(t.email)}}function Ne(e,a){e&1&&(i(0,"th",22),o(1,"Username"),n())}function ze(e,a){if(e&1&&(i(0,"td",23),o(1),n()),e&2){let t=a.$implicit;l(),_(t.username)}}function Qe(e,a){e&1&&(i(0,"th",22),o(1,"Type"),n())}function je(e,a){if(e&1&&(i(0,"td",23)(1,"span",28),o(2),n()()),e&2){let t=a.$implicit;l(),P(t.userType.toLowerCase()),l(),_(t.userType)}}function Ae(e,a){e&1&&(i(0,"th",29),o(1,"Roles"),n())}function We(e,a){if(e&1&&(i(0,"mat-chip"),o(1),n()),e&2){let t=a.$implicit;l(),_(t.name)}}function qe(e,a){if(e&1&&(i(0,"span",30),o(1),n()),e&2){let t=d().$implicit;l(),T("+",t.roles.length-2," more")}}function Ge(e,a){if(e&1&&(i(0,"td",23),D(1,We,2,1,"mat-chip",null,Ve),c(3,qe,2,1,"span",30),n()),e&2){let t=a.$implicit;l(),O(t.roles==null?null:t.roles.slice(0,2)),l(2),S((t.roles==null?null:t.roles.length)>2?3:-1)}}function Je(e,a){e&1&&(i(0,"th",22),o(1,"Status"),n())}function Ke(e,a){e&1&&(i(0,"span",31),o(1,"Locked"),n())}function Xe(e,a){e&1&&(i(0,"span",32),o(1,"Active"),n())}function Ye(e,a){e&1&&(i(0,"span",33),o(1,"Inactive"),n())}function Ze(e,a){if(e&1&&(i(0,"td",23),c(1,Ke,2,0,"span",31)(2,Xe,2,0,"span",32)(3,Ye,2,0,"span",33),n()),e&2){let t=a.$implicit;l(),S(t.locked?1:t.enabled?2:3)}}function et(e,a){e&1&&(i(0,"th",22),o(1,"Last Login"),n())}function tt(e,a){if(e&1&&(i(0,"td",23),o(1),H(2,"date"),n()),e&2){let t=a.$implicit;l(),T(" ",N(2,1,t.lastLogin,"short")," ")}}function it(e,a){e&1&&h(0,"th",29)}function nt(e,a){if(e&1){let t=b();i(0,"button",37),C("click",function(){g(t);let m=d().$implicit,s=d();return M(s.unlockUser(m))}),i(1,"mat-icon"),o(2,"lock_open"),n(),i(3,"span"),o(4,"Unlock"),n()()}}function ot(e,a){if(e&1){let t=b();i(0,"button",37),C("click",function(){g(t);let m=d().$implicit,s=d();return M(s.lockUser(m))}),i(1,"mat-icon"),o(2,"lock"),n(),i(3,"span"),o(4,"Lock"),n()()}}function at(e,a){if(e&1){let t=b();i(0,"td",23)(1,"button",34)(2,"mat-icon"),o(3,"more_vert"),n()(),i(4,"mat-menu",null,0)(6,"button",35)(7,"mat-icon"),o(8,"edit"),n(),i(9,"span"),o(10,"Edit"),n()(),c(11,nt,5,0,"button",36)(12,ot,5,0,"button",36),i(13,"button",37),C("click",function(){let m=g(t).$implicit,s=d();return M(s.resetPassword(m))}),i(14,"mat-icon"),o(15,"vpn_key"),n(),i(16,"span"),o(17,"Reset Password"),n()(),i(18,"button",38),C("click",function(){let m=g(t).$implicit,s=d();return M(s.deleteUser(m))}),i(19,"mat-icon"),o(20,"delete"),n(),i(21,"span"),o(22,"Delete"),n()()()()}if(e&2){let t=a.$implicit,r=I(5);l(),f("matMenuTriggerFor",r),l(5),f("routerLink",$(3,Fe,t.id)),l(5),S(t.locked?11:12)}}function rt(e,a){e&1&&h(0,"tr",39)}function lt(e,a){e&1&&h(0,"tr",40)}var Ht=(()=>{class e{userService;snackBar;dialog;displayedColumns=["fullName","username","userType","roles","status","lastLogin","actions"];dataSource=new ke([]);searchTerm="";paginator;sort;constructor(t,r,m){this.userService=t,this.snackBar=r,this.dialog=m}ngOnInit(){this.loadUsers()}ngAfterViewInit(){this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort}loadUsers(){this.userService.getUsers().subscribe(t=>{t.success&&(this.dataSource.data=t.data)})}applyFilter(){this.dataSource.filter=this.searchTerm.trim().toLowerCase()}getInitials(t){return(t.firstName?.[0]||"")+(t.lastName?.[0]||"")}lockUser(t){this.userService.lockUser(t.id).subscribe(r=>{r.success&&(this.snackBar.open("User locked successfully","Close",{duration:3e3}),this.loadUsers())})}unlockUser(t){this.userService.unlockUser(t.id).subscribe(r=>{r.success&&(this.snackBar.open("User unlocked successfully","Close",{duration:3e3}),this.loadUsers())})}resetPassword(t){this.userService.adminResetPassword(t.id).subscribe(r=>{r.success&&this.snackBar.open("Password reset email sent","Close",{duration:3e3})})}deleteUser(t){confirm(`Are you sure you want to delete ${t.fullName}?`)&&this.userService.deleteUser(t.id).subscribe(r=>{r.success&&(this.snackBar.open("User deleted successfully","Close",{duration:3e3}),this.loadUsers())})}static \u0275fac=function(r){return new(r||e)(x(Le),x(we),x(Ie))};static \u0275cmp=E({type:e,selectors:[["app-user-list"]],viewQuery:function(r,m){if(r&1&&(w(U,5),w(v,5)),r&2){let s;y(s=L())&&(m.paginator=s.first),y(s=L())&&(m.sort=s.first)}},decls:42,vars:6,consts:[["menu","matMenu"],[1,"user-list-container"],[1,"header"],["mat-raised-button","","color","primary","routerLink","/users/new"],[1,"table-toolbar"],["appearance","outline",1,"search-field"],["matInput","","placeholder","Search by name, username, or email",3,"ngModelChange","keyup","ngModel"],["matPrefix",""],["mat-table","","matSort","",1,"data-table",3,"dataSource"],["matColumnDef","fullName"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","username"],["matColumnDef","userType"],["matColumnDef","roles"],["mat-header-cell","",4,"matHeaderCellDef"],["matColumnDef","status"],["matColumnDef","lastLogin"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","",3,"pageSizeOptions"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],[1,"user-info"],[1,"avatar"],[1,"name"],[1,"email"],[1,"badge"],["mat-header-cell",""],[1,"more"],[1,"badge","locked"],[1,"badge","active"],[1,"badge","inactive"],["mat-icon-button","",3,"matMenuTriggerFor"],["mat-menu-item","",3,"routerLink"],["mat-menu-item",""],["mat-menu-item","",3,"click"],["mat-menu-item","",1,"delete-action",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(r,m){r&1&&(i(0,"div",1)(1,"div",2)(2,"h1"),o(3,"Users"),n(),i(4,"button",3)(5,"mat-icon"),o(6,"add"),n(),o(7," Add User "),n()(),i(8,"mat-card")(9,"mat-card-content")(10,"div",4)(11,"mat-form-field",5)(12,"mat-label"),o(13,"Search users"),n(),i(14,"input",6),F("ngModelChange",function(k){return B(m.searchTerm,k)||(m.searchTerm=k),k}),C("keyup",function(){return m.applyFilter()}),n(),i(15,"mat-icon",7),o(16,"search"),n()()(),i(17,"table",8),u(18,9),c(19,$e,2,0,"th",10)(20,He,9,3,"td",11),p(),u(21,12),c(22,Ne,2,0,"th",10)(23,ze,2,1,"td",11),p(),u(24,13),c(25,Qe,2,0,"th",10)(26,je,3,3,"td",11),p(),u(27,14),c(28,Ae,2,0,"th",15)(29,Ge,4,1,"td",11),p(),u(30,16),c(31,Je,2,0,"th",10)(32,Ze,4,1,"td",11),p(),u(33,17),c(34,et,2,0,"th",10)(35,tt,3,4,"td",11),p(),u(36,18),c(37,it,1,0,"th",15)(38,at,23,5,"td",11),p(),c(39,rt,1,0,"tr",19)(40,lt,1,0,"tr",20),n(),h(41,"mat-paginator",21),n()()()),r&2&&(l(14),R("ngModel",m.searchTerm),l(3),f("dataSource",m.dataSource),l(22),f("matHeaderRowDef",m.displayedColumns),l(),f("matRowDefColumns",m.displayedColumns),l(),f("pageSizeOptions",V(5,Be)))},dependencies:[Q,z,A,j,J,W,q,G,ne,te,ie,ve,fe,Ce,xe,ge,_e,Se,Me,he,be,Ue,Te,U,Pe,v,Ee,le,re,oe,ae,se,me,ee,Z,Y,X,K,pe,de,ce,ue,Oe,De,ye,Re],styles:[".user-list-container[_ngcontent-%COMP%]{padding:1rem}.header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem}.table-toolbar[_ngcontent-%COMP%]{margin-bottom:1rem}.search-field[_ngcontent-%COMP%]{width:400px}.data-table[_ngcontent-%COMP%]{width:100%}.user-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem}.avatar[_ngcontent-%COMP%]{width:36px;height:36px;border-radius:50%;background:#1976d2;color:#fff;display:flex;align-items:center;justify-content:center;font-size:.875rem;font-weight:500}.user-info[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-weight:500}.user-info[_ngcontent-%COMP%]   .email[_ngcontent-%COMP%]{font-size:.75rem;color:#666}.badge[_ngcontent-%COMP%]{padding:.25rem .5rem;border-radius:4px;font-size:.75rem;font-weight:500}.badge.active[_ngcontent-%COMP%]{background:#e8f5e9;color:#2e7d32}.badge.inactive[_ngcontent-%COMP%]{background:#f5f5f5;color:#666}.badge.locked[_ngcontent-%COMP%]{background:#ffebee;color:#c62828}.badge.system[_ngcontent-%COMP%]{background:#e3f2fd;color:#1565c0}.badge.staff[_ngcontent-%COMP%]{background:#e8f5e9;color:#2e7d32}.badge.manager[_ngcontent-%COMP%]{background:#fff3e0;color:#e65100}.badge.external[_ngcontent-%COMP%]{background:#f3e5f5;color:#7b1fa2}.more[_ngcontent-%COMP%]{font-size:.75rem;color:#666;margin-left:.25rem}.delete-action[_ngcontent-%COMP%]{color:#c62828}"]})}return e})();export{Ht as UserListComponent};
