import{a as Zt,b as $t}from"./chunk-UJ5KVTNX.js";import{a as Jt}from"./chunk-GKNOQT2V.js";import{a as Xt}from"./chunk-D362EOEZ.js";import{a as qt,b as Ht,f as Gt}from"./chunk-3QZG32TM.js";import{a as Vt,b as Qt,c as Ut,d as Wt}from"./chunk-YWWQJANS.js";import{a as H,b as L}from"./chunk-I4PAJBBT.js";import{c as Yt}from"./chunk-INV3KQYA.js";import{c as X,d as J,f as V,g as Q,h as tt}from"./chunk-W4BNGQYG.js";import{a as q,b as Ft,c as zt,d as Rt,e as Bt,f as jt,g as Nt,h as T}from"./chunk-ZLEDUOR5.js";import{b as Tt,c as Lt}from"./chunk-C5XODKZL.js";import"./chunk-LU6VCXUA.js";import{b as gt}from"./chunk-AGZT6V36.js";import{a as At,b as It}from"./chunk-CDWC6WKW.js";import{b as kt,c as Ct,e as Mt,f as St,i as Et,j as Pt,l as Dt,m as Ot}from"./chunk-ZS434AQM.js";import{d as ut,f as F,i as _t,j as ft,n as bt,q as vt,r as wt,u as xt,w as yt}from"./chunk-M3VCE5SG.js";import{a as Kt}from"./chunk-2UBRB5ZZ.js";import"./chunk-MNRHFUYD.js";import"./chunk-UF7Y5AYJ.js";import{h as et}from"./chunk-PMYQJTBZ.js";import{a as W}from"./chunk-W7JX3HPD.js";import{b as st,c as ct,d as lt,e as dt,g as mt}from"./chunk-M6HZK7Y7.js";import{Aa as I,R as pt,ga as M,m as rt,q as P,ta as ht,va as D,wa as O,xa as A,ya as U}from"./chunk-37H25STD.js";import{Eb as h,Gb as f,Hb as Z,Jb as m,Lb as ot,Mb as k,Nb as C,Ob as e,Pb as t,Qb as g,Ub as B,Yb as u,Zb as b,a as nt,b as at,ba as S,eb as r,gc as $,hc as i,ic as c,jb as _,jc as j,oa as x,pa as y,qb as w,rb as E,rc as N,tc as Y,vc as K,wb as p}from"./chunk-UYCZSUYP.js";var oe=(()=>{class a{static \u0275fac=function(s){return new(s||a)};static \u0275mod=E({type:a});static \u0275inj=S({imports:[M,et,et,M]})}return a})();var re=(()=>{class a{static \u0275fac=function(s){return new(s||a)};static \u0275mod=E({type:a});static \u0275inj=S({imports:[M,M]})}return a})();var se=(()=>{class a{static \u0275fac=function(s){return new(s||a)};static \u0275mod=E({type:a});static \u0275inj=S({imports:[pt,M,ht,gt,L]})}return a})();var we=(a,d)=>d.id;function xe(a,d){if(a&1&&(e(0,"span",18),i(1),t()),a&2){let o=d.$implicit;r(),c(o)}}function ye(a,d){if(a&1&&k(0,xe,2,1,"span",18,ot),a&2){let o=b();C(o.data.roles)}}function ke(a,d){a&1&&(e(0,"span",15),i(1,"No roles assigned"),t())}function Ce(a,d){if(a&1&&(e(0,"span",19),i(1),t()),a&2){let o=d.$implicit;r(),c(o.name)}}function Me(a,d){if(a&1&&(g(0,"mat-divider"),e(1,"div",7)(2,"h4")(3,"mat-icon"),i(4,"business"),t(),i(5," Business Units"),t(),e(6,"div",14),k(7,Ce,2,1,"span",19,we),t()()),a&2){let o=b();r(7),C(o.data.sbus)}}var me=(()=>{class a{dialogRef;data;constructor(o,s){this.dialogRef=o,this.data=s}get userInitials(){return(this.data.fullName||"").split(" ").map(s=>s[0]).join("").substring(0,2).toUpperCase()}static \u0275fac=function(s){return new(s||a)(_(q),_(Ft))};static \u0275cmp=w({type:a,selectors:[["app-profile-dialog"]],decls:98,vars:28,consts:[[1,"profile-dialog"],[1,"profile-header"],[1,"avatar"],[1,"header-info"],[1,"user-type"],["mat-icon-button","","mat-dialog-close","",1,"close-btn"],[1,"profile-content"],[1,"info-section"],[1,"info-grid"],[1,"info-item"],[1,"label"],[1,"value"],[1,"info-item","full-width"],[1,"value","badge"],[1,"chips-container"],[1,"no-data"],[1,"dialog-actions"],["mat-button","","mat-dialog-close",""],[1,"role-chip"],[1,"sbu-chip"]],template:function(s,n){s&1&&(e(0,"div",0)(1,"div",1)(2,"div",2),i(3),t(),e(4,"div",3)(5,"h2"),i(6),t(),e(7,"span",4),i(8),t()(),e(9,"button",5)(10,"mat-icon"),i(11,"close"),t()()(),g(12,"mat-divider"),e(13,"div",6)(14,"div",7)(15,"h4")(16,"mat-icon"),i(17,"person"),t(),i(18," Personal Information"),t(),e(19,"div",8)(20,"div",9)(21,"span",10),i(22,"Username"),t(),e(23,"span",11),i(24),t()(),e(25,"div",9)(26,"span",10),i(27,"Email"),t(),e(28,"span",11),i(29),t()(),e(30,"div",9)(31,"span",10),i(32,"First Name"),t(),e(33,"span",11),i(34),t()(),e(35,"div",9)(36,"span",10),i(37,"Last Name"),t(),e(38,"span",11),i(39),t()(),e(40,"div",9)(41,"span",10),i(42,"Phone"),t(),e(43,"span",11),i(44),t()(),e(45,"div",9)(46,"span",10),i(47,"Staff ID"),t(),e(48,"span",11),i(49),t()(),e(50,"div",12)(51,"span",10),i(52,"Department"),t(),e(53,"span",11),i(54),t()()()(),g(55,"mat-divider"),e(56,"div",7)(57,"h4")(58,"mat-icon"),i(59,"security"),t(),i(60," Account Information"),t(),e(61,"div",8)(62,"div",9)(63,"span",10),i(64,"User Type"),t(),e(65,"span",13),i(66),t()(),e(67,"div",9)(68,"span",10),i(69,"Account Status"),t(),e(70,"span",13),i(71),t()(),e(72,"div",9)(73,"span",10),i(74,"Last Login"),t(),e(75,"span",11),i(76),Y(77,"date"),t()(),e(78,"div",9)(79,"span",10),i(80,"Account Created"),t(),e(81,"span",11),i(82),Y(83,"date"),t()()()(),g(84,"mat-divider"),e(85,"div",7)(86,"h4")(87,"mat-icon"),i(88,"admin_panel_settings"),t(),i(89," Roles"),t(),e(90,"div",14),p(91,ye,2,0)(92,ke,2,0,"span",15),t()(),p(93,Me,9,0),t(),g(94,"mat-divider"),e(95,"div",16)(96,"button",17),i(97,"Close"),t()()()),s&2&&(r(3),c(n.userInitials),r(3),c(n.data.fullName),r(2),c(n.data.userType),r(16),c(n.data.username),r(5),c(n.data.email||"-"),r(5),c(n.data.firstName||"-"),r(5),c(n.data.lastName||"-"),r(5),c(n.data.phoneNumber||"-"),r(5),c(n.data.staffId||"-"),r(5),c(n.data.department||"-"),r(11),Z(n.data.userType.toLowerCase()),r(),c(n.data.userType),r(4),f("active",n.data.isActive)("inactive",!n.data.isActive),r(),j(" ",n.data.isActive?"Active":"Inactive"," "),r(5),c(n.data.lastLogin?K(77,22,n.data.lastLogin,"medium"):"Never"),r(6),c(n.data.createdAt?K(83,25,n.data.createdAt,"medium"):"-"),r(9),m(n.data.roles&&n.data.roles.length>0?91:92),r(2),m(n.data.sbus&&n.data.sbus.length>0?93:-1))},dependencies:[P,rt,T,Rt,I,U,A,O,D,L,H,Yt],styles:[".profile-dialog[_ngcontent-%COMP%]{min-width:500px;max-width:600px}.profile-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;padding:1.5rem;position:relative}.avatar[_ngcontent-%COMP%]{width:64px;height:64px;border-radius:50%;background:linear-gradient(135deg,#1976d2,#1565c0);color:#fff;display:flex;align-items:center;justify-content:center;font-size:1.5rem;font-weight:500}.header-info[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:1.5rem}.user-type[_ngcontent-%COMP%]{color:#666;font-size:.875rem}.close-btn[_ngcontent-%COMP%]{position:absolute;top:.5rem;right:.5rem}.profile-content[_ngcontent-%COMP%]{padding:0 1.5rem;max-height:60vh;overflow-y:auto}.info-section[_ngcontent-%COMP%]{padding:1rem 0}.info-section[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 1rem;display:flex;align-items:center;gap:.5rem;color:#1976d2;font-size:.9rem;text-transform:uppercase;letter-spacing:.5px}.info-section[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:1.25rem;width:1.25rem;height:1.25rem}.info-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);gap:1rem}.info-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.25rem}.info-item.full-width[_ngcontent-%COMP%]{grid-column:1/-1}.info-item[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-size:.75rem;color:#666;text-transform:uppercase;letter-spacing:.5px}.info-item[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-size:.95rem;font-weight:500;color:#333}.badge[_ngcontent-%COMP%]{display:inline-block;padding:.25rem .5rem;border-radius:4px;font-size:.75rem;width:fit-content}.badge.system[_ngcontent-%COMP%]{background:#e3f2fd;color:#1565c0}.badge.staff[_ngcontent-%COMP%]{background:#f5f5f5;color:#666}.badge.manager[_ngcontent-%COMP%]{background:#fff3e0;color:#e65100}.badge.external[_ngcontent-%COMP%]{background:#fce4ec;color:#c62828}.badge.active[_ngcontent-%COMP%]{background:#e8f5e9;color:#2e7d32}.badge.inactive[_ngcontent-%COMP%]{background:#ffebee;color:#c62828}.chips-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:.5rem}.role-chip[_ngcontent-%COMP%], .sbu-chip[_ngcontent-%COMP%]{padding:.375rem .75rem;border-radius:16px;font-size:.8rem;font-weight:500}.role-chip[_ngcontent-%COMP%]{background:#e3f2fd;color:#1565c0}.sbu-chip[_ngcontent-%COMP%]{background:#f3e5f5;color:#7b1fa2}.no-data[_ngcontent-%COMP%]{color:#999;font-style:italic}.dialog-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;padding:1rem 1.5rem}"]})}return a})();function Ee(a,d){if(a&1&&(e(0,"div",3),i(1),t()),a&2){let o=b();r(),c(o.errorMessage)}}function Pe(a,d){a&1&&(e(0,"mat-error"),i(1,"Current password is required"),t())}function De(a,d){a&1&&(e(0,"mat-error"),i(1,"New password is required"),t())}function Oe(a,d){a&1&&(e(0,"mat-error"),i(1,"Password must be at least 8 characters"),t())}function Ae(a,d){a&1&&(e(0,"mat-error"),i(1,"Please confirm your new password"),t())}function Ie(a,d){a&1&&(e(0,"mat-error"),i(1,"Passwords do not match"),t())}function Te(a,d){a&1&&g(0,"mat-spinner",15)}function Le(a,d){a&1&&i(0," Change Password ")}var pe=(()=>{class a{fb;authService;dialogRef;snackBar;changePasswordForm;loading=!1;hideCurrentPassword=!0;hideNewPassword=!0;hideConfirmPassword=!0;errorMessage="";constructor(o,s,n,l){this.fb=o,this.authService=s,this.dialogRef=n,this.snackBar=l,this.changePasswordForm=this.fb.group({currentPassword:["",F.required],newPassword:["",[F.required,F.minLength(8)]],confirmPassword:["",F.required]},{validators:this.passwordMatchValidator})}passwordMatchValidator(o){let s=o.get("newPassword")?.value,n=o.get("confirmPassword")?.value;return s===n?null:{passwordMismatch:!0}}get newPassword(){return this.changePasswordForm.get("newPassword")?.value||""}get hasMinLength(){return this.newPassword.length>=8}get hasUppercase(){return/[A-Z]/.test(this.newPassword)}get hasLowercase(){return/[a-z]/.test(this.newPassword)}get hasNumber(){return/[0-9]/.test(this.newPassword)}get hasSpecial(){return/[!@#$%^&*(),.?":{}|<>]/.test(this.newPassword)}onSubmit(){if(this.changePasswordForm.invalid)return;this.loading=!0,this.errorMessage="";let{currentPassword:o,newPassword:s,confirmPassword:n}=this.changePasswordForm.value;this.authService.changePassword(o,s,n).subscribe({next:l=>{this.loading=!1,l.success?(this.snackBar.open("Password changed successfully","Close",{duration:3e3}),this.dialogRef.close(!0)):this.errorMessage=l.message||"Failed to change password"},error:l=>{this.loading=!1,this.errorMessage=l.error?.message||"An error occurred. Please try again."}})}close(){this.dialogRef.close()}static \u0275fac=function(s){return new(s||a)(_(xt),_(W),_(q),_(Tt))};static \u0275cmp=w({type:a,selectors:[["app-change-password-dialog"]],decls:63,vars:25,consts:[[1,"dialog-header"],["mat-dialog-title",""],["mat-icon-button","",3,"click"],[1,"error-message"],[3,"ngSubmit","formGroup"],["appearance","outline",1,"form-field"],["matInput","","formControlName","currentPassword","autocomplete","current-password",3,"type"],["matPrefix",""],["mat-icon-button","","matSuffix","","type","button",3,"click"],["matInput","","formControlName","newPassword","autocomplete","new-password",3,"type"],["matInput","","formControlName","confirmPassword","autocomplete","new-password",3,"type"],[1,"password-requirements"],["align","end"],["mat-button","",3,"click"],["mat-raised-button","","color","primary",3,"click","disabled"],["diameter","20"]],template:function(s,n){if(s&1&&(e(0,"div",0)(1,"h2",1)(2,"mat-icon"),i(3,"lock"),t(),i(4," Change Password "),t(),e(5,"button",2),u("click",function(){return n.close()}),e(6,"mat-icon"),i(7,"close"),t()()(),e(8,"mat-dialog-content"),p(9,Ee,2,1,"div",3),e(10,"form",4),u("ngSubmit",function(){return n.onSubmit()}),e(11,"mat-form-field",5)(12,"mat-label"),i(13,"Current Password"),t(),g(14,"input",6),e(15,"mat-icon",7),i(16,"lock"),t(),e(17,"button",8),u("click",function(){return n.hideCurrentPassword=!n.hideCurrentPassword}),e(18,"mat-icon"),i(19),t()(),p(20,Pe,2,0,"mat-error"),t(),e(21,"mat-form-field",5)(22,"mat-label"),i(23,"New Password"),t(),g(24,"input",9),e(25,"mat-icon",7),i(26,"lock_outline"),t(),e(27,"button",8),u("click",function(){return n.hideNewPassword=!n.hideNewPassword}),e(28,"mat-icon"),i(29),t()(),p(30,De,2,0,"mat-error")(31,Oe,2,0,"mat-error"),t(),e(32,"mat-form-field",5)(33,"mat-label"),i(34,"Confirm New Password"),t(),g(35,"input",10),e(36,"mat-icon",7),i(37,"lock_outline"),t(),e(38,"button",8),u("click",function(){return n.hideConfirmPassword=!n.hideConfirmPassword}),e(39,"mat-icon"),i(40),t()(),p(41,Ae,2,0,"mat-error")(42,Ie,2,0,"mat-error"),t(),e(43,"div",11)(44,"h4"),i(45,"Password Requirements:"),t(),e(46,"ul")(47,"li"),i(48,"At least 8 characters"),t(),e(49,"li"),i(50,"At least one uppercase letter"),t(),e(51,"li"),i(52,"At least one lowercase letter"),t(),e(53,"li"),i(54,"At least one number"),t(),e(55,"li"),i(56,"At least one special character"),t()()()()(),e(57,"mat-dialog-actions",12)(58,"button",13),u("click",function(){return n.close()}),i(59,"Cancel"),t(),e(60,"button",14),u("click",function(){return n.onSubmit()}),p(61,Te,1,0,"mat-spinner",15)(62,Le,1,0),t()()),s&2){let l,v,R,it;r(9),m(n.errorMessage?9:-1),r(),h("formGroup",n.changePasswordForm),r(4),h("type",n.hideCurrentPassword?"password":"text"),r(5),c(n.hideCurrentPassword?"visibility_off":"visibility"),r(),m((l=n.changePasswordForm.get("currentPassword"))!=null&&l.hasError("required")?20:-1),r(4),h("type",n.hideNewPassword?"password":"text"),r(5),c(n.hideNewPassword?"visibility_off":"visibility"),r(),m((v=n.changePasswordForm.get("newPassword"))!=null&&v.hasError("required")?30:-1),r(),m((R=n.changePasswordForm.get("newPassword"))!=null&&R.hasError("minlength")?31:-1),r(4),h("type",n.hideConfirmPassword?"password":"text"),r(5),c(n.hideConfirmPassword?"visibility_off":"visibility"),r(),m((it=n.changePasswordForm.get("confirmPassword"))!=null&&it.hasError("required")?41:-1),r(),m(n.changePasswordForm.hasError("passwordMismatch")?42:-1),r(5),f("met",n.hasMinLength),r(2),f("met",n.hasUppercase),r(2),f("met",n.hasLowercase),r(2),f("met",n.hasNumber),r(2),f("met",n.hasSpecial),r(5),h("disabled",n.loading||n.changePasswordForm.invalid),r(),m(n.loading?61:62)}},dependencies:[P,yt,bt,ut,_t,ft,vt,wt,T,Bt,Nt,jt,Pt,Et,kt,Ct,Mt,St,Ot,Dt,I,U,A,O,D,It,At,Lt],styles:['@charset "UTF-8";.dialog-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:0 16px}.dialog-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;margin:0}mat-dialog-content[_ngcontent-%COMP%]{min-width:400px;max-width:500px}.form-field[_ngcontent-%COMP%]{width:100%;margin-bottom:.5rem}.error-message[_ngcontent-%COMP%]{background:#ffebee;color:#c62828;padding:.75rem;border-radius:4px;margin-bottom:1rem}.password-requirements[_ngcontent-%COMP%]{background:#f5f5f5;padding:1rem;border-radius:4px;margin-top:.5rem}.password-requirements[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 .5rem;font-size:.875rem}.password-requirements[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{margin:0;padding-left:1.25rem;font-size:.8rem}.password-requirements[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{color:#666;margin-bottom:.25rem}.password-requirements[_ngcontent-%COMP%]   li.met[_ngcontent-%COMP%]{color:#2e7d32}.password-requirements[_ngcontent-%COMP%]   li.met[_ngcontent-%COMP%]::marker{content:"\\2713  "}mat-dialog-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   mat-spinner[_ngcontent-%COMP%]{display:inline-block}']})}return a})();var Fe=a=>["/workflows/builder",a],ze=a=>["/workflows",a,"instances"],Re=a=>["/reports",a],G=(a,d)=>d.id;function Be(a,d){a&1&&(e(0,"mat-expansion-panel",12)(1,"mat-expansion-panel-header")(2,"mat-icon"),i(3,"admin_panel_settings"),t(),e(4,"span"),i(5,"System Admin"),t()(),e(6,"div",14)(7,"a",38)(8,"mat-icon"),i(9,"people"),t(),e(10,"span"),i(11,"Users"),t()(),e(12,"a",39)(13,"mat-icon"),i(14,"security"),t(),e(15,"span"),i(16,"Roles"),t()(),e(17,"a",40)(18,"mat-icon"),i(19,"category"),t(),e(20,"span"),i(21,"Categories"),t()(),e(22,"a",41)(23,"mat-icon"),i(24,"corporate_fare"),t(),e(25,"span"),i(26,"Corporates"),t()(),e(27,"a",42)(28,"mat-icon"),i(29,"business"),t(),e(30,"span"),i(31,"SBU Management"),t()(),e(32,"a",43)(33,"mat-icon"),i(34,"store"),t(),e(35,"span"),i(36,"Branches"),t()(),e(37,"a",44)(38,"mat-icon"),i(39,"account_tree"),t(),e(40,"span"),i(41,"Departments"),t()(),e(42,"a",45)(43,"mat-icon"),i(44,"settings"),t(),e(45,"span"),i(46,"Settings"),t()(),e(47,"a",46)(48,"mat-icon"),i(49,"history"),t(),e(50,"span"),i(51,"Audit Logs"),t()()()())}function je(a,d){if(a&1&&(e(0,"a",15)(1,"mat-icon"),i(2,"edit"),t(),e(3,"span"),i(4),t()()),a&2){let o=d.$implicit;h("routerLink",N(2,Fe,o.id)),r(4),c(o.name)}}function Ne(a,d){if(a&1&&(e(0,"mat-expansion-panel",12)(1,"mat-expansion-panel-header")(2,"mat-icon"),i(3,"build"),t(),e(4,"span"),i(5,"Workflow Admin"),t()(),e(6,"div",14)(7,"a",47)(8,"mat-icon"),i(9,"storage"),t(),e(10,"span"),i(11,"SQL Objects"),t()(),e(12,"a",48)(13,"mat-icon"),i(14,"list"),t(),e(15,"span"),i(16,"Manage Workflows"),t()(),k(17,je,5,4,"a",15,G),t()()),a&2){let o=b();r(17),C(o.workflows)}}function Ve(a,d){if(a&1&&(e(0,"a",15)(1,"mat-icon"),i(2),t(),e(3,"span"),i(4),t()()),a&2){let o=d.$implicit;h("routerLink",N(3,ze,o.code)),r(2),c(o.icon||"description"),r(2),c(o.name)}}function Qe(a,d){if(a&1&&(e(0,"span",18),i(1),t()),a&2){let o=b();r(),c(o.pendingApprovalsCount)}}function Ue(a,d){if(a&1&&(e(0,"span",21),i(1),t()),a&2){let o=b();r(),c(o.mySubmissionsCount)}}function We(a,d){if(a&1&&(e(0,"a",15)(1,"mat-icon"),i(2),t(),e(3,"span"),i(4),t()()),a&2){let o=d.$implicit;h("routerLink",N(3,Re,o.id)),r(2),c(o.icon),r(2),c(o.name)}}function qe(a,d){if(a&1&&(e(0,"mat-expansion-panel",23)(1,"mat-expansion-panel-header")(2,"mat-icon"),i(3),t(),e(4,"span"),i(5),t()(),e(6,"div",49),k(7,We,5,5,"a",15,G),t()()),a&2){let o=d.$implicit;r(3),c(o.icon),r(2),c(o.name),r(2),C(o.reports)}}function He(a,d){a&1&&(e(0,"span"),i(1,"About"),t())}var vn=(()=>{class a{authService;workflowService;themeService;reportService;router;dialog;workflows=[];activeWorkflows=[];reportCategories=[];sidebarOpen=!0;footerCollapsed=!1;pendingApprovalsCount=0;mySubmissionsCount=0;currentYear=new Date().getFullYear();constructor(o,s,n,l,v,R){this.authService=o,this.workflowService=s,this.themeService=n,this.reportService=l,this.router=v,this.dialog=R}ngOnInit(){this.themeService.loadTheme(),this.loadWorkflows(),this.loadPendingApprovalsCount(),this.loadMySubmissionsCount(),this.loadReportCategories()}loadReportCategories(){let o=this.reportService.getReportCategories(),s=this.reportService.getAllReports();this.reportCategories=o.map(n=>at(nt({},n),{reports:s.filter(l=>l.category===n.id).map(l=>({id:l.id,name:l.name,icon:l.icon}))}))}loadPendingApprovalsCount(){this.workflowService.getPendingApprovalsCount().subscribe({next:o=>{o.success&&(this.pendingApprovalsCount=o.data||0)},error:()=>{this.pendingApprovalsCount=0}})}loadMySubmissionsCount(){this.workflowService.getMySubmissionsCount().subscribe({next:o=>{o.success&&(this.mySubmissionsCount=o.data||0)},error:()=>{this.mySubmissionsCount=0}})}get fullName(){return this.authService.currentUser?.fullName||"User"}get userInitials(){return this.fullName.split(" ").map(s=>s[0]).join("").substring(0,2).toUpperCase()}get userType(){return this.authService.currentUser?.userType||"STAFF"}get isAdmin(){return this.authService.hasRole("ROLE_ADMIN")||this.authService.hasPrivilege("ADMIN")}get canBuildWorkflows(){return this.isAdmin||this.authService.hasPrivilege("WORKFLOW_BUILDER")}loadWorkflows(){this.workflowService.getWorkflows().subscribe(o=>{o.success&&(this.workflows=o.data)}),this.workflowService.getActiveWorkflows().subscribe(o=>{o.success&&(this.activeWorkflows=o.data)})}toggleSidebar(){this.sidebarOpen=!this.sidebarOpen}toggleFooter(){this.footerCollapsed=!this.footerCollapsed}logout(){this.authService.logout()}openProfileDialog(){let o=this.authService.currentUser;o&&this.dialog.open(me,{width:"600px",data:{username:o.username,email:o.email,firstName:o.firstName,lastName:o.lastName,fullName:o.fullName,phoneNumber:o.phoneNumber,staffId:o.staffId,department:o.department,userType:o.userType,roles:o.roles||[],sbus:[],lastLogin:o.lastLogin,createdAt:o.createdAt,isActive:!0,isLocked:!1}})}openChangePasswordDialog(){this.dialog.open(pe,{width:"500px",disableClose:!0})}static \u0275fac=function(s){return new(s||a)(_(W),_(Kt),_(Xt),_(Jt),_(ct),_(zt))};static \u0275cmp=w({type:a,selectors:[["app-main-layout"]],decls:90,vars:23,consts:[["userMenu","matMenu"],[1,"layout-container"],[1,"sidebar"],[1,"sidebar-header"],["src","assets/sonar_logo.png","alt","Sonarworks",1,"brand-logo"],[1,"user-profile"],[1,"avatar"],[1,"user-info"],[1,"name"],[1,"role"],[1,"sidebar-nav"],["routerLink","/dashboard","routerLinkActive","active",1,"menu-item"],[1,"nav-panel"],[1,"nav-panel",3,"expanded"],[1,"submenu"],[1,"menu-item",3,"routerLink"],["routerLink","/approvals","routerLinkActive","active",1,"menu-item"],["matBadgeColor","warn","matBadgeSize","small",3,"matBadge","matBadgeHidden"],[1,"badge-count"],["routerLink","/my-submissions","routerLinkActive","active",1,"menu-item"],["matBadgeColor","primary","matBadgeSize","small",3,"matBadge","matBadgeHidden"],[1,"badge-count","primary"],[1,"submenu","reports-submenu"],[1,"nav-panel","nested-panel"],[1,"sidebar-footer"],[1,"footer-toggle",3,"click"],[1,"toggle-icon"],[1,"footer-content"],[1,"developer"],[1,"copyright"],[1,"main-content"],[1,"main-header"],[1,"header-left"],["mat-icon-button","",3,"click"],[1,"header-right"],["mat-icon-button","",3,"matMenuTriggerFor"],["mat-menu-item","",3,"click"],[1,"page-content"],["routerLink","/users","routerLinkActive","active",1,"menu-item"],["routerLink","/roles","routerLinkActive","active",1,"menu-item"],["routerLink","/categories","routerLinkActive","active",1,"menu-item"],["routerLink","/corporates","routerLinkActive","active",1,"menu-item"],["routerLink","/sbus","routerLinkActive","active",1,"menu-item"],["routerLink","/branches","routerLinkActive","active",1,"menu-item"],["routerLink","/departments","routerLinkActive","active",1,"menu-item"],["routerLink","/settings","routerLinkActive","active",1,"menu-item"],["routerLink","/audit","routerLinkActive","active",1,"menu-item"],["routerLink","/sql-objects","routerLinkActive","active",1,"menu-item"],["routerLink","/workflows","routerLinkActive","active",1,"menu-item"],[1,"submenu","nested-submenu"]],template:function(s,n){if(s&1){let l=B();e(0,"div",1)(1,"aside",2)(2,"div",3),g(3,"img",4),t(),e(4,"div",5)(5,"div",6),i(6),t(),e(7,"div",7)(8,"div",8),i(9),t(),e(10,"div",9),i(11),t()()(),e(12,"nav",10)(13,"a",11)(14,"mat-icon"),i(15,"dashboard"),t(),e(16,"span"),i(17,"Home"),t()(),p(18,Be,52,0,"mat-expansion-panel",12)(19,Ne,19,0,"mat-expansion-panel",12),e(20,"mat-expansion-panel",13)(21,"mat-expansion-panel-header")(22,"mat-icon"),i(23,"timeline"),t(),e(24,"span"),i(25,"Workflows"),t()(),e(26,"div",14),k(27,Ve,5,5,"a",15,G),t()(),e(29,"a",16)(30,"mat-icon",17),i(31,"thumb_up"),t(),e(32,"span"),i(33,"Pending Approvals"),t(),p(34,Qe,2,1,"span",18),t(),e(35,"a",19)(36,"mat-icon",20),i(37,"send"),t(),e(38,"span"),i(39,"My Submissions"),t(),p(40,Ue,2,1,"span",21),t(),e(41,"mat-expansion-panel",12)(42,"mat-expansion-panel-header")(43,"mat-icon"),i(44,"assessment"),t(),e(45,"span"),i(46,"Reports"),t()(),e(47,"div",22),k(48,qe,9,2,"mat-expansion-panel",23,G),t()()(),e(50,"div",24)(51,"div",25),u("click",function(){return x(l),y(n.toggleFooter())}),p(52,He,2,0,"span"),e(53,"mat-icon",26),i(54),t()(),e(55,"div",27)(56,"div",28),i(57,"Developed By: Sonar Microsystems"),t(),e(58,"div",29),i(59),t()()()(),e(60,"main",30)(61,"header",31)(62,"div",32)(63,"button",33),u("click",function(){return x(l),y(n.toggleSidebar())}),e(64,"mat-icon"),i(65,"menu"),t()()(),e(66,"div",34)(67,"button",35)(68,"mat-icon"),i(69,"account_circle"),t()(),e(70,"mat-menu",null,0)(72,"button",36),u("click",function(){return x(l),y(n.openProfileDialog())}),e(73,"mat-icon"),i(74,"person"),t(),e(75,"span"),i(76,"Profile"),t()(),e(77,"button",36),u("click",function(){return x(l),y(n.openChangePasswordDialog())}),e(78,"mat-icon"),i(79,"lock"),t(),e(80,"span"),i(81,"Change Password"),t()(),g(82,"mat-divider"),e(83,"button",36),u("click",function(){return x(l),y(n.logout())}),e(84,"mat-icon"),i(85,"exit_to_app"),t(),e(86,"span"),i(87,"Logout"),t()()()()(),e(88,"div",37),g(89,"router-outlet"),t()()()}if(s&2){let l=$(71);r(),f("collapsed",!n.sidebarOpen),r(5),c(n.userInitials),r(3),c(n.fullName),r(2),c(n.userType),r(7),m(n.isAdmin?18:-1),r(),m(n.canBuildWorkflows?19:-1),r(),h("expanded",!0),r(7),C(n.activeWorkflows),r(3),h("matBadge",n.pendingApprovalsCount>0?n.pendingApprovalsCount:null)("matBadgeHidden",n.pendingApprovalsCount===0),r(4),m(n.pendingApprovalsCount>0?34:-1),r(2),h("matBadge",n.mySubmissionsCount>0?n.mySubmissionsCount:null)("matBadgeHidden",n.mySubmissionsCount===0),r(4),m(n.mySubmissionsCount>0?40:-1),r(8),C(n.reportCategories),r(2),f("collapsed",n.footerCollapsed),r(2),m(n.footerCollapsed?-1:52),r(2),c(n.footerCollapsed?"expand_less":"expand_more"),r(),h("@footerExpand",n.footerCollapsed?"collapsed":"expanded"),r(4),j("v1.0.0 | \xA9 ",n.currentYear," All Rights Reserved"),r(),f("expanded",!n.sidebarOpen),r(7),h("matMenuTriggerFor",l)}},dependencies:[P,mt,st,lt,dt,oe,re,se,H,O,D,I,A,Wt,Qt,Vt,Ut,Gt,qt,Ht,$t,Zt,L,T],styles:[".layout-container[_ngcontent-%COMP%]{display:flex;min-height:100vh}.sidebar[_ngcontent-%COMP%]{width:260px;background:var(--sidebar-bg, #263238);color:var(--sidebar-text, white);display:flex;flex-direction:column;position:fixed;left:0;top:0;height:100vh;z-index:1000}.sidebar-header[_ngcontent-%COMP%]{padding:1rem;background:var(--sidebar-header-bg, #1e272c);display:flex;align-items:center;justify-content:center;gap:.5rem;font-size:1.25rem;font-weight:500}.brand-logo[_ngcontent-%COMP%]{max-width:180px;max-height:50px;object-fit:contain}.user-profile[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;padding:1rem;background:var(--user-profile-bg, #1e272c);color:var(--user-profile-text, white);border-bottom:1px solid var(--menu-hover-bg, #37474f)}.avatar[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:50%;background:var(--primary-color, #1976d2);display:flex;align-items:center;justify-content:center;font-weight:500}.user-info[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-weight:500}.user-info[_ngcontent-%COMP%]   .role[_ngcontent-%COMP%]{font-size:.75rem;opacity:.7}.sidebar-nav[_ngcontent-%COMP%]{flex:1;overflow-y:auto;padding:.5rem 0}.menu-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;padding:.75rem 1rem;color:var(--sidebar-text, white);text-decoration:none;cursor:pointer;transition:background .2s}.menu-item[_ngcontent-%COMP%]:hover{background:var(--menu-hover-bg, #37474f)}.menu-item.active[_ngcontent-%COMP%]{background:var(--menu-active-bg, #1976d2)}.nav-panel[_ngcontent-%COMP%]{background:transparent!important;box-shadow:none!important;color:var(--sidebar-text, white)}.nav-panel[_ngcontent-%COMP%]     .mat-expansion-panel-header{padding:0 1rem;color:var(--sidebar-text, white)}.nav-panel[_ngcontent-%COMP%]     .mat-expansion-panel-body{padding:0}.submenu[_ngcontent-%COMP%]   .menu-item[_ngcontent-%COMP%]{padding-left:2.5rem;font-size:.875rem}.nested-panel[_ngcontent-%COMP%]{margin:0!important}.nested-panel[_ngcontent-%COMP%]     .mat-expansion-panel-header{padding-left:2.5rem!important;font-size:.875rem;min-height:40px!important}.nested-submenu[_ngcontent-%COMP%]   .menu-item[_ngcontent-%COMP%]{padding-left:4rem!important;font-size:.8rem}.reports-submenu[_ngcontent-%COMP%]{max-height:400px;overflow-y:auto}.badge-count[_ngcontent-%COMP%]{margin-left:auto;background:#f44336;color:#fff;border-radius:10px;padding:2px 8px;font-size:.75rem;font-weight:500;min-width:20px;text-align:center}.badge-count.primary[_ngcontent-%COMP%]{background:#1976d2}.sidebar-footer[_ngcontent-%COMP%]{border-top:1px solid var(--menu-hover-bg, #37474f);opacity:.9}.footer-toggle[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:.5rem 1rem;cursor:pointer;transition:background .2s,padding .2s;font-weight:500;font-size:.75rem}.footer-toggle[_ngcontent-%COMP%]:hover{background:var(--menu-hover-bg, #37474f)}.footer-toggle[_ngcontent-%COMP%]   .toggle-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px;transition:transform .2s,font-size .2s}.footer-content[_ngcontent-%COMP%]{text-align:center;padding:.5rem 1rem 1rem;font-size:.75rem}.sidebar-footer[_ngcontent-%COMP%]   .developer[_ngcontent-%COMP%]{font-weight:500;margin-bottom:.25rem}.sidebar-footer[_ngcontent-%COMP%]   .copyright[_ngcontent-%COMP%]{opacity:.7}.sidebar-footer.collapsed[_ngcontent-%COMP%]{border-top:none;border-bottom:none;padding:0;margin:0}.sidebar-footer.collapsed[_ngcontent-%COMP%]   .footer-toggle[_ngcontent-%COMP%]{padding:1px 0;margin:0;justify-content:center;height:auto;min-height:0;line-height:1}.sidebar-footer.collapsed[_ngcontent-%COMP%]   .footer-toggle[_ngcontent-%COMP%]   .toggle-icon[_ngcontent-%COMP%]{font-size:8px!important;width:8px!important;height:8px!important;line-height:8px!important;margin:0!important;padding:0!important}.main-content[_ngcontent-%COMP%]{flex:1;margin-left:260px;min-height:100vh;display:flex;flex-direction:column;transition:margin-left .3s ease}.main-header[_ngcontent-%COMP%]{background:var(--header-bg, white);color:var(--header-text, #333);padding:.5rem 1rem;display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid var(--border-color, #e0e0e0);position:sticky;top:0;z-index:100}.page-content[_ngcontent-%COMP%]{flex:1;padding:1.5rem;background:var(--body-bg, #f5f5f5)}.sidebar[_ngcontent-%COMP%]{transition:transform .3s ease,width .3s ease}.sidebar.collapsed[_ngcontent-%COMP%]{transform:translate(-260px)}.main-content.expanded[_ngcontent-%COMP%]{margin-left:0}"],data:{animation:[X("footerExpand",[Q("collapsed",V({height:"0",opacity:"0",overflow:"hidden",padding:"0"})),Q("expanded",V({height:"*",opacity:"1",overflow:"hidden"})),tt("collapsed <=> expanded",[J("200ms ease-in-out")])])]}})}return a})();export{vn as MainLayoutComponent};
