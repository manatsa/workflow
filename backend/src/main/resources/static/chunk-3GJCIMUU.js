import{a as Ie,b as Fe}from"./chunk-ABZG7EXB.js";import{a as v,b as De,c as W,d as Ve,e as Pe}from"./chunk-SR2TIT5O.js";import"./chunk-G556JK2P.js";import"./chunk-ZCDPLTK7.js";import"./chunk-XIC57EJO.js";import"./chunk-C2RIDQE5.js";import{a as se,b as de,c as pe,d as fe}from"./chunk-GTA6LP7E.js";import{a as me,b as ce}from"./chunk-RORH5LGT.js";import{a as ue,b as we}from"./chunk-L6PTED5A.js";import"./chunk-NDFZT543.js";import{a as Ce,b as ge,c as Me,d as Se,e as xe,f as be,g as ve,h as We,i as ye,j as Ee,k as Le,l as Te}from"./chunk-XSCQ4HOZ.js";import{a as he}from"./chunk-3AZ62B2F.js";import"./chunk-2HMVGF7U.js";import{b as _e,c as ke}from"./chunk-LNAKRYVP.js";import"./chunk-3WEQTSJY.js";import{b as ie,e as oe,i as ne,j as re,l as ae,m as le}from"./chunk-W7HGFPQV.js";import{d as N,h as U,l as z,u as q}from"./chunk-MFE2U5AV.js";import{a as Z,c as ee,h as te}from"./chunk-XRACF4N4.js";import"./chunk-KNH3VKXQ.js";import"./chunk-OWVO723I.js";import{d as j,g as Q}from"./chunk-GMPFJIFP.js";import{o as A,p as H,ta as G,ua as J,va as K,wa as X,ya as Y}from"./chunk-ZJGSEVKG.js";import{$b as E,Cb as s,Mb as i,Nb as o,Ob as C,Pb as w,Qb as _,Sb as M,Wb as k,Xb as g,ac as L,bc as T,cb as c,ec as D,fc as r,gc as S,hb as y,hc as x,ic as P,jc as I,kc as F,lc as B,oa as d,ob as V,oc as R,pa as p,pc as b,rc as O,ub as f,uc as $}from"./chunk-BMOUMNDR.js";var Be=()=>[10,25,50],Re=t=>["/workflows/builder",t],Oe=t=>["/workflows",t,"instances"],$e=t=>["/workflows",t,"new"];function Ae(t,m){t&1&&C(0,"th",27)}function He(t,m){if(t&1&&(i(0,"td",28)(1,"mat-icon",29),r(2),o()()),t&2){let e=m.$implicit;c(2),S(e.icon||"description")}}function je(t,m){t&1&&(i(0,"th",30),r(1,"Name"),o())}function Qe(t,m){if(t&1&&(i(0,"td",28)(1,"div",31)(2,"strong"),r(3),o(),i(4,"span",32),r(5),o()()()),t&2){let e=m.$implicit;c(3),S(e.name),c(2),S(e.code)}}function Ne(t,m){t&1&&(i(0,"th",27),r(1,"Description"),o())}function Ue(t,m){if(t&1&&(i(0,"td",28),r(1),O(2,"slice"),o()),t&2){let e=m.$implicit;c(),P(" ",$(2,2,e.description,0,100),"",(e.description==null?null:e.description.length)>100?"...":""," ")}}function ze(t,m){t&1&&(i(0,"th",30),r(1,"Type"),o())}function qe(t,m){if(t&1&&(i(0,"td",28)(1,"mat-chip"),r(2),o()()),t&2){let e=m.$implicit;c(2),S(e.workflowTypeName||"General")}}function Ge(t,m){t&1&&(i(0,"th",27),r(1,"Approvers"),o())}function Je(t,m){if(t&1&&(i(0,"td",28),r(1),o()),t&2){let e=m.$implicit;c(),x(" ",(e.approvers==null?null:e.approvers.length)||0," levels ")}}function Ke(t,m){t&1&&(i(0,"th",30),r(1,"Published"),o())}function Xe(t,m){if(t&1){let e=M();i(0,"td",28)(1,"mat-slide-toggle",33),k("change",function(l){let a=d(e).$implicit,u=g();return p(u.togglePublished(a,l.checked))}),r(2),o()()}if(t&2){let e=m.$implicit;c(),s("checked",e.isPublished),c(),x(" ",e.isPublished?"Published":"Draft"," ")}}function Ye(t,m){t&1&&(i(0,"th",30),r(1,"Status"),o())}function Ze(t,m){if(t&1){let e=M();i(0,"td",28)(1,"mat-slide-toggle",34),k("change",function(l){let a=d(e).$implicit,u=g();return p(u.toggleActive(a,l.checked))}),r(2),o()()}if(t&2){let e=m.$implicit;c(),s("checked",e.isActive),c(),x(" ",e.isActive?"Active":"Inactive"," ")}}function et(t,m){t&1&&C(0,"th",27)}function tt(t,m){if(t&1){let e=M();i(0,"td",28)(1,"button",35)(2,"mat-icon"),r(3,"more_vert"),o()(),i(4,"mat-menu",null,1)(6,"button",36)(7,"mat-icon"),r(8,"build"),o(),i(9,"span"),r(10,"Edit Builder"),o()(),i(11,"button",36)(12,"mat-icon"),r(13,"list"),o(),i(14,"span"),r(15,"View Instances"),o()(),i(16,"button",36)(17,"mat-icon"),r(18,"add"),o(),i(19,"span"),r(20,"New Submission"),o()(),C(21,"mat-divider"),i(22,"button",37),k("click",function(){let l=d(e).$implicit,a=g();return p(a.duplicateWorkflow(l))}),i(23,"mat-icon"),r(24,"content_copy"),o(),i(25,"span"),r(26,"Duplicate"),o()(),i(27,"button",37),k("click",function(){let l=d(e).$implicit,a=g();return p(a.exportWorkflow(l))}),i(28,"mat-icon"),r(29,"download"),o(),i(30,"span"),r(31,"Export"),o()(),i(32,"button",38),k("click",function(){let l=d(e).$implicit,a=g();return p(a.deleteWorkflow(l))}),i(33,"mat-icon"),r(34,"delete"),o(),i(35,"span"),r(36,"Delete"),o()()()()}if(t&2){let e=m.$implicit,n=D(5);c(),s("matMenuTriggerFor",n),c(5),s("routerLink",b(4,Re,e.id)),c(5),s("routerLink",b(6,Oe,e.code)),c(5),s("routerLink",b(8,$e,e.code))}}function it(t,m){t&1&&C(0,"tr",39)}function ot(t,m){t&1&&C(0,"tr",40)}var Ot=(()=>{class t{workflowService;snackBar;displayedColumns=["icon","name","description","type","approvers","published","active","actions"];dataSource=new Te([]);searchTerm="";paginator;sort;constructor(e,n){this.workflowService=e,this.snackBar=n}ngOnInit(){this.loadWorkflows()}ngAfterViewInit(){this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort}loadWorkflows(){this.workflowService.getWorkflows().subscribe(e=>{e.success&&(this.dataSource.data=e.data)})}applyFilter(){this.dataSource.filter=this.searchTerm.trim().toLowerCase()}toggleActive(e,n){this.workflowService.toggleWorkflowActive(e.id,n).subscribe(l=>{l.success&&(e.isActive=n,this.snackBar.open(`Workflow ${n?"activated":"deactivated"} successfully`,"Close",{duration:3e3}))})}togglePublished(e,n){(n?this.workflowService.publishWorkflow(e.id):this.workflowService.unpublishWorkflow(e.id)).subscribe(a=>{a.success&&(e.isPublished=n,this.snackBar.open(`Workflow ${n?"published":"unpublished"} successfully`,"Close",{duration:3e3}))})}duplicateWorkflow(e){this.workflowService.duplicateWorkflow(e.id).subscribe(n=>{n.success&&(this.snackBar.open("Workflow duplicated successfully","Close",{duration:3e3}),this.loadWorkflows())})}exportWorkflow(e){this.workflowService.exportWorkflow(e.id).subscribe(n=>{let l=window.URL.createObjectURL(n),a=document.createElement("a");a.href=l,a.download=`${e.code}_workflow.json`,a.click(),window.URL.revokeObjectURL(l)})}onFileSelected(e){let n=e.target;if(n.files&&n.files.length>0){let l=n.files[0];this.workflowService.importWorkflow(l).subscribe({next:a=>{a.success?(this.snackBar.open("Workflow imported successfully","Close",{duration:3e3}),this.loadWorkflows()):this.snackBar.open(a.message||"Failed to import workflow","Close",{duration:5e3})},error:a=>{let u=a.error?.message||"Failed to import workflow";this.snackBar.open(u,"Close",{duration:5e3})}}),n.value=""}}deleteWorkflow(e){confirm(`Are you sure you want to delete the workflow "${e.name}"?`)&&this.workflowService.deleteWorkflow(e.id).subscribe(n=>{n.success&&(this.snackBar.open("Workflow deleted successfully","Close",{duration:3e3}),this.loadWorkflows())})}static \u0275fac=function(n){return new(n||t)(y(he),y(_e))};static \u0275cmp=V({type:t,selectors:[["app-workflow-list"]],viewQuery:function(n,l){if(n&1&&(E(v,5),E(W,5)),n&2){let a;L(a=T())&&(l.paginator=a.first),L(a=T())&&(l.sort=a.first)}},decls:52,vars:6,consts:[["fileInput",""],["menu","matMenu"],[1,"workflow-list-container"],[1,"header"],[1,"header-actions"],["type","file","accept",".json",2,"display","none",3,"change"],["mat-stroked-button","","color","primary",3,"click"],["mat-raised-button","","color","primary","routerLink","/workflows/builder/new"],[1,"table-toolbar"],["appearance","outline",1,"search-field"],["matInput","","placeholder","Search by name or code",3,"ngModelChange","keyup","ngModel"],["matPrefix",""],["mat-table","","matSort","",1,"data-table",3,"dataSource"],["matColumnDef","icon"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","name"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["matColumnDef","description"],["matColumnDef","type"],["matColumnDef","approvers"],["matColumnDef","published"],["matColumnDef","active"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","",3,"pageSizeOptions"],["mat-header-cell",""],["mat-cell",""],[1,"workflow-icon"],["mat-header-cell","","mat-sort-header",""],[1,"workflow-info"],[1,"code"],["color","primary",3,"change","checked"],[3,"change","checked"],["mat-icon-button","",3,"matMenuTriggerFor"],["mat-menu-item","",3,"routerLink"],["mat-menu-item","",3,"click"],["mat-menu-item","",1,"delete-action",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(n,l){if(n&1){let a=M();i(0,"div",2)(1,"div",3)(2,"h1"),r(3,"Workflow Management"),o(),i(4,"div",4)(5,"input",5,0),k("change",function(h){return d(a),p(l.onFileSelected(h))}),o(),i(7,"button",6),k("click",function(){d(a);let h=D(6);return p(h.click())}),i(8,"mat-icon"),r(9,"upload"),o(),r(10," Import Workflow "),o(),i(11,"button",7)(12,"mat-icon"),r(13,"add"),o(),r(14," Create Workflow "),o()()(),i(15,"mat-card")(16,"mat-card-content")(17,"div",8)(18,"mat-form-field",9)(19,"mat-label"),r(20,"Search workflows"),o(),i(21,"input",10),B("ngModelChange",function(h){return d(a),F(l.searchTerm,h)||(l.searchTerm=h),p(h)}),k("keyup",function(){return d(a),p(l.applyFilter())}),o(),i(22,"mat-icon",11),r(23,"search"),o()()(),i(24,"table",12),w(25,13),f(26,Ae,1,0,"th",14)(27,He,3,1,"td",15),_(),w(28,16),f(29,je,2,0,"th",17)(30,Qe,6,2,"td",15),_(),w(31,18),f(32,Ne,2,0,"th",14)(33,Ue,3,6,"td",15),_(),w(34,19),f(35,ze,2,0,"th",17)(36,qe,3,1,"td",15),_(),w(37,20),f(38,Ge,2,0,"th",14)(39,Je,2,1,"td",15),_(),w(40,21),f(41,Ke,2,0,"th",17)(42,Xe,3,2,"td",15),_(),w(43,22),f(44,Ye,2,0,"th",17)(45,Ze,3,2,"td",15),_(),w(46,23),f(47,et,1,0,"th",14)(48,tt,37,10,"td",15),_(),f(49,it,1,0,"tr",24)(50,ot,1,0,"tr",25),o(),C(51,"mat-paginator",26),o()()()}n&2&&(c(21),I("ngModel",l.searchTerm),c(3),s("dataSource",l.dataSource),c(25),s("matHeaderRowDef",l.displayedColumns),c(),s("matRowDefColumns",l.displayedColumns),c(),s("pageSizeOptions",R(5,Be)))},dependencies:[H,A,Q,j,q,N,U,z,te,Z,ee,Le,Ce,Me,ve,Se,ge,We,xe,be,ye,Ee,De,v,Pe,W,Ve,re,ne,ie,oe,le,ae,Y,X,K,J,G,fe,de,se,pe,we,ue,Fe,Ie,ke,ce,me],styles:[".workflow-list-container[_ngcontent-%COMP%]{padding:1rem}.header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem}.header-actions[_ngcontent-%COMP%]{display:flex;gap:.5rem}.table-toolbar[_ngcontent-%COMP%]{margin-bottom:1rem}.search-field[_ngcontent-%COMP%]{width:400px}.data-table[_ngcontent-%COMP%]{width:100%}.workflow-icon[_ngcontent-%COMP%]{color:#1976d2}.workflow-info[_ngcontent-%COMP%]{display:flex;flex-direction:column}.workflow-info[_ngcontent-%COMP%]   .code[_ngcontent-%COMP%]{font-size:.75rem;color:#666}.delete-action[_ngcontent-%COMP%]{color:#c62828}"]})}return t})();export{Ot as WorkflowListComponent};
