import"./chunk-F5X5MWHG.js";import{a as It,b as yt}from"./chunk-4M7UJXFZ.js";import"./chunk-MS4AQ6UA.js";import{a as Mt,b as wt}from"./chunk-B7S7HKPH.js";import{c as N}from"./chunk-RP3FIGZU.js";import{a as ct,b as st}from"./chunk-LUBHRDD6.js";import"./chunk-22QFHSXK.js";import{a as ut,b as ft,c as ht,d as _t,e as Ct,f as St,g as bt,h as gt,i as xt,j as Bt,k as vt}from"./chunk-S7OVDIVJ.js";import"./chunk-KPLEND2O.js";import{a as Et}from"./chunk-3HKR6USX.js";import{a as dt,b as pt}from"./chunk-XQHIDIE5.js";import"./chunk-LETYTNCA.js";import"./chunk-M3GLKEYP.js";import{a as ot,c as lt,d as mt}from"./chunk-ZK2UDSKG.js";import{b as it,c as nt,d as at,i as rt}from"./chunk-FHBRY4FZ.js";import{d as O,f as M,h as V,i as A,k as q,l as $,n as U,o as R,r as H,s as j,t as W}from"./chunk-JITRQZ7S.js";import{a as X,b as Y,c as Z,f as tt,h as et}from"./chunk-LB6LFADN.js";import"./chunk-Q5RCCGFX.js";import"./chunk-W4XF3NOO.js";import{m as D,qa as G,ra as z,sa as J,ta as K,va as Q}from"./chunk-LBWRLA47.js";import{Ab as d,Cb as P,Fb as C,Ib as B,Jb as v,Kb as n,Lb as i,Mb as h,Nb as g,Ob as x,Qb as y,Ub as u,Vb as _,bb as o,dc as a,ec as f,fc as E,gb as w,hc as F,ic as T,jc as L,na as S,nb as k,oa as b,tb as p}from"./chunk-5XIHPI6O.js";var I=(e,l)=>l.id;function Ft(e,l){if(e&1&&(n(0,"mat-option",7),a(1),i()),e&2){let t=l.$implicit;d("value",t.id),o(),f(t.name)}}function Tt(e,l){if(e&1&&(n(0,"mat-option",7),a(1),i()),e&2){let t=l.$implicit;d("value",t.id),o(),f(t.name)}}function Lt(e,l){e&1&&(n(0,"th",24),a(1,"Code"),i())}function kt(e,l){if(e&1&&(n(0,"td",25),a(1),i()),e&2){let t=l.$implicit;o(),f(t.code)}}function Pt(e,l){e&1&&(n(0,"th",24),a(1,"Name"),i())}function Dt(e,l){if(e&1&&(n(0,"td",25),a(1),i()),e&2){let t=l.$implicit;o(),f(t.name)}}function Nt(e,l){e&1&&(n(0,"th",24),a(1,"SBU"),i())}function Ot(e,l){if(e&1&&(n(0,"td",25),a(1),i()),e&2){let t=l.$implicit;o(),f(t.sbuName||"-")}}function Vt(e,l){e&1&&(n(0,"th",24),a(1,"Corporate"),i())}function At(e,l){if(e&1&&(n(0,"td",25),a(1),i()),e&2){let t=l.$implicit;o(),f(t.corporateName||"-")}}function qt(e,l){e&1&&(n(0,"th",24),a(1,"Status"),i())}function $t(e,l){if(e&1&&(n(0,"td",25)(1,"mat-chip",26),a(2),i()()),e&2){let t=l.$implicit;o(),d("color",t.isActive?"primary":"warn"),o(),E(" ",t.isActive?"Active":"Inactive"," ")}}function Ut(e,l){e&1&&(n(0,"th",24),a(1,"Actions"),i())}function Rt(e,l){if(e&1){let t=y();n(0,"td",25)(1,"button",27),u("click",function(){let r=S(t).$implicit,s=_();return b(s.editBranch(r))}),n(2,"mat-icon"),a(3,"edit"),i()(),n(4,"button",28),u("click",function(){let r=S(t).$implicit,s=_();return b(s.toggleStatus(r))}),n(5,"mat-icon"),a(6),i()(),n(7,"button",29),u("click",function(){let r=S(t).$implicit,s=_();return b(s.deleteBranch(r))}),n(8,"mat-icon"),a(9,"delete"),i()()()}if(e&2){let t=l.$implicit;o(4),d("matTooltip",t.isActive?"Deactivate":"Activate"),o(2),f(t.isActive?"visibility_off":"visibility")}}function Ht(e,l){e&1&&h(0,"tr",30)}function jt(e,l){e&1&&h(0,"tr",31)}function Wt(e,l){e&1&&(n(0,"div",22)(1,"mat-icon"),a(2,"store"),i(),n(3,"p"),a(4,"No branches found. Add your first branch."),i()())}function Gt(e,l){e&1&&(n(0,"mat-error"),a(1,"Code is required"),i())}function zt(e,l){e&1&&(n(0,"mat-error"),a(1,"Name is required"),i())}function Jt(e,l){if(e&1&&(n(0,"mat-option",7),a(1),i()),e&2){let t=l.$implicit;d("value",t.id),o(),f(t.name)}}function Kt(e,l){if(e&1&&a(0),e&2){let t=_().$implicit;E(" (",t.corporateName,") ")}}function Qt(e,l){if(e&1&&(n(0,"mat-option",7),a(1),p(2,Kt,1,1),i()),e&2){let t=l.$implicit;d("value",t.id),o(),E("",t.name," "),o(),C(t.corporateName?2:-1)}}function Xt(e,l){e&1&&(n(0,"mat-error"),a(1,"SBU is required"),i())}function Yt(e,l){e&1&&(n(0,"mat-error"),a(1,"Invalid email format"),i())}function Zt(e,l){if(e&1){let t=y();n(0,"mat-card",23)(1,"mat-card-header")(2,"mat-card-title"),a(3),i()(),n(4,"mat-card-content")(5,"form",32),u("ngSubmit",function(){S(t);let r=_();return b(r.saveBranch())}),n(6,"div",33)(7,"mat-form-field",34)(8,"mat-label"),a(9,"Code"),i(),h(10,"input",35),p(11,Gt,2,0,"mat-error"),i(),n(12,"mat-form-field",34)(13,"mat-label"),a(14,"Name"),i(),h(15,"input",36),p(16,zt,2,0,"mat-error"),i()(),n(17,"mat-form-field",37)(18,"mat-label"),a(19,"Corporate (Optional Filter)"),i(),n(20,"mat-select",38),u("selectionChange",function(){S(t);let r=_();return b(r.onFormCorporateChange())}),n(21,"mat-option",7),a(22,"-- Select to filter SBUs --"),i(),B(23,Jt,2,2,"mat-option",7,I),i(),n(25,"mat-hint"),a(26,"Select to filter available SBUs"),i()(),n(27,"mat-form-field",37)(28,"mat-label"),a(29,"SBU"),i(),n(30,"mat-select",39)(31,"mat-option",7),a(32,"-- Select SBU --"),i(),B(33,Qt,3,3,"mat-option",7,I),i(),p(35,Xt,2,0,"mat-error"),i(),n(36,"mat-form-field",37)(37,"mat-label"),a(38,"Description"),i(),h(39,"textarea",40),i(),n(40,"mat-form-field",37)(41,"mat-label"),a(42,"Address"),i(),h(43,"textarea",41),i(),n(44,"div",33)(45,"mat-form-field",34)(46,"mat-label"),a(47,"Contact Email"),i(),h(48,"input",42),p(49,Yt,2,0,"mat-error"),i(),n(50,"mat-form-field",34)(51,"mat-label"),a(52,"Contact Phone"),i(),h(53,"input",43),i()(),n(54,"div",44)(55,"button",45),u("click",function(){S(t);let r=_();return b(r.showForm=!1)}),a(56,"Cancel"),i(),n(57,"button",46),a(58),i()()()()()}if(e&2){let t,m,r,s,c=_();o(3),f(c.editingBranch?"Edit Branch":"Add Branch"),o(2),d("formGroup",c.branchForm),o(6),C((t=c.branchForm.get("code"))!=null&&t.hasError("required")?11:-1),o(5),C((m=c.branchForm.get("name"))!=null&&m.hasError("required")?16:-1),o(5),d("value",null),o(2),v(c.corporates),o(8),d("value",null),o(2),v(c.formSbus),o(2),C((r=c.branchForm.get("sbuId"))!=null&&r.hasError("required")?35:-1),o(14),C((s=c.branchForm.get("contactEmail"))!=null&&s.hasError("email")?49:-1),o(8),d("disabled",c.loading||c.branchForm.invalid),o(),E(" ",c.editingBranch?"Update":"Create"," ")}}var Me=(()=>{class e{fb;userService;snackBar;branches=[];displayedBranches=[];corporates=[];allSbus=[];filteredSbus=[];formSbus=[];displayedColumns=["code","name","sbu","corporate","status","actions"];showForm=!1;editingBranch=null;loading=!1;branchForm;filterCorporateId=null;filterSbuId=null;constructor(t,m,r){this.fb=t,this.userService=m,this.snackBar=r,this.branchForm=this.fb.group({code:["",M.required],name:["",M.required],description:[""],address:[""],corporateId:[null],sbuId:[null,M.required],contactEmail:["",M.email],contactPhone:[""]})}ngOnInit(){this.loadBranches(),this.loadCorporates(),this.loadSbus()}loadBranches(){this.userService.getBranches().subscribe(t=>{t.success&&(this.branches=t.data,this.applyFilters())})}loadCorporates(){this.userService.getActiveCorporates().subscribe(t=>{t.success&&(this.corporates=t.data)})}loadSbus(){this.userService.getSBUs().subscribe(t=>{t.success&&(this.allSbus=t.data,this.filteredSbus=[...this.allSbus],this.formSbus=[...this.allSbus])})}onFilterCorporateChange(){this.filterCorporateId?this.filteredSbus=this.allSbus.filter(t=>t.corporateId===this.filterCorporateId):this.filteredSbus=[...this.allSbus],this.filterSbuId=null,this.applyFilters()}applyFilters(){let t=[...this.branches];this.filterCorporateId&&(t=t.filter(m=>m.corporateId===this.filterCorporateId)),this.filterSbuId&&(t=t.filter(m=>m.sbuId===this.filterSbuId)),this.displayedBranches=t}clearFilters(){this.filterCorporateId=null,this.filterSbuId=null,this.filteredSbus=[...this.allSbus],this.applyFilters()}openNewForm(){this.showForm=!0,this.editingBranch=null,this.branchForm.reset(),this.formSbus=[...this.allSbus]}onFormCorporateChange(){let t=this.branchForm.get("corporateId")?.value;t?this.formSbus=this.allSbus.filter(m=>m.corporateId===t):this.formSbus=[...this.allSbus],this.branchForm.patchValue({sbuId:null})}editBranch(t){this.editingBranch=t,this.showForm=!0,t.corporateId?this.formSbus=this.allSbus.filter(m=>m.corporateId===t.corporateId):this.formSbus=[...this.allSbus],this.branchForm.patchValue({code:t.code,name:t.name,description:t.description,address:t.address,corporateId:t.corporateId||null,sbuId:t.sbuId,contactEmail:t.contactEmail,contactPhone:t.contactPhone})}saveBranch(){if(this.branchForm.invalid)return;this.loading=!0;let t=this.branchForm.value,m={code:t.code,name:t.name,description:t.description,address:t.address,sbuId:t.sbuId,contactEmail:t.contactEmail,contactPhone:t.contactPhone};(this.editingBranch?this.userService.updateBranch(this.editingBranch.id,m):this.userService.createBranch(m)).subscribe({next:s=>{this.loading=!1,s.success&&(this.snackBar.open(this.editingBranch?"Branch updated":"Branch created","Close",{duration:3e3}),this.showForm=!1,this.editingBranch=null,this.branchForm.reset(),this.loadBranches())},error:s=>{this.loading=!1,this.snackBar.open(s.error?.message||"Operation failed","Close",{duration:3e3})}})}toggleStatus(t){(t.isActive?this.userService.deactivateBranch(t.id):this.userService.activateBranch(t.id)).subscribe({next:()=>{this.snackBar.open(t.isActive?"Branch deactivated":"Branch activated","Close",{duration:3e3}),this.loadBranches()},error:r=>{this.snackBar.open(r.error?.message||"Operation failed","Close",{duration:3e3})}})}deleteBranch(t){confirm(`Are you sure you want to delete "${t.name}"?`)&&this.userService.deleteBranch(t.id).subscribe({next:()=>{this.snackBar.open("Branch deleted","Close",{duration:3e3}),this.loadBranches()},error:m=>{this.snackBar.open(m.error?.message||"Failed to delete","Close",{duration:3e3})}})}static \u0275fac=function(m){return new(m||e)(w(H),w(Et),w(dt))};static \u0275cmp=k({type:e,selectors:[["app-branch-list"]],decls:57,vars:11,consts:[[1,"branch-list-container"],[1,"header"],["mat-raised-button","","color","primary",3,"click"],[1,"filter-card"],[1,"filter-row"],["appearance","outline"],[3,"ngModelChange","selectionChange","ngModel"],[3,"value"],["mat-button","",3,"click"],[1,"content-grid"],[1,"table-card"],["mat-table","",1,"full-width",3,"dataSource"],["matColumnDef","code"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","name"],["matColumnDef","sbu"],["matColumnDef","corporate"],["matColumnDef","status"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[1,"no-data"],[1,"form-card"],["mat-header-cell",""],["mat-cell",""],["selected","",3,"color"],["mat-icon-button","","matTooltip","Edit",3,"click"],["mat-icon-button","",3,"click","matTooltip"],["mat-icon-button","","color","warn","matTooltip","Delete",3,"click"],["mat-header-row",""],["mat-row",""],[3,"ngSubmit","formGroup"],[1,"form-row"],["appearance","outline",1,"form-field"],["matInput","","formControlName","code"],["matInput","","formControlName","name"],["appearance","outline",1,"form-field","full-width"],["formControlName","corporateId",3,"selectionChange"],["formControlName","sbuId"],["matInput","","formControlName","description","rows","2"],["matInput","","formControlName","address","rows","2"],["matInput","","formControlName","contactEmail","type","email"],["matInput","","formControlName","contactPhone"],[1,"form-actions"],["mat-button","","type","button",3,"click"],["mat-raised-button","","color","primary","type","submit",3,"disabled"]],template:function(m,r){m&1&&(n(0,"div",0)(1,"div",1)(2,"h1"),a(3,"Branches"),i(),n(4,"button",2),u("click",function(){return r.openNewForm()}),n(5,"mat-icon"),a(6,"add"),i(),a(7," Add Branch "),i()(),n(8,"mat-card",3)(9,"mat-card-content")(10,"div",4)(11,"mat-form-field",5)(12,"mat-label"),a(13,"Filter by Corporate"),i(),n(14,"mat-select",6),L("ngModelChange",function(c){return T(r.filterCorporateId,c)||(r.filterCorporateId=c),c}),u("selectionChange",function(){return r.onFilterCorporateChange()}),n(15,"mat-option",7),a(16,"-- All Corporates --"),i(),B(17,Ft,2,2,"mat-option",7,I),i()(),n(19,"mat-form-field",5)(20,"mat-label"),a(21,"Filter by SBU"),i(),n(22,"mat-select",6),L("ngModelChange",function(c){return T(r.filterSbuId,c)||(r.filterSbuId=c),c}),u("selectionChange",function(){return r.applyFilters()}),n(23,"mat-option",7),a(24,"-- All SBUs --"),i(),B(25,Tt,2,2,"mat-option",7,I),i()(),n(27,"button",8),u("click",function(){return r.clearFilters()}),n(28,"mat-icon"),a(29,"clear"),i(),a(30," Clear Filters "),i()()()(),n(31,"div",9)(32,"mat-card",10)(33,"mat-card-content")(34,"table",11),g(35,12),p(36,Lt,2,0,"th",13)(37,kt,2,1,"td",14),x(),g(38,15),p(39,Pt,2,0,"th",13)(40,Dt,2,1,"td",14),x(),g(41,16),p(42,Nt,2,0,"th",13)(43,Ot,2,1,"td",14),x(),g(44,17),p(45,Vt,2,0,"th",13)(46,At,2,1,"td",14),x(),g(47,18),p(48,qt,2,0,"th",13)(49,$t,3,2,"td",14),x(),g(50,19),p(51,Ut,2,0,"th",13)(52,Rt,10,2,"td",14),x(),p(53,Ht,1,0,"tr",20)(54,jt,1,0,"tr",21),i(),p(55,Wt,5,0,"div",22),i()(),p(56,Zt,59,10,"mat-card",23),i()()),m&2&&(o(14),F("ngModel",r.filterCorporateId),o(),d("value",null),o(2),v(r.corporates),o(5),F("ngModel",r.filterSbuId),o(),d("value",null),o(2),v(r.filteredSbus),o(6),P("with-form",r.showForm),o(3),d("dataSource",r.displayedBranches),o(19),d("matHeaderRowDef",r.displayedColumns),o(),d("matRowDefColumns",r.displayedColumns),o(),C(r.displayedBranches.length===0?55:-1),o(),C(r.showForm?56:-1))},dependencies:[D,j,$,O,V,A,q,W,U,R,et,X,Z,tt,Y,vt,ut,ht,bt,_t,ft,gt,Ct,St,xt,Bt,ot,rt,it,at,nt,mt,lt,Q,K,J,z,G,pt,st,ct,wt,Mt,N,yt,It],styles:[".branch-list-container[_ngcontent-%COMP%]{padding:1rem}.header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem}.filter-card[_ngcontent-%COMP%]{margin-bottom:1rem}.filter-row[_ngcontent-%COMP%]{display:flex;gap:1rem;align-items:center;flex-wrap:wrap}.filter-row[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{min-width:200px}.content-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr;gap:1rem}.content-grid.with-form[_ngcontent-%COMP%]{grid-template-columns:1fr 500px}@media (max-width: 1100px){.content-grid.with-form[_ngcontent-%COMP%]{grid-template-columns:1fr}}.full-width[_ngcontent-%COMP%]{width:100%}.no-data[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:2rem;color:#666}.no-data[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:48px;width:48px;height:48px;opacity:.5}.form-row[_ngcontent-%COMP%]{display:flex;gap:1rem}.form-field[_ngcontent-%COMP%]{flex:1;margin-bottom:.5rem}.form-field.full-width[_ngcontent-%COMP%]{width:100%}.form-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:.5rem;margin-top:1rem}table[_ngcontent-%COMP%]{width:100%}.mat-column-actions[_ngcontent-%COMP%]{width:150px;text-align:center}"]})}return e})();export{Me as BranchListComponent};
