import{a as di,b as ui,c as hi,d as fi}from"./chunk-NFQCIRCK.js";import{a as li,b as si,c as pi,d as mi,e as ci}from"./chunk-SR2TIT5O.js";import"./chunk-F5X5MWHG.js";import{b as ri}from"./chunk-G556JK2P.js";import"./chunk-MS4AQ6UA.js";import{b as ai}from"./chunk-ZCDPLTK7.js";import{c as rt}from"./chunk-YOG4I3N2.js";import"./chunk-XIC57EJO.js";import{a as tt,b as it,c as ot,d as Q,e as nt,f as at,g as ue}from"./chunk-C2RIDQE5.js";import{a as Kt}from"./chunk-QDCPXM6W.js";import{e as Nt}from"./chunk-PM74EOZI.js";import{a as Bt,b as Wt,c as $t,d as zt}from"./chunk-GTA6LP7E.js";import{b as Ut}from"./chunk-L6PTED5A.js";import"./chunk-NDFZT543.js";import{a as Pt,b as Dt}from"./chunk-D7HGT47B.js";import{a as Yt,b as qt,c as Qt,d as Xt,e as Jt,f as Zt,g as ei,h as ti,i as ii,j as oi,k as ni}from"./chunk-XSCQ4HOZ.js";import"./chunk-2HMVGF7U.js";import{a as jt,b as Ht,c as Gt}from"./chunk-LNAKRYVP.js";import{b as Vt,g as Ft,k as X,n as Lt}from"./chunk-3WEQTSJY.js";import{b as Mt,f as Ot,h as xt,i as At,j as Rt,l as kt,m as Et}from"./chunk-W7HGFPQV.js";import{c as lt,d as st,h as pt,k as x,l as mt,o as ct,u as dt,v as ut}from"./chunk-MFE2U5AV.js";import{a as vt,b as bt,c as Ct,f as wt,h as St}from"./chunk-XRACF4N4.js";import{g as Tt,h as It}from"./chunk-KNH3VKXQ.js";import{a as je,c as He,d as Ge,g as Ke}from"./chunk-GMPFJIFP.js";import{B as Ye,C as qe,E as Qe,O as Xe,W as Je,X as Y,Y as Ze,aa as ce,ba as q,da as et,fa as de,k as Be,l as We,m as $e,n as ze,p as Ne,ta as ht,u as Ue,ua as ft,va as _t,wa as gt,ya as yt}from"./chunk-ZJGSEVKG.js";import{$ as be,$b as se,Aa as Me,Ac as me,B as U,Bb as ae,C as ie,Cb as d,Da as ne,Db as G,Dc as k,Eb as De,Fb as K,Hb as P,J as ge,K as ye,Kb as S,La as Oe,Lb as M,Mb as r,Nb as a,Ob as y,Pb as Te,Qa as xe,Qb as Ie,Sb as re,V as T,W as j,Wb as g,Xb as u,Yb as Ve,Z as ve,Zb as Fe,_b as le,ac as V,ba as Ce,bc as F,cb as s,d as N,da as oe,eb as Ae,ec as v,f as Z,fc as p,ga as h,gb as Re,gc as b,hb as E,hc as w,i as ee,jb as ke,jc as L,kc as B,la as we,lc as W,na as Se,nc as pe,o as te,oa as f,ob as H,oc as Le,pa as _,pb as Ee,qb as Pe,rc as O,s as D,sc as $,tc as z,ub as R,x as _e,za as I}from"./chunk-BMOUMNDR.js";var Ii=["panel"],Vi=["*"];function Fi(o,c){if(o&1&&(r(0,"div",1,0),Fe(2),a()),o&2){let e=c.id,i=u();K(i._classList),De("mat-mdc-autocomplete-visible",i.showPanel)("mat-mdc-autocomplete-hidden",!i.showPanel)("mat-autocomplete-panel-animations-enabled",!i._animationsDisabled)("mat-primary",i._color==="primary")("mat-accent",i._color==="accent")("mat-warn",i._color==="warn"),d("id",i.id),ae("aria-label",i.ariaLabel||null)("aria-labelledby",i._getPanelAriaLabelledby(e))}}var he=class{source;option;constructor(c,e){this.source=c,this.option=e}},yi=new oe("mat-autocomplete-default-options",{providedIn:"root",factory:Li});function Li(){return{autoActiveFirstOption:!1,autoSelectActiveOption:!1,hideSingleSelectionIndicator:!1,requireSelection:!1,hasBackdrop:!1}}var vi=(()=>{class o{_changeDetectorRef=h(me);_elementRef=h(ne);_defaults=h(yi);_animationsDisabled=h(Oe,{optional:!0})==="NoopAnimations";_activeOptionChanges=N.EMPTY;_keyManager;showPanel=!1;get isOpen(){return this._isOpen&&this.showPanel}_isOpen=!1;_latestOpeningTrigger;_setColor(e){this._color=e,this._changeDetectorRef.markForCheck()}_color;template;panel;options;optionGroups;ariaLabel;ariaLabelledby;displayWith=null;autoActiveFirstOption;autoSelectActiveOption;requireSelection;panelWidth;disableRipple;optionSelected=new I;opened=new I;closed=new I;optionActivated=new I;set classList(e){this._classList=e,this._elementRef.nativeElement.className=""}_classList;get hideSingleSelectionIndicator(){return this._hideSingleSelectionIndicator}set hideSingleSelectionIndicator(e){this._hideSingleSelectionIndicator=e,this._syncParentProperties()}_hideSingleSelectionIndicator;_syncParentProperties(){if(this.options)for(let e of this.options)e._changeDetectorRef.markForCheck()}id=h(Je).getId("mat-autocomplete-");inertGroups;constructor(){let e=h(Qe);this.inertGroups=e?.SAFARI||!1,this.autoActiveFirstOption=!!this._defaults.autoActiveFirstOption,this.autoSelectActiveOption=!!this._defaults.autoSelectActiveOption,this.requireSelection=!!this._defaults.requireSelection,this._hideSingleSelectionIndicator=this._defaults.hideSingleSelectionIndicator??!1}ngAfterContentInit(){this._keyManager=new Ze(this.options).withWrap().skipPredicate(this._skipPredicate),this._activeOptionChanges=this._keyManager.change.subscribe(e=>{this.isOpen&&this.optionActivated.emit({source:this,option:this.options.toArray()[e]||null})}),this._setVisibility()}ngOnDestroy(){this._keyManager?.destroy(),this._activeOptionChanges.unsubscribe()}_setScrollTop(e){this.panel&&(this.panel.nativeElement.scrollTop=e)}_getScrollTop(){return this.panel?this.panel.nativeElement.scrollTop:0}_setVisibility(){this.showPanel=!!this.options?.length,this._changeDetectorRef.markForCheck()}_emitSelectEvent(e){let i=new he(this,e);this.optionSelected.emit(i)}_getPanelAriaLabelledby(e){if(this.ariaLabel)return null;let i=e?e+" ":"";return this.ariaLabelledby?i+this.ariaLabelledby:e}_skipPredicate(){return!1}static \u0275fac=function(i){return new(i||o)};static \u0275cmp=H({type:o,selectors:[["mat-autocomplete"]],contentQueries:function(i,t,n){if(i&1&&(le(n,Q,5),le(n,it,5)),i&2){let l;V(l=F())&&(t.options=l),V(l=F())&&(t.optionGroups=l)}},viewQuery:function(i,t){if(i&1&&(se(Ae,7),se(Ii,5)),i&2){let n;V(n=F())&&(t.template=n.first),V(n=F())&&(t.panel=n.first)}},hostAttrs:[1,"mat-mdc-autocomplete"],inputs:{ariaLabel:[0,"aria-label","ariaLabel"],ariaLabelledby:[0,"aria-labelledby","ariaLabelledby"],displayWith:"displayWith",autoActiveFirstOption:[2,"autoActiveFirstOption","autoActiveFirstOption",k],autoSelectActiveOption:[2,"autoSelectActiveOption","autoSelectActiveOption",k],requireSelection:[2,"requireSelection","requireSelection",k],panelWidth:"panelWidth",disableRipple:[2,"disableRipple","disableRipple",k],classList:[0,"class","classList"],hideSingleSelectionIndicator:[2,"hideSingleSelectionIndicator","hideSingleSelectionIndicator",k]},outputs:{optionSelected:"optionSelected",opened:"opened",closed:"closed",optionActivated:"optionActivated"},exportAs:["matAutocomplete"],features:[pe([{provide:tt,useExisting:o}])],ngContentSelectors:Vi,decls:1,vars:0,consts:[["panel",""],["role","listbox",1,"mat-mdc-autocomplete-panel","mdc-menu-surface","mdc-menu-surface--open",3,"id"]],template:function(i,t){i&1&&(Ve(),R(0,Fi,3,17,"ng-template"))},styles:[`div.mat-mdc-autocomplete-panel{width:100%;max-height:256px;visibility:hidden;transform-origin:center top;overflow:auto;padding:8px 0;box-sizing:border-box;position:relative;border-radius:var(--mat-autocomplete-container-shape, var(--mat-sys-corner-extra-small));box-shadow:var(--mat-autocomplete-container-elevation-shadow, 0px 3px 1px -2px rgba(0, 0, 0, 0.2), 0px 2px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12));background-color:var(--mat-autocomplete-background-color, var(--mat-sys-surface-container))}@media(forced-colors: active){div.mat-mdc-autocomplete-panel{outline:solid 1px}}.cdk-overlay-pane:not(.mat-mdc-autocomplete-panel-above) div.mat-mdc-autocomplete-panel{border-top-left-radius:0;border-top-right-radius:0}.mat-mdc-autocomplete-panel-above div.mat-mdc-autocomplete-panel{border-bottom-left-radius:0;border-bottom-right-radius:0;transform-origin:center bottom}div.mat-mdc-autocomplete-panel.mat-mdc-autocomplete-visible{visibility:visible}div.mat-mdc-autocomplete-panel.mat-mdc-autocomplete-hidden{visibility:hidden;pointer-events:none}@keyframes _mat-autocomplete-enter{from{opacity:0;transform:scaleY(0.8)}to{opacity:1;transform:none}}.mat-autocomplete-panel-animations-enabled{animation:_mat-autocomplete-enter 120ms cubic-bezier(0, 0, 0.2, 1)}mat-autocomplete{display:none}
`],encapsulation:2,changeDetection:0})}return o})();var Bi={provide:lt,useExisting:be(()=>fe),multi:!0};var bi=new oe("mat-autocomplete-scroll-strategy",{providedIn:"root",factory:()=>{let o=h(X);return()=>o.scrollStrategies.reposition()}});function Wi(o){return()=>o.scrollStrategies.reposition()}var $i={provide:bi,deps:[X],useFactory:Wi},fe=(()=>{class o{_environmentInjector=h(we);_element=h(ne);_overlay=h(X);_viewContainerRef=h(ke);_zone=h(Me);_changeDetectorRef=h(me);_dir=h(et,{optional:!0});_formField=h(xt,{optional:!0,host:!0});_viewportRuler=h(Tt);_scrollStrategy=h(bi);_renderer=h(Re);_defaults=h(yi,{optional:!0});_overlayRef;_portal;_componentDestroyed=!1;_initialized=new ee;_keydownSubscription;_outsideClickSubscription;_cleanupWindowBlur;_previousValue;_valueOnAttach;_valueOnLastKeydown;_positionStrategy;_manuallyFloatingLabel=!1;_closingActionsSubscription;_viewportSubscription=N.EMPTY;_breakpointObserver=h(Xe);_handsetLandscapeSubscription=N.EMPTY;_canOpenOnNextFocus=!0;_valueBeforeAutoSelection;_pendingAutoselectedOption;_closeKeyEventStream=new ee;_windowBlurHandler=()=>{this._canOpenOnNextFocus=this.panelOpen||!this._hasFocus()};_onChange=()=>{};_onTouched=()=>{};autocomplete;position="auto";connectedTo;autocompleteAttribute="off";autocompleteDisabled;constructor(){}_aboveClass="mat-mdc-autocomplete-panel-above";ngAfterViewInit(){this._initialized.next(),this._initialized.complete(),this._cleanupWindowBlur=this._renderer.listen("window","blur",this._windowBlurHandler)}ngOnChanges(e){e.position&&this._positionStrategy&&(this._setStrategyPositions(this._positionStrategy),this.panelOpen&&this._overlayRef.updatePosition())}ngOnDestroy(){this._cleanupWindowBlur?.(),this._handsetLandscapeSubscription.unsubscribe(),this._viewportSubscription.unsubscribe(),this._componentDestroyed=!0,this._destroyPanel(),this._closeKeyEventStream.complete(),this._clearFromModal()}get panelOpen(){return this._overlayAttached&&this.autocomplete.showPanel}_overlayAttached=!1;openPanel(){this._openPanelInternal()}closePanel(){this._resetLabel(),this._overlayAttached&&(this.panelOpen&&this._zone.run(()=>{this.autocomplete.closed.emit()}),this.autocomplete._latestOpeningTrigger===this&&(this.autocomplete._isOpen=!1,this.autocomplete._latestOpeningTrigger=null),this._overlayAttached=!1,this._pendingAutoselectedOption=null,this._overlayRef&&this._overlayRef.hasAttached()&&(this._overlayRef.detach(),this._closingActionsSubscription.unsubscribe()),this._updatePanelState(),this._componentDestroyed||this._changeDetectorRef.detectChanges(),this._trackedModal&&q(this._trackedModal,"aria-owns",this.autocomplete.id))}updatePosition(){this._overlayAttached&&this._overlayRef.updatePosition()}get panelClosingActions(){return U(this.optionSelections,this.autocomplete._keyManager.tabOut.pipe(ie(()=>this._overlayAttached)),this._closeKeyEventStream,this._getOutsideClickStream(),this._overlayRef?this._overlayRef.detachments().pipe(ie(()=>this._overlayAttached)):te()).pipe(D(e=>e instanceof ot?e:null))}optionSelections=_e(()=>{let e=this.autocomplete?this.autocomplete.options:null;return e?e.changes.pipe(T(e),j(()=>U(...e.map(i=>i.onSelectionChange)))):this._initialized.pipe(j(()=>this.optionSelections))});get activeOption(){return this.autocomplete&&this.autocomplete._keyManager?this.autocomplete._keyManager.activeItem:null}_getOutsideClickStream(){return new Z(e=>{let i=n=>{let l=qe(n),m=this._formField?this._formField.getConnectedOverlayOrigin().nativeElement:null,C=this.connectedTo?this.connectedTo.elementRef.nativeElement:null;this._overlayAttached&&l!==this._element.nativeElement&&!this._hasFocus()&&(!m||!m.contains(l))&&(!C||!C.contains(l))&&this._overlayRef&&!this._overlayRef.overlayElement.contains(l)&&e.next(n)},t=[this._renderer.listen("document","click",i),this._renderer.listen("document","auxclick",i),this._renderer.listen("document","touchend",i)];return()=>{t.forEach(n=>n())}})}writeValue(e){Promise.resolve(null).then(()=>this._assignOptionValue(e))}registerOnChange(e){this._onChange=e}registerOnTouched(e){this._onTouched=e}setDisabledState(e){this._element.nativeElement.disabled=e}_handleKeydown(e){let i=e.keyCode,t=Y(e);if(i===27&&!t&&e.preventDefault(),this._valueOnLastKeydown=this._element.nativeElement.value,this.activeOption&&i===13&&this.panelOpen&&!t)this.activeOption._selectViaInteraction(),this._resetActiveItem(),e.preventDefault();else if(this.autocomplete){let n=this.autocomplete._keyManager.activeItem,l=i===38||i===40;i===9||l&&!t&&this.panelOpen?this.autocomplete._keyManager.onKeydown(e):l&&this._canOpen()&&this._openPanelInternal(this._valueOnLastKeydown),(l||this.autocomplete._keyManager.activeItem!==n)&&(this._scrollToOption(this.autocomplete._keyManager.activeItemIndex||0),this.autocomplete.autoSelectActiveOption&&this.activeOption&&(this._pendingAutoselectedOption||(this._valueBeforeAutoSelection=this._valueOnLastKeydown),this._pendingAutoselectedOption=this.activeOption,this._assignOptionValue(this.activeOption.value)))}}_handleInput(e){let i=e.target,t=i.value;if(i.type==="number"&&(t=t==""?null:parseFloat(t)),this._previousValue!==t){if(this._previousValue=t,this._pendingAutoselectedOption=null,(!this.autocomplete||!this.autocomplete.requireSelection)&&this._onChange(t),!t)this._clearPreviousSelectedOption(null,!1);else if(this.panelOpen&&!this.autocomplete.requireSelection){let n=this.autocomplete.options?.find(l=>l.selected);if(n){let l=this._getDisplayValue(n.value);t!==l&&n.deselect(!1)}}if(this._canOpen()&&this._hasFocus()){let n=this._valueOnLastKeydown??this._element.nativeElement.value;this._valueOnLastKeydown=null,this._openPanelInternal(n)}}}_handleFocus(){this._canOpenOnNextFocus?this._canOpen()&&(this._previousValue=this._element.nativeElement.value,this._attachOverlay(this._previousValue),this._floatLabel(!0)):this._canOpenOnNextFocus=!0}_handleClick(){this._canOpen()&&!this.panelOpen&&this._openPanelInternal()}_hasFocus(){return Ye()===this._element.nativeElement}_floatLabel(e=!1){this._formField&&this._formField.floatLabel==="auto"&&(e?this._formField._animateAndLockLabel():this._formField.floatLabel="always",this._manuallyFloatingLabel=!0)}_resetLabel(){this._manuallyFloatingLabel&&(this._formField&&(this._formField.floatLabel="auto"),this._manuallyFloatingLabel=!1)}_subscribeToClosingActions(){let e=new Z(t=>{xe(()=>{t.next()},{injector:this._environmentInjector})}),i=this.autocomplete.options?.changes.pipe(ve(()=>this._positionStrategy.reapplyLastPosition()),ye(0))??te();return U(e,i).pipe(j(()=>this._zone.run(()=>{let t=this.panelOpen;return this._resetActiveItem(),this._updatePanelState(),this._changeDetectorRef.detectChanges(),this.panelOpen&&this._overlayRef.updatePosition(),t!==this.panelOpen&&(this.panelOpen?this._emitOpened():this.autocomplete.closed.emit()),this.panelClosingActions})),ge(1)).subscribe(t=>this._setValueAndClose(t))}_emitOpened(){this.autocomplete.opened.emit()}_destroyPanel(){this._overlayRef&&(this.closePanel(),this._overlayRef.dispose(),this._overlayRef=null)}_getDisplayValue(e){let i=this.autocomplete;return i&&i.displayWith?i.displayWith(e):e}_assignOptionValue(e){let i=this._getDisplayValue(e);e==null&&this._clearPreviousSelectedOption(null,!1),this._updateNativeInputValue(i??"")}_updateNativeInputValue(e){this._formField?this._formField._control.value=e:this._element.nativeElement.value=e,this._previousValue=e}_setValueAndClose(e){let i=this.autocomplete,t=e?e.source:this._pendingAutoselectedOption;t?(this._clearPreviousSelectedOption(t),this._assignOptionValue(t.value),this._onChange(t.value),i._emitSelectEvent(t),this._element.nativeElement.focus()):i.requireSelection&&this._element.nativeElement.value!==this._valueOnAttach&&(this._clearPreviousSelectedOption(null),this._assignOptionValue(null),this._onChange(null)),this.closePanel()}_clearPreviousSelectedOption(e,i){this.autocomplete?.options?.forEach(t=>{t!==e&&t.selected&&t.deselect(i)})}_openPanelInternal(e=this._element.nativeElement.value){if(this._attachOverlay(e),this._floatLabel(),this._trackedModal){let i=this.autocomplete.id;ce(this._trackedModal,"aria-owns",i)}}_attachOverlay(e){this.autocomplete;let i=this._overlayRef;i?(this._positionStrategy.setOrigin(this._getConnectedElement()),i.updateSize({width:this._getPanelWidth()})):(this._portal=new Vt(this.autocomplete.template,this._viewContainerRef,{id:this._formField?.getLabelId()}),i=this._overlay.create(this._getOverlayConfig()),this._overlayRef=i,this._viewportSubscription=this._viewportRuler.change().subscribe(()=>{this.panelOpen&&i&&i.updateSize({width:this._getPanelWidth()})}),this._handsetLandscapeSubscription=this._breakpointObserver.observe(jt.HandsetLandscape).subscribe(n=>{n.matches?this._positionStrategy.withFlexibleDimensions(!0).withGrowAfterOpen(!0).withViewportMargin(8):this._positionStrategy.withFlexibleDimensions(!1).withGrowAfterOpen(!1).withViewportMargin(0)})),i&&!i.hasAttached()&&(i.attach(this._portal),this._valueOnAttach=e,this._valueOnLastKeydown=null,this._closingActionsSubscription=this._subscribeToClosingActions());let t=this.panelOpen;this.autocomplete._isOpen=this._overlayAttached=!0,this.autocomplete._latestOpeningTrigger=this,this.autocomplete._setColor(this._formField?.color),this._updatePanelState(),this._applyModalPanelOwnership(),this.panelOpen&&t!==this.panelOpen&&this._emitOpened()}_handlePanelKeydown=e=>{(e.keyCode===27&&!Y(e)||e.keyCode===38&&Y(e,"altKey"))&&(this._pendingAutoselectedOption&&(this._updateNativeInputValue(this._valueBeforeAutoSelection??""),this._pendingAutoselectedOption=null),this._closeKeyEventStream.next(),this._resetActiveItem(),e.stopPropagation(),e.preventDefault())};_updatePanelState(){if(this.autocomplete._setVisibility(),this.panelOpen){let e=this._overlayRef;this._keydownSubscription||(this._keydownSubscription=e.keydownEvents().subscribe(this._handlePanelKeydown)),this._outsideClickSubscription||(this._outsideClickSubscription=e.outsidePointerEvents().subscribe())}else this._keydownSubscription?.unsubscribe(),this._outsideClickSubscription?.unsubscribe(),this._keydownSubscription=this._outsideClickSubscription=null}_getOverlayConfig(){return new Ft({positionStrategy:this._getOverlayPosition(),scrollStrategy:this._scrollStrategy(),width:this._getPanelWidth(),direction:this._dir??void 0,hasBackdrop:this._defaults?.hasBackdrop,backdropClass:this._defaults?.backdropClass,panelClass:this._defaults?.overlayPanelClass})}_getOverlayPosition(){let e=this._overlay.position().flexibleConnectedTo(this._getConnectedElement()).withFlexibleDimensions(!1).withPush(!1);return this._setStrategyPositions(e),this._positionStrategy=e,e}_setStrategyPositions(e){let i=[{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"},{originX:"end",originY:"bottom",overlayX:"end",overlayY:"top"}],t=this._aboveClass,n=[{originX:"start",originY:"top",overlayX:"start",overlayY:"bottom",panelClass:t},{originX:"end",originY:"top",overlayX:"end",overlayY:"bottom",panelClass:t}],l;this.position==="above"?l=n:this.position==="below"?l=i:l=[...i,...n],e.withPositions(l)}_getConnectedElement(){return this.connectedTo?this.connectedTo.elementRef:this._formField?this._formField.getConnectedOverlayOrigin():this._element}_getPanelWidth(){return this.autocomplete.panelWidth||this._getHostWidth()}_getHostWidth(){return this._getConnectedElement().nativeElement.getBoundingClientRect().width}_resetActiveItem(){let e=this.autocomplete;if(e.autoActiveFirstOption){let i=-1;for(let t=0;t<e.options.length;t++)if(!e.options.get(t).disabled){i=t;break}e._keyManager.setActiveItem(i)}else e._keyManager.setActiveItem(-1)}_canOpen(){let e=this._element.nativeElement;return!e.readOnly&&!e.disabled&&!this.autocompleteDisabled}_scrollToOption(e){let i=this.autocomplete,t=nt(e,i.options,i.optionGroups);if(e===0&&t===1)i._setScrollTop(0);else if(i.panel){let n=i.options.toArray()[e];if(n){let l=n._getHostElement(),m=at(l.offsetTop,l.offsetHeight,i._getScrollTop(),i.panel.nativeElement.offsetHeight);i._setScrollTop(m)}}}_trackedModal=null;_applyModalPanelOwnership(){let e=this._element.nativeElement.closest('body > .cdk-overlay-container [aria-modal="true"]');if(!e)return;let i=this.autocomplete.id;this._trackedModal&&q(this._trackedModal,"aria-owns",i),ce(e,"aria-owns",i),this._trackedModal=e}_clearFromModal(){if(this._trackedModal){let e=this.autocomplete.id;q(this._trackedModal,"aria-owns",e),this._trackedModal=null}}static \u0275fac=function(i){return new(i||o)};static \u0275dir=Pe({type:o,selectors:[["input","matAutocomplete",""],["textarea","matAutocomplete",""]],hostAttrs:[1,"mat-mdc-autocomplete-trigger"],hostVars:7,hostBindings:function(i,t){i&1&&g("focusin",function(){return t._handleFocus()})("blur",function(){return t._onTouched()})("input",function(l){return t._handleInput(l)})("keydown",function(l){return t._handleKeydown(l)})("click",function(){return t._handleClick()}),i&2&&ae("autocomplete",t.autocompleteAttribute)("role",t.autocompleteDisabled?null:"combobox")("aria-autocomplete",t.autocompleteDisabled?null:"list")("aria-activedescendant",t.panelOpen&&t.activeOption?t.activeOption.id:null)("aria-expanded",t.autocompleteDisabled?null:t.panelOpen.toString())("aria-controls",t.autocompleteDisabled||!t.panelOpen||t.autocomplete==null?null:t.autocomplete.id)("aria-haspopup",t.autocompleteDisabled?null:"listbox")},inputs:{autocomplete:[0,"matAutocomplete","autocomplete"],position:[0,"matAutocompletePosition","position"],connectedTo:[0,"matAutocompleteConnectedTo","connectedTo"],autocompleteAttribute:[0,"autocomplete","autocompleteAttribute"],autocompleteDisabled:[2,"matAutocompleteDisabled","autocompleteDisabled",k]},exportAs:["matAutocompleteTrigger"],features:[pe([Bi]),Se]})}return o})(),Ci=(()=>{class o{static \u0275fac=function(i){return new(i||o)};static \u0275mod=Ee({type:o});static \u0275inj=Ce({providers:[$i],imports:[Lt,ue,de,It,ue,de]})}return o})();var Ni=()=>[10,25,50,100],A=(o,c)=>c.id,Ui=(o,c)=>c.label,ji=(o,c)=>c.field;function Hi(o,c){if(o&1&&(r(0,"mat-option",32),p(1),a()),o&2){let e=c.$implicit;d("value",e),s(),b(e.name)}}function Gi(o,c){if(o&1&&(r(0,"mat-option",32),p(1),a()),o&2){let e=c.$implicit;d("value",e),s(),b(e.name)}}function Ki(o,c){if(o&1&&(r(0,"mat-option",32),p(1),a()),o&2){let e=c.$implicit;d("value",e),s(),b(e.name)}}function Yi(o,c){if(o&1&&(r(0,"mat-option",32),p(1),a()),o&2){let e=c.$implicit;d("value",e),s(),b(e.name)}}function qi(o,c){if(o&1&&(r(0,"mat-option",32),p(1),a()),o&2){let e=c.$implicit;d("value",e),s(),b(e.name)}}function Qi(o,c){if(o&1&&(r(0,"mat-option",32),p(1),a()),o&2){let e=c.$implicit;d("value",e),s(),b(e.name)}}function Xi(o,c){if(o&1&&(r(0,"mat-option",32),p(1),a()),o&2){let e=c.$implicit;d("value",e),s(),b(e.name)}}function Ji(o,c){if(o&1&&(r(0,"mat-option",32),p(1),a()),o&2){let e=c.$implicit;d("value",e),s(),b(e.name)}}function Zi(o,c){o&1&&(r(0,"div",35),y(1,"mat-spinner",39),r(2,"p"),p(3,"Generating report..."),a()())}function eo(o,c){if(o&1&&(r(0,"mat-card",40)(1,"mat-card-content")(2,"div",41)(3,"mat-icon"),p(4),a()(),r(5,"div",42)(6,"span",43),p(7),a(),r(8,"span",44),p(9),a()()()()),o&2){let e=c.$implicit;s(2),G("background",e.color+"20")("color",e.color),s(2),b(e.icon),s(3),b(e.value),s(2),b(e.label)}}function to(o,c){if(o&1&&(r(0,"div",36),S(1,eo,10,7,"mat-card",40,Ui),a()),o&2){let e=u();s(),M(e.getSummaryItems())}}function io(o,c){if(o&1&&(r(0,"th",55),p(1),a()),o&2){let e=u().$implicit;G("text-align",e.align||"left"),s(),w(" ",e.header," ")}}function oo(o,c){if(o&1&&(p(0),O(1,"date")),o&2){let e=u().$implicit,i=u().$implicit;w(" ",z(1,1,e[i.field],"mediumDate")," ")}}function no(o,c){if(o&1&&(p(0),O(1,"date")),o&2){let e=u().$implicit,i=u().$implicit;w(" ",z(1,1,e[i.field],"medium")," ")}}function ao(o,c){if(o&1&&(p(0),O(1,"currency")),o&2){let e=u().$implicit,i=u().$implicit;w(" ",$(1,1,e[i.field])," ")}}function ro(o,c){if(o&1&&(p(0),O(1,"number")),o&2){let e=u().$implicit,i=u().$implicit;w(" ",$(1,1,e[i.field])," ")}}function lo(o,c){if(o&1&&(p(0),O(1,"number")),o&2){let e=u().$implicit,i=u().$implicit;w(" ",z(1,1,e[i.field],"1.1-1"),"% ")}}function so(o,c){if(o&1&&(r(0,"span",58),p(1),a()),o&2){let e=u().$implicit,i=u().$implicit;K(e[i.field]==null?null:e[i.field].toLowerCase()),s(),w(" ",e[i.field]," ")}}function po(o,c){if(o&1&&p(0),o&2){let e=u().$implicit,i=u().$implicit;w(" ",e[i.field]," ")}}function mo(o,c){if(o&1&&(r(0,"td",56),R(1,oo,2,4)(2,no,2,4)(3,ao,2,3)(4,ro,2,3)(5,lo,2,4)(6,so,2,3,"span",57)(7,po,1,1),a()),o&2){let e=u().$implicit;G("text-align",e.align||"left"),s(),P(e.type==="date"?1:e.type==="datetime"?2:e.type==="currency"?3:e.type==="number"?4:e.type==="percentage"?5:e.type==="status"?6:7)}}function co(o,c){if(o&1&&(Te(0,49),R(1,io,2,3,"th",53)(2,mo,8,3,"td",54),Ie()),o&2){let e=c.$implicit;d("matColumnDef",e.field)}}function uo(o,c){o&1&&y(0,"tr",59)}function ho(o,c){o&1&&y(0,"tr",60)}function fo(o,c){if(o&1){let e=re();r(0,"mat-card",37)(1,"mat-card-header")(2,"mat-card-title")(3,"mat-icon"),p(4,"table_chart"),a(),p(5," Results "),r(6,"span",45),p(7),a()(),r(8,"span",46),p(9),O(10,"date"),a()(),r(11,"mat-card-content")(12,"div",47)(13,"table",48),g("matSortChange",function(t){f(e);let n=u();return _(n.sortData(t))}),S(14,co,3,1,"ng-container",49,ji),R(16,uo,1,0,"tr",50)(17,ho,1,0,"tr",51),a()(),r(18,"mat-paginator",52),g("page",function(t){f(e);let n=u();return _(n.onPageChange(t))}),a()()()}if(o&2){let e=u();s(7),w("(",e.reportResult.data.length," records)"),s(2),w("Generated: ",z(10,8,e.reportResult.generatedAt,"medium"),""),s(4),d("dataSource",e.paginatedData),s(),M(e.reportResult.columns),s(2),d("matHeaderRowDef",e.displayedColumns),s(),d("matRowDefColumns",e.displayedColumns),s(),d("length",e.reportResult.data.length)("pageSize",e.pageSize)("pageSizeOptions",Le(11,Ni))}}function _o(o,c){o&1&&(r(0,"div",38)(1,"mat-icon"),p(2,"assessment"),a(),r(3,"h3"),p(4,"Ready to Generate"),a(),r(5,"p"),p(6,'Configure the filters above and click "Run Report" to generate results'),a()())}var kn=(()=>{class o{route;router;reportService;snackBar;http;reportId="";report=null;reportResult=null;loading=!1;exporting=!1;reportFontSize="14px";parameters={startDate:new Date(new Date().setMonth(new Date().getMonth()-1)),endDate:new Date,approvedStartDate:null,approvedEndDate:null,status:"",workflowId:"",userId:"",corporateId:"",sbuId:"",branchId:"",departmentId:"",groupBy:""};statusControl=new x("");workflowControl=new x("");userControl=new x("");corporateControl=new x("");sbuControl=new x("");branchControl=new x("");departmentControl=new x("");groupByControl=new x("");statuses=[{id:"",name:"All Statuses"},{id:"DRAFT",name:"Draft"},{id:"PENDING",name:"Pending"},{id:"APPROVED",name:"Approved"},{id:"REJECTED",name:"Rejected"},{id:"ESCALATED",name:"Escalated"},{id:"CANCELLED",name:"Cancelled"}];groupByOptions=[{id:"",name:"None"},{id:"day",name:"Day"},{id:"week",name:"Week"},{id:"month",name:"Month"},{id:"workflow",name:"Workflow"},{id:"user",name:"User"},{id:"sbu",name:"SBU"},{id:"status",name:"Status"}];filteredStatuses;filteredGroupByOptions;workflows=[];users=[];corporates=[];sbus=[];filteredSbus=[];branches=[];filteredBranches=[];departments=[];displayedColumns=[];paginatedData=[];pageSize=25;currentPage=0;apiUrl="/api";constructor(e,i,t,n,l){this.route=e,this.router=i,this.reportService=t,this.snackBar=n,this.http=l}ngOnInit(){this.route.params.subscribe(e=>{this.reportId=e.reportId,this.loadReportDefinition()}),this.loadLookupData(),this.loadReportSettings(),this.setupAutocompleteFilters()}setupAutocompleteFilters(){this.filteredStatuses=this.statusControl.valueChanges.pipe(T(""),D(e=>this.filterOptions(this.statuses,e))),this.filteredGroupByOptions=this.groupByControl.valueChanges.pipe(T(""),D(e=>this.filterOptions(this.groupByOptions,e)))}getFilteredWorkflows(){let e=this.workflowControl.value;return this.filterOptions([{id:"",name:"All Workflows"},...this.workflows],e)}getFilteredUsers(){let e=this.userControl.value;return this.filterOptions([{id:"",name:"All Users"},...this.users],e)}getFilteredCorporates(){let e=this.corporateControl.value;return this.filterOptions([{id:"",name:"All Corporates"},...this.corporates],e)}getFilteredSbuOptions(){let e=this.sbuControl.value;return this.filterOptions([{id:"",name:"All SBUs"},...this.filteredSbus],e)}getFilteredBranchOptions(){let e=this.branchControl.value;return this.filterOptions([{id:"",name:"All Branches"},...this.filteredBranches],e)}getFilteredDepartments(){let e=this.departmentControl.value;return this.filterOptions([{id:"",name:"All Departments"},...this.departments],e)}filterOptions(e,i){if(!i)return e;let t=typeof i=="string"?i.toLowerCase():i?.name?.toLowerCase()||"";return e.filter(n=>n.name.toLowerCase().includes(t))}displayLookup=e=>e?.name||"";displayStatus=e=>e?.name||"";onStatusSelected(e){let i=e.option.value;this.parameters.status=i?.id||""}onWorkflowSelected(e){let i=e.option.value;this.parameters.workflowId=i?.id||""}onUserSelected(e){let i=e.option.value;this.parameters.userId=i?.id||""}onCorporateSelected(e){let i=e.option.value;this.parameters.corporateId=i?.id||"",this.onCorporateChange()}onSbuSelected(e){let i=e.option.value;this.parameters.sbuId=i?.id||"",this.onSbuChange()}onBranchSelected(e){let i=e.option.value;this.parameters.branchId=i?.id||""}onDepartmentSelected(e){let i=e.option.value;this.parameters.departmentId=i?.id||""}onGroupBySelected(e){let i=e.option.value;this.parameters.groupBy=i?.id||""}loadReportSettings(){this.http.get(`${this.apiUrl}/settings/by-key/reporting.font.size`).subscribe({next:e=>{e.success&&e.data?.value&&(this.reportFontSize=e.data.value+"px",document.documentElement.style.setProperty("--report-font-size",this.reportFontSize))},error:()=>{document.documentElement.style.setProperty("--report-font-size","14px")}})}loadLookupData(){this.http.get(`${this.apiUrl}/workflows`).subscribe({next:e=>{if(e.success&&e.data){let i=e.data.content||e.data;Array.isArray(i)&&(this.workflows=i.map(t=>({id:t.id,name:t.name})))}}}),this.http.get(`${this.apiUrl}/users`).subscribe({next:e=>{if(e.success&&e.data){let i=e.data.content||e.data;Array.isArray(i)&&(this.users=i.map(t=>({id:t.id,name:t.fullName||t.username})))}}}),this.http.get(`${this.apiUrl}/corporates`).subscribe({next:e=>{e.success&&e.data&&(this.corporates=e.data.map(i=>({id:i.id,name:i.name})))}}),this.http.get(`${this.apiUrl}/sbus`).subscribe({next:e=>{e.success&&e.data&&(this.sbus=e.data.map(i=>({id:i.id,name:i.name,corporateId:i.corporateId})),this.filteredSbus=[...this.sbus])}}),this.http.get(`${this.apiUrl}/branches`).subscribe({next:e=>{e.success&&e.data&&(this.branches=e.data.map(i=>({id:i.id,name:i.name,sbuId:i.sbuId})),this.filteredBranches=[...this.branches])}}),this.http.get(`${this.apiUrl}/departments`).subscribe({next:e=>{e.success&&e.data&&(this.departments=e.data.map(i=>({id:i.id,name:i.name})))}})}onCorporateChange(){this.parameters.corporateId?this.filteredSbus=this.sbus.filter(e=>e.corporateId===this.parameters.corporateId):this.filteredSbus=[...this.sbus],this.parameters.sbuId="",this.parameters.branchId="",this.filteredBranches=[]}onSbuChange(){this.parameters.sbuId?this.filteredBranches=this.branches.filter(e=>e.sbuId===this.parameters.sbuId):this.filteredBranches=[...this.branches],this.parameters.branchId=""}clearFilters(){this.parameters={startDate:new Date(new Date().setMonth(new Date().getMonth()-1)),endDate:new Date,approvedStartDate:null,approvedEndDate:null,status:"",workflowId:"",userId:"",corporateId:"",sbuId:"",branchId:"",departmentId:"",groupBy:""},this.statusControl.setValue(""),this.workflowControl.setValue(""),this.userControl.setValue(""),this.corporateControl.setValue(""),this.sbuControl.setValue(""),this.branchControl.setValue(""),this.departmentControl.setValue(""),this.groupByControl.setValue(""),this.filteredSbus=[...this.sbus],this.filteredBranches=[...this.branches]}loadReportDefinition(){let e=this.reportService.getAllReports();this.report=e.find(i=>i.id===this.reportId)||null,this.report||(this.snackBar.open("Report not found","Close",{duration:3e3}),this.router.navigate(["/reports"]))}runReport(){this.loading=!0,this.reportService.generateReport(this.reportId,this.formatParameters()).subscribe({next:e=>{e.success?(this.reportResult=e.data,this.displayedColumns=e.data.columns.map(i=>i.field),this.updatePaginatedData()):this.generateMockData(),this.loading=!1},error:()=>{this.generateMockData(),this.loading=!1}})}generateMockData(){let e={columns:this.getMockColumns(),data:this.getMockData(),summary:this.getMockSummary(),generatedAt:new Date().toISOString()};this.reportResult=e,this.displayedColumns=e.columns.map(i=>i.field),this.updatePaginatedData()}getMockColumns(){switch(this.report?.category){case"submissions":return[{field:"referenceNumber",header:"Reference",type:"string"},{field:"workflow",header:"Workflow",type:"string"},{field:"submitter",header:"Submitted By",type:"string"},{field:"status",header:"Status",type:"status"},{field:"submittedAt",header:"Submitted Date",type:"date"},{field:"count",header:"Count",type:"number",align:"right"}];case"approvals":return[{field:"approver",header:"Approver",type:"string"},{field:"approved",header:"Approved",type:"number",align:"right"},{field:"rejected",header:"Rejected",type:"number",align:"right"},{field:"pending",header:"Pending",type:"number",align:"right"},{field:"avgResponseTime",header:"Avg Response (hrs)",type:"number",align:"right"}];case"performance":return[{field:"workflow",header:"Workflow",type:"string"},{field:"avgProcessingTime",header:"Avg Time (hrs)",type:"number",align:"right"},{field:"minTime",header:"Min Time",type:"number",align:"right"},{field:"maxTime",header:"Max Time",type:"number",align:"right"},{field:"completionRate",header:"Completion %",type:"percentage",align:"right"}];case"financial":return[{field:"category",header:"Category",type:"string"},{field:"totalAmount",header:"Total Amount",type:"currency",align:"right"},{field:"count",header:"Count",type:"number",align:"right"},{field:"avgAmount",header:"Average",type:"currency",align:"right"}];default:return[{field:"name",header:"Name",type:"string"},{field:"value",header:"Value",type:"number",align:"right"},{field:"percentage",header:"Percentage",type:"percentage",align:"right"}]}}getMockData(){let e=this.report?.category,i=["PENDING","APPROVED","REJECTED","DRAFT"],t=["Leave Request","Expense Claim","Purchase Order","Travel Request","Overtime Request"],n=["John Smith","Jane Doe","Bob Wilson","Alice Brown","Charlie Davis"];switch(e){case"submissions":return Array.from({length:20},(l,m)=>({referenceNumber:`REF-2024-${String(m+1).padStart(4,"0")}`,workflow:t[m%t.length],submitter:n[m%n.length],status:i[m%i.length],submittedAt:new Date(Date.now()-Math.random()*30*24*60*60*1e3),count:Math.floor(Math.random()*50)+1}));case"approvals":return n.map(l=>({approver:l,approved:Math.floor(Math.random()*50)+10,rejected:Math.floor(Math.random()*10),pending:Math.floor(Math.random()*15),avgResponseTime:(Math.random()*24+1).toFixed(1)}));case"performance":return t.map(l=>({workflow:l,avgProcessingTime:(Math.random()*48+2).toFixed(1),minTime:(Math.random()*2+.5).toFixed(1),maxTime:(Math.random()*72+24).toFixed(1),completionRate:(Math.random()*30+70).toFixed(1)}));case"financial":return t.map(l=>({category:l,totalAmount:Math.floor(Math.random()*1e5)+1e4,count:Math.floor(Math.random()*100)+20,avgAmount:Math.floor(Math.random()*5e3)+500}));default:return Array.from({length:10},(l,m)=>({name:`Item ${m+1}`,value:Math.floor(Math.random()*1e3),percentage:(Math.random()*100).toFixed(1)}))}}getMockSummary(){return{totalRecords:Math.floor(Math.random()*500)+100,totalAmount:Math.floor(Math.random()*5e5)+5e4,avgProcessingTime:(Math.random()*24+4).toFixed(1),completionRate:(Math.random()*20+80).toFixed(1)}}getSummaryItems(){if(!this.reportResult?.summary)return[];let e=this.reportResult.summary;return[{label:"Total Records",value:e.totalRecords?.toLocaleString()||"0",icon:"description",color:"#1976d2"},{label:"Total Amount",value:"$"+(e.totalAmount?.toLocaleString()||"0"),icon:"attach_money",color:"#2e7d32"},{label:"Avg Processing Time",value:(e.avgProcessingTime||"0")+" hrs",icon:"schedule",color:"#ed6c02"},{label:"Completion Rate",value:(e.completionRate||"0")+"%",icon:"check_circle",color:"#9c27b0"}]}formatParameters(){let e={};return this.parameters.startDate&&(e.startDate=this.parameters.startDate.toISOString().split("T")[0]),this.parameters.endDate&&(e.endDate=this.parameters.endDate.toISOString().split("T")[0]),this.parameters.approvedStartDate&&(e.approvedStartDate=this.parameters.approvedStartDate.toISOString().split("T")[0]),this.parameters.approvedEndDate&&(e.approvedEndDate=this.parameters.approvedEndDate.toISOString().split("T")[0]),this.parameters.status&&(e.status=this.parameters.status),this.parameters.workflowId&&(e.workflowId=this.parameters.workflowId),this.parameters.userId&&(e.userId=this.parameters.userId),this.parameters.corporateId&&(e.corporateId=this.parameters.corporateId),this.parameters.sbuId&&(e.sbuId=this.parameters.sbuId),this.parameters.branchId&&(e.branchId=this.parameters.branchId),this.parameters.departmentId&&(e.departmentId=this.parameters.departmentId),this.parameters.groupBy&&(e.groupBy=this.parameters.groupBy),e}updatePaginatedData(){if(!this.reportResult)return;let e=this.currentPage*this.pageSize;this.paginatedData=this.reportResult.data.slice(e,e+this.pageSize)}onPageChange(e){this.currentPage=e.pageIndex,this.pageSize=e.pageSize,this.updatePaginatedData()}sortData(e){if(!this.reportResult)return;let i=[...this.reportResult.data];!e.active||e.direction===""||(i.sort((t,n)=>{let l=e.direction==="asc";return this.compare(t[e.active],n[e.active],l)}),this.reportResult.data=i,this.updatePaginatedData())}compare(e,i,t){return e==null?t?1:-1:i==null?t?-1:1:(e<i?-1:1)*(t?1:-1)}exportReport(e){if(!this.reportResult){this.snackBar.open("Please run the report first","Close",{duration:3e3});return}switch(this.exporting=!0,this.snackBar.open(`Exporting to ${e.toUpperCase()}...`,"",{duration:2e3}),e){case"excel":this.exportToExcel();break;case"csv":this.exportToCsv();break;case"pdf":this.exportToPdf();break}}exportToExcel(){let e=this.reportResult.columns,i=this.reportResult.data,t=`<?xml version="1.0"?>
`;t+=`<?mso-application progid="Excel.Sheet"?>
`,t+=`<Workbook xmlns="urn:schemas-microsoft-com:office:spreadsheet"
`,t+=`  xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet">
`,t+=`  <Worksheet ss:Name="Report">
`,t+=`    <Table>
`,t+=`      <Row>
`,e.forEach(l=>{t+=`        <Cell><Data ss:Type="String">${this.escapeXml(l.header)}</Data></Cell>
`}),t+=`      </Row>
`,i.forEach(l=>{t+=`      <Row>
`,e.forEach(m=>{let C=l[m.field];t+=`        <Cell><Data ss:Type="${typeof C=="number"?"Number":"String"}">${this.escapeXml(String(C??""))}</Data></Cell>
`}),t+=`      </Row>
`}),t+=`    </Table>
`,t+=`  </Worksheet>
`,t+="</Workbook>";let n=new Blob([t],{type:"application/vnd.ms-excel"});this.downloadBlob(n,`${this.report?.name||"report"}.xls`),this.exporting=!1,this.snackBar.open("Export completed","Close",{duration:3e3})}exportToCsv(){let e=this.reportResult.columns,i=this.reportResult.data,t=e.map(l=>`"${l.header}"`).join(",")+`
`;i.forEach(l=>{t+=e.map(m=>{let C=l[m.field];return C==null?'""':typeof C=="string"?`"${C.replace(/"/g,'""')}"`:`"${C}"`}).join(",")+`
`});let n=new Blob([t],{type:"text/csv;charset=utf-8;"});this.downloadBlob(n,`${this.report?.name||"report"}.csv`),this.exporting=!1,this.snackBar.open("Export completed","Close",{duration:3e3})}exportToPdf(){let e=this.reportResult.columns,i=this.reportResult.data,t=`
      <!DOCTYPE html>
      <html>
      <head>
        <title>${this.report?.name||"Report"}</title>
        <style>
          body { font-family: Arial, sans-serif; margin: 20px; }
          h1 { color: #1976d2; font-size: 24px; margin-bottom: 5px; }
          .subtitle { color: #666; margin-bottom: 20px; }
          .meta { color: #999; font-size: 12px; margin-bottom: 20px; }
          table { border-collapse: collapse; width: 100%; font-size: 12px; }
          th { background: #1976d2; color: white; padding: 10px; text-align: left; }
          td { padding: 8px; border-bottom: 1px solid #ddd; }
          tr:nth-child(even) { background: #f9f9f9; }
          .summary { margin-top: 20px; padding: 15px; background: #f5f5f5; border-radius: 8px; }
          .summary h3 { margin: 0 0 10px 0; color: #333; }
          .summary-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; }
          .summary-item { text-align: center; }
          .summary-value { font-size: 18px; font-weight: bold; color: #1976d2; }
          .summary-label { font-size: 11px; color: #666; }
          @media print {
            body { margin: 0; }
            .no-print { display: none; }
          }
        </style>
      </head>
      <body>
        <h1>${this.report?.name||"Report"}</h1>
        <p class="subtitle">${this.report?.description||""}</p>
        <p class="meta">Generated: ${new Date().toLocaleString()} | Records: ${i.length}</p>

        <div class="summary">
          <h3>Summary</h3>
          <div class="summary-grid">
            ${this.getSummaryItems().map(l=>`
              <div class="summary-item">
                <div class="summary-value">${l.value}</div>
                <div class="summary-label">${l.label}</div>
              </div>
            `).join("")}
          </div>
        </div>

        <table>
          <thead>
            <tr>
              ${e.map(l=>`<th>${l.header}</th>`).join("")}
            </tr>
          </thead>
          <tbody>
            ${i.map(l=>`
              <tr>
                ${e.map(m=>`<td>${this.formatCellValue(l[m.field],m.type)}</td>`).join("")}
              </tr>
            `).join("")}
          </tbody>
        </table>
      </body>
      </html>
    `,n=window.open("","_blank");n&&(n.document.write(t),n.document.close(),n.focus(),setTimeout(()=>{n.print(),n.close()},250)),this.exporting=!1,this.snackBar.open("PDF opened for printing","Close",{duration:3e3})}formatCellValue(e,i){if(e==null)return"";switch(i){case"date":return new Date(e).toLocaleDateString();case"datetime":return new Date(e).toLocaleString();case"currency":return"$"+Number(e).toLocaleString();case"number":return Number(e).toLocaleString();case"percentage":return Number(e).toFixed(1)+"%";default:return String(e)}}escapeXml(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}downloadBlob(e,i){let t=window.URL.createObjectURL(e),n=document.createElement("a");n.href=t,n.download=i,document.body.appendChild(n),n.click(),document.body.removeChild(n),window.URL.revokeObjectURL(t)}static \u0275fac=function(i){return new(i||o)(E(je),E(He),E(Kt),E(Ht),E(Ue))};static \u0275cmp=H({type:o,selectors:[["app-report-viewer"]],decls:176,vars:50,consts:[["exportMenu","matMenu"],["startPicker",""],["endPicker",""],["approvedStartPicker",""],["approvedEndPicker",""],["statusAuto","matAutocomplete"],["workflowAuto","matAutocomplete"],["userAuto","matAutocomplete"],["corporateAuto","matAutocomplete"],["sbuAuto","matAutocomplete"],["branchAuto","matAutocomplete"],["departmentAuto","matAutocomplete"],["groupByAuto","matAutocomplete"],[1,"report-viewer"],[1,"header"],[1,"header-left"],["mat-icon-button","","routerLink","/reports"],[1,"report-title"],[1,"subtitle"],[1,"header-actions"],["mat-raised-button","","color","primary",3,"click","disabled"],["mat-button","",3,"matMenuTriggerFor","disabled"],["mat-menu-item","",3,"click"],[1,"parameters-card"],[1,"parameters-form"],[1,"filter-field"],["appearance","outline"],["matInput","",3,"ngModelChange","matDatepicker","ngModel"],["matSuffix","",3,"for"],["type","text","matInput","",3,"formControl","matAutocomplete"],["matSuffix",""],[3,"optionSelected","displayWith"],[3,"value"],[1,"filter-actions"],["mat-button","",3,"click"],[1,"loading-state"],[1,"summary-cards"],[1,"results-card"],[1,"empty-state"],["diameter","40"],[1,"summary-card"],[1,"summary-icon"],[1,"summary-info"],[1,"summary-value"],[1,"summary-label"],[1,"result-count"],[1,"generated-at"],[1,"table-container"],["mat-table","","matSort","",3,"matSortChange","dataSource"],[3,"matColumnDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","",3,"page","length","pageSize","pageSizeOptions"],["mat-header-cell","","mat-sort-header","",3,"text-align",4,"matHeaderCellDef"],["mat-cell","",3,"text-align",4,"matCellDef"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],[1,"status-badge",3,"class"],[1,"status-badge"],["mat-header-row",""],["mat-row",""]],template:function(i,t){if(i&1){let n=re();r(0,"div",13)(1,"div",14)(2,"div",15)(3,"button",16)(4,"mat-icon"),p(5,"arrow_back"),a()(),r(6,"div",17)(7,"h1"),p(8),a(),r(9,"p",18),p(10),a()()(),r(11,"div",19)(12,"button",20),g("click",function(){return f(n),_(t.runReport())}),r(13,"mat-icon"),p(14,"play_arrow"),a(),p(15," Run Report "),a(),r(16,"button",21)(17,"mat-icon"),p(18,"download"),a(),p(19),a(),r(20,"mat-menu",null,0)(22,"button",22),g("click",function(){return f(n),_(t.exportReport("excel"))}),r(23,"mat-icon"),p(24,"table_chart"),a(),r(25,"span"),p(26,"Export to Excel (.xlsx)"),a()(),r(27,"button",22),g("click",function(){return f(n),_(t.exportReport("csv"))}),r(28,"mat-icon"),p(29,"description"),a(),r(30,"span"),p(31,"Export to CSV"),a()(),r(32,"button",22),g("click",function(){return f(n),_(t.exportReport("pdf"))}),r(33,"mat-icon"),p(34,"picture_as_pdf"),a(),r(35,"span"),p(36,"Export to PDF"),a()()()()(),r(37,"mat-card",23)(38,"mat-card-header")(39,"mat-card-title")(40,"mat-icon"),p(41,"tune"),a(),p(42," Report Filters "),a()(),r(43,"mat-card-content")(44,"div",24)(45,"div",25)(46,"mat-form-field",26)(47,"mat-label"),p(48,"Date Captured - From"),a(),r(49,"input",27),W("ngModelChange",function(m){return f(n),B(t.parameters.startDate,m)||(t.parameters.startDate=m),_(m)}),a(),y(50,"mat-datepicker-toggle",28)(51,"mat-datepicker",null,1),a()(),r(53,"div",25)(54,"mat-form-field",26)(55,"mat-label"),p(56,"Date Captured - To"),a(),r(57,"input",27),W("ngModelChange",function(m){return f(n),B(t.parameters.endDate,m)||(t.parameters.endDate=m),_(m)}),a(),y(58,"mat-datepicker-toggle",28)(59,"mat-datepicker",null,2),a()(),r(61,"div",25)(62,"mat-form-field",26)(63,"mat-label"),p(64,"Date Approved - From"),a(),r(65,"input",27),W("ngModelChange",function(m){return f(n),B(t.parameters.approvedStartDate,m)||(t.parameters.approvedStartDate=m),_(m)}),a(),y(66,"mat-datepicker-toggle",28)(67,"mat-datepicker",null,3),a()(),r(69,"div",25)(70,"mat-form-field",26)(71,"mat-label"),p(72,"Date Approved - To"),a(),r(73,"input",27),W("ngModelChange",function(m){return f(n),B(t.parameters.approvedEndDate,m)||(t.parameters.approvedEndDate=m),_(m)}),a(),y(74,"mat-datepicker-toggle",28)(75,"mat-datepicker",null,4),a()(),r(77,"div",25)(78,"mat-form-field",26)(79,"mat-label"),p(80,"Status"),a(),y(81,"input",29),r(82,"mat-icon",30),p(83,"arrow_drop_down"),a(),r(84,"mat-autocomplete",31,5),g("optionSelected",function(m){return f(n),_(t.onStatusSelected(m))}),S(86,Hi,2,2,"mat-option",32,A),O(88,"async"),a()()(),r(89,"div",25)(90,"mat-form-field",26)(91,"mat-label"),p(92,"Workflow"),a(),y(93,"input",29),r(94,"mat-icon",30),p(95,"arrow_drop_down"),a(),r(96,"mat-autocomplete",31,6),g("optionSelected",function(m){return f(n),_(t.onWorkflowSelected(m))}),S(98,Gi,2,2,"mat-option",32,A),a()()(),r(100,"div",25)(101,"mat-form-field",26)(102,"mat-label"),p(103,"User"),a(),y(104,"input",29),r(105,"mat-icon",30),p(106,"arrow_drop_down"),a(),r(107,"mat-autocomplete",31,7),g("optionSelected",function(m){return f(n),_(t.onUserSelected(m))}),S(109,Ki,2,2,"mat-option",32,A),a()()(),r(111,"div",25)(112,"mat-form-field",26)(113,"mat-label"),p(114,"Corporate"),a(),y(115,"input",29),r(116,"mat-icon",30),p(117,"arrow_drop_down"),a(),r(118,"mat-autocomplete",31,8),g("optionSelected",function(m){return f(n),_(t.onCorporateSelected(m))}),S(120,Yi,2,2,"mat-option",32,A),a()()(),r(122,"div",25)(123,"mat-form-field",26)(124,"mat-label"),p(125,"SBU"),a(),y(126,"input",29),r(127,"mat-icon",30),p(128,"arrow_drop_down"),a(),r(129,"mat-autocomplete",31,9),g("optionSelected",function(m){return f(n),_(t.onSbuSelected(m))}),S(131,qi,2,2,"mat-option",32,A),a()()(),r(133,"div",25)(134,"mat-form-field",26)(135,"mat-label"),p(136,"Branch"),a(),y(137,"input",29),r(138,"mat-icon",30),p(139,"arrow_drop_down"),a(),r(140,"mat-autocomplete",31,10),g("optionSelected",function(m){return f(n),_(t.onBranchSelected(m))}),S(142,Qi,2,2,"mat-option",32,A),a()()(),r(144,"div",25)(145,"mat-form-field",26)(146,"mat-label"),p(147,"Department"),a(),y(148,"input",29),r(149,"mat-icon",30),p(150,"arrow_drop_down"),a(),r(151,"mat-autocomplete",31,11),g("optionSelected",function(m){return f(n),_(t.onDepartmentSelected(m))}),S(153,Xi,2,2,"mat-option",32,A),a()()(),r(155,"div",25)(156,"mat-form-field",26)(157,"mat-label"),p(158,"Group By"),a(),y(159,"input",29),r(160,"mat-icon",30),p(161,"arrow_drop_down"),a(),r(162,"mat-autocomplete",31,12),g("optionSelected",function(m){return f(n),_(t.onGroupBySelected(m))}),S(164,Ji,2,2,"mat-option",32,A),O(166,"async"),a()()()(),r(167,"div",33)(168,"button",34),g("click",function(){return f(n),_(t.clearFilters())}),r(169,"mat-icon"),p(170,"clear"),a(),p(171," Clear Filters "),a()()()(),R(172,Zi,4,0,"div",35)(173,to,3,0,"div",36)(174,fo,19,12,"mat-card",37)(175,_o,7,0,"div",38),a()}if(i&2){let n=v(21),l=v(52),m=v(60),C=v(68),J=v(76),wi=v(85),Si=v(97),Mi=v(108),Oi=v(119),xi=v(130),Ai=v(141),Ri=v(152),ki=v(163);s(8),b((t.report==null?null:t.report.name)||"Report"),s(2),b(t.report==null?null:t.report.description),s(2),d("disabled",t.loading),s(4),d("matMenuTriggerFor",n)("disabled",!t.reportResult||t.exporting),s(3),w(" ",t.exporting?"Exporting...":"Export"," "),s(30),d("matDatepicker",l),L("ngModel",t.parameters.startDate),s(),d("for",l),s(7),d("matDatepicker",m),L("ngModel",t.parameters.endDate),s(),d("for",m),s(7),d("matDatepicker",C),L("ngModel",t.parameters.approvedStartDate),s(),d("for",C),s(7),d("matDatepicker",J),L("ngModel",t.parameters.approvedEndDate),s(),d("for",J),s(7),d("formControl",t.statusControl)("matAutocomplete",wi),s(3),d("displayWith",t.displayStatus),s(2),M($(88,46,t.filteredStatuses)),s(7),d("formControl",t.workflowControl)("matAutocomplete",Si),s(3),d("displayWith",t.displayLookup),s(2),M(t.getFilteredWorkflows()),s(6),d("formControl",t.userControl)("matAutocomplete",Mi),s(3),d("displayWith",t.displayLookup),s(2),M(t.getFilteredUsers()),s(6),d("formControl",t.corporateControl)("matAutocomplete",Oi),s(3),d("displayWith",t.displayLookup),s(2),M(t.getFilteredCorporates()),s(6),d("formControl",t.sbuControl)("matAutocomplete",xi),s(3),d("displayWith",t.displayLookup),s(2),M(t.getFilteredSbuOptions()),s(6),d("formControl",t.branchControl)("matAutocomplete",Ai),s(3),d("displayWith",t.displayLookup),s(2),M(t.getFilteredBranchOptions()),s(6),d("formControl",t.departmentControl)("matAutocomplete",Ri),s(3),d("displayWith",t.displayLookup),s(2),M(t.getFilteredDepartments()),s(6),d("formControl",t.groupByControl)("matAutocomplete",ki),s(3),d("displayWith",t.displayLookup),s(2),M($(166,48,t.filteredGroupByOptions)),s(8),P(t.loading?172:-1),s(),P(t.reportResult!=null&&t.reportResult.summary&&!t.loading?173:-1),s(),P(t.reportResult&&!t.loading?174:-1),s(),P(!t.reportResult&&!t.loading?175:-1)}},dependencies:[Ne,Be,$e,ze,We,Ke,Ge,dt,st,pt,mt,ut,ct,St,vt,Ct,wt,bt,yt,gt,_t,ft,ht,Rt,At,Mt,Ot,Et,kt,ai,Q,fi,di,ui,hi,rt,ni,Yt,Qt,ei,Xt,qt,ti,Jt,Zt,ii,oi,si,li,ci,pi,mi,Dt,Pt,Gt,zt,Wt,Bt,$t,Ut,ri,Nt,Ci,vi,fe],styles:[".report-viewer[_ngcontent-%COMP%]{padding:1rem}.header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:1.5rem}.header-left[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:.5rem}.report-title[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0}.report-title[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{margin:.25rem 0 0;color:#666;font-size:.9rem}.header-actions[_ngcontent-%COMP%]{display:flex;gap:.5rem}.parameters-card[_ngcontent-%COMP%]{margin-bottom:1.5rem}.parameters-card[_ngcontent-%COMP%]   mat-card-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;font-size:1rem}.parameters-form[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(180px,1fr));gap:1rem;padding-top:.5rem}.filter-field[_ngcontent-%COMP%]{width:100%}.filter-field[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:100%}.parameters-form[_ngcontent-%COMP%]     .mat-mdc-form-field{width:100%}.parameters-form[_ngcontent-%COMP%]     .mat-mdc-text-field-wrapper{height:56px}.parameters-form[_ngcontent-%COMP%]     .mat-mdc-form-field-infix{min-height:56px;display:flex;align-items:center}@media (max-width: 768px){.parameters-form[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fill,minmax(150px,1fr))}}@media (max-width: 600px){.parameters-form[_ngcontent-%COMP%]{grid-template-columns:1fr 1fr}}@media (max-width: 400px){.parameters-form[_ngcontent-%COMP%]{grid-template-columns:1fr}}  .parameters-form .mat-mdc-form-field{font-size:var(--report-font-size, 14px)}  .parameters-form .mat-mdc-select-value,   .parameters-form .mat-mdc-input-element,   .parameters-form .mdc-floating-label,   .parameters-form .mat-mdc-floating-label,   .parameters-form .mat-mdc-select-placeholder,   .parameters-form .mat-mdc-form-field-hint,   .parameters-form .mat-mdc-form-field-error{font-size:var(--report-font-size, 14px)!important}  .parameters-form .mat-mdc-option{font-size:var(--report-font-size, 14px)!important;min-height:calc(var(--report-font-size, 14px) * 3)!important}  .parameters-form .mat-datepicker-toggle button{font-size:var(--report-font-size, 14px)}[_nghost-%COMP%]     .cdk-overlay-pane .mat-mdc-option{font-size:var(--report-font-size, 14px)!important}.filter-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;margin-top:1rem;padding-top:1rem;border-top:1px solid #eee}.loading-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;padding:4rem 2rem;color:#666}.loading-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-top:1rem}.summary-cards[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:1rem;margin-bottom:1.5rem}.summary-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;padding:1rem!important}.summary-icon[_ngcontent-%COMP%]{width:48px;height:48px;border-radius:12px;display:flex;align-items:center;justify-content:center}.summary-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:24px}.summary-info[_ngcontent-%COMP%]{display:flex;flex-direction:column}.summary-value[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:600;color:#333}.summary-label[_ngcontent-%COMP%]{font-size:.8rem;color:#666}.results-card[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.results-card[_ngcontent-%COMP%]   mat-card-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;font-size:1rem}.result-count[_ngcontent-%COMP%]{font-weight:400;color:#666;font-size:.9rem}.generated-at[_ngcontent-%COMP%]{font-size:.8rem;color:#666}.table-container[_ngcontent-%COMP%]{overflow-x:auto}table[_ngcontent-%COMP%]{width:100%}.status-badge[_ngcontent-%COMP%]{padding:4px 8px;border-radius:4px;font-size:.75rem;font-weight:500}.status-badge.pending[_ngcontent-%COMP%]{background:#fff3e0;color:#e65100}.status-badge.approved[_ngcontent-%COMP%]{background:#e8f5e9;color:#2e7d32}.status-badge.rejected[_ngcontent-%COMP%]{background:#ffebee;color:#c62828}.status-badge.draft[_ngcontent-%COMP%]{background:#f5f5f5;color:#666}.status-badge.escalated[_ngcontent-%COMP%]{background:#e3f2fd;color:#1565c0}.status-badge.cancelled[_ngcontent-%COMP%]{background:#fafafa;color:#9e9e9e}.empty-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:4rem 2rem;background:#fff;border-radius:8px;text-align:center}.empty-state[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:64px;width:64px;height:64px;color:#1976d2;opacity:.5}.empty-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:1rem 0 .5rem;color:#333}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#666}"]})}return o})();export{kn as ReportViewerComponent};
