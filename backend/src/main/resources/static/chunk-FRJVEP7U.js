import{a as $e}from"./chunk-KCZEURGJ.js";import{a as y,b as Ne,c as w,d as He,e as Ve}from"./chunk-SR2TIT5O.js";import"./chunk-G556JK2P.js";import"./chunk-MS4AQ6UA.js";import{a as Be,b as ze}from"./chunk-ZCDPLTK7.js";import{d as U}from"./chunk-C2RIDQE5.js";import{a as pe,b as fe,c as _e,d as Ce}from"./chunk-GTA6LP7E.js";import{c as Me,h as ge}from"./chunk-K3UXCVE5.js";import{a as Se,b as be}from"./chunk-L6PTED5A.js";import"./chunk-NDFZT543.js";import{a as Ae}from"./chunk-VWSHZ65D.js";import{a as xe,b as ve,c as Ee,d as ke,e as Te,f as Pe,g as De,h as Oe,i as Ie,j as Fe,k as Le,l as Re}from"./chunk-XSCQ4HOZ.js";import{a as we}from"./chunk-3AZ62B2F.js";import"./chunk-2HMVGF7U.js";import{b as he,c as ye}from"./chunk-LNAKRYVP.js";import"./chunk-3WEQTSJY.js";import{b as me,e as le,i as se,j as de,l as ce,m as ue}from"./chunk-W7HGFPQV.js";import{d as Y,h as J,l as K,u as X}from"./chunk-MFE2U5AV.js";import{a as oe,c as ae,h as re}from"./chunk-XRACF4N4.js";import"./chunk-KNH3VKXQ.js";import"./chunk-OWVO723I.js";import{c as Q,d as q,g as G}from"./chunk-GMPFJIFP.js";import{l as j,p as W,ta as Z,ua as ee,va as te,wa as ie,ya as ne}from"./chunk-ZJGSEVKG.js";import{$b as k,Cb as u,Fb as B,Hb as S,Jb as z,Kb as N,Lb as H,Mb as i,Nb as n,Ob as b,Pb as p,Qb as f,Sb as E,Wb as M,Xb as C,ac as T,bc as P,cb as m,ec as V,fc as o,gc as h,hb as g,hc as _,jc as D,kc as O,lc as I,oa as x,ob as A,oc as $,pa as v,qc as F,rc as L,tc as R,ub as d}from"./chunk-BMOUMNDR.js";var We=()=>[10,25,50,100],je=(e,a)=>["/workflows",e,"instances",a];function Qe(e,a){if(e&1&&(i(0,"mat-option",11),o(1),n()),e&2){let t=a.$implicit;u("value",t),m(),h(t)}}function qe(e,a){e&1&&(i(0,"th",28),o(1,"Reference"),n())}function Ge(e,a){if(e&1&&(i(0,"td",29)(1,"a",30),o(2),n()()),e&2){let t=a.$implicit;m(),u("routerLink",F(2,je,t.workflowCode,t.id)),m(),_(" ",t.referenceNumber," ")}}function Ue(e,a){e&1&&(i(0,"th",28),o(1,"Title"),n())}function Ye(e,a){if(e&1&&(i(0,"td",29),o(1),n()),e&2){let t=a.$implicit;m(),_(" ",t.title||"-"," ")}}function Je(e,a){e&1&&(i(0,"th",28),o(1,"Workflow"),n())}function Ke(e,a){if(e&1&&(i(0,"td",29)(1,"div",31)(2,"mat-icon"),o(3),n(),i(4,"span"),o(5),n()()()),e&2){let t=a.$implicit;m(3),h(t.workflowIcon||"description"),m(2),h(t.workflowName)}}function Xe(e,a){e&1&&(i(0,"th",28),o(1,"Status"),n())}function Ze(e,a){if(e&1&&(i(0,"td",29)(1,"span",32),o(2),n()()),e&2){let t=a.$implicit;m(),B(t.status.toLowerCase()),m(),_(" ",t.status," ")}}function et(e,a){e&1&&(i(0,"th",28),o(1,"Current Level"),n())}function tt(e,a){if(e&1&&o(0),e&2){let t=C().$implicit;_(" Level ",t.currentApprovalLevel," ")}}function it(e,a){e&1&&o(0," - ")}function nt(e,a){if(e&1&&(i(0,"td",29),d(1,tt,1,1)(2,it,1,0),n()),e&2){let t=a.$implicit;m(),S(t.status==="PENDING"?1:2)}}function ot(e,a){e&1&&(i(0,"th",28),o(1,"Submitted"),n())}function at(e,a){if(e&1&&(i(0,"td",29),o(1),L(2,"date"),n()),e&2){let t=a.$implicit;m(),_(" ",R(2,1,t.createdAt,"medium")," ")}}function rt(e,a){e&1&&(i(0,"th",28),o(1,"Last Updated"),n())}function mt(e,a){if(e&1&&(i(0,"td",29),o(1),L(2,"date"),n()),e&2){let t=a.$implicit;m(),_(" ",R(2,1,t.updatedAt,"medium")," ")}}function lt(e,a){e&1&&b(0,"th",33)}function st(e,a){if(e&1){let t=E();i(0,"button",37),M("click",function(){x(t);let r=C().$implicit,l=C();return v(l.editSubmission(r))}),i(1,"mat-icon"),o(2,"edit"),n(),i(3,"span"),o(4,"Edit Submission"),n()()}}function dt(e,a){if(e&1){let t=E();i(0,"button",37),M("click",function(){x(t);let r=C().$implicit,l=C();return v(l.deleteSubmission(r))}),i(1,"mat-icon"),o(2,"delete"),n(),i(3,"span"),o(4,"Delete Submission"),n()()}}function ct(e,a){if(e&1&&(i(0,"td",29)(1,"button",34)(2,"mat-icon"),o(3,"more_vert"),n()(),i(4,"mat-menu",null,0)(6,"button",35)(7,"mat-icon"),o(8,"visibility"),n(),i(9,"span"),o(10,"View Details"),n()(),d(11,st,5,0,"button",36)(12,dt,5,0,"button",36),n()()),e&2){let t=a.$implicit,s=V(5),r=C();m(),u("matMenuTriggerFor",s),m(5),u("routerLink",F(4,je,t.workflowCode,t.id)),m(5),S(r.canEdit(t)?11:-1),m(),S(r.canDelete(t)?12:-1)}}function ut(e,a){e&1&&b(0,"tr",38)}function pt(e,a){e&1&&b(0,"tr",39)}function ft(e,a){e&1&&(i(0,"div",26)(1,"mat-icon"),o(2,"send"),n(),i(3,"h3"),o(4,"No Submissions Yet"),n(),i(5,"p"),o(6,"Start by submitting a new workflow request."),n(),i(7,"button",40),o(8," Go to Home "),n()())}var Kt=(()=>{class e{workflowService;dialog;snackBar;router;displayedColumns=["referenceNumber","title","workflowName","status","currentApprovalLevel","createdAt","updatedAt","actions"];dataSource=new Re([]);searchTerm="";statusFilter="";totalElements=0;pageSize=10;currentPage=0;statuses=Object.values(Ae);paginator;sort;constructor(t,s,r,l){this.workflowService=t,this.dialog=s,this.snackBar=r,this.router=l}ngOnInit(){this.loadSubmissions()}ngAfterViewInit(){this.dataSource.sort=this.sort}loadSubmissions(){this.workflowService.getMySubmissions(this.currentPage,this.pageSize,this.statusFilter||void 0).subscribe(t=>{t.success&&(this.dataSource.data=t.data.content,this.totalElements=t.data.totalElements)})}applyFilter(){this.dataSource.filter=this.searchTerm.trim().toLowerCase()}onPageChange(t){this.currentPage=t.pageIndex,this.pageSize=t.pageSize,this.loadSubmissions()}canEdit(t){return t.status==="DRAFT"||t.status==="RECALLED"}canDelete(t){return t.status==="DRAFT"||t.status==="RECALLED"}editSubmission(t){this.router.navigate(["/workflows",t.workflowCode,"submit"],{queryParams:{edit:t.id}})}deleteSubmission(t){this.dialog.open($e,{width:"400px",data:{title:"Delete Submission",message:`Are you sure you want to delete submission "${t.referenceNumber}"? This action cannot be undone.`,confirmText:"Delete",cancelText:"Cancel",confirmColor:"warn"}}).afterClosed().subscribe(r=>{r&&this.workflowService.deleteInstance(t.id).subscribe({next:l=>{l.success&&(this.snackBar.open("Submission deleted successfully","Close",{duration:3e3}),this.loadSubmissions())},error:()=>{this.snackBar.open("Failed to delete submission","Close",{duration:3e3})}})})}static \u0275fac=function(s){return new(s||e)(g(we),g(Me),g(he),g(Q))};static \u0275cmp=A({type:e,selectors:[["app-my-submissions"]],viewQuery:function(s,r){if(s&1&&(k(y,5),k(w,5)),s&2){let l;T(l=P())&&(r.paginator=l.first),T(l=P())&&(r.sort=l.first)}},decls:53,vars:11,consts:[["menu","matMenu"],[1,"my-submissions-container"],[1,"header"],[1,"header-stats"],[1,"table-toolbar"],["appearance","outline",1,"search-field"],["matInput","","placeholder","Search by reference number",3,"ngModelChange","keyup","ngModel"],["matPrefix",""],["appearance","outline"],[3,"ngModelChange","selectionChange","ngModel"],["value",""],[3,"value"],["mat-table","","matSort","",1,"data-table",3,"dataSource"],["matColumnDef","referenceNumber"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","title"],["matColumnDef","workflowName"],["matColumnDef","status"],["matColumnDef","currentApprovalLevel"],["matColumnDef","createdAt"],["matColumnDef","updatedAt"],["matColumnDef","actions"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[1,"empty-state"],["showFirstLastButtons","",3,"page","length","pageSize","pageSizeOptions"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],[1,"reference-link",3,"routerLink"],[1,"workflow-info"],[1,"badge"],["mat-header-cell",""],["mat-icon-button","",3,"matMenuTriggerFor"],["mat-menu-item","",3,"routerLink"],["mat-menu-item",""],["mat-menu-item","",3,"click"],["mat-header-row",""],["mat-row",""],["mat-raised-button","","color","primary","routerLink","/dashboard"]],template:function(s,r){s&1&&(i(0,"div",1)(1,"div",2)(2,"h1"),o(3,"My Submissions"),n(),i(4,"div",3)(5,"mat-chip"),o(6),n()()(),i(7,"mat-card")(8,"mat-card-content")(9,"div",4)(10,"mat-form-field",5)(11,"mat-label"),o(12,"Search"),n(),i(13,"input",6),I("ngModelChange",function(c){return O(r.searchTerm,c)||(r.searchTerm=c),c}),M("keyup",function(){return r.applyFilter()}),n(),i(14,"mat-icon",7),o(15,"search"),n()(),i(16,"mat-form-field",8)(17,"mat-label"),o(18,"Status"),n(),i(19,"mat-select",9),I("ngModelChange",function(c){return O(r.statusFilter,c)||(r.statusFilter=c),c}),M("selectionChange",function(){return r.loadSubmissions()}),i(20,"mat-option",10),o(21,"All"),n(),N(22,Qe,2,2,"mat-option",11,z),n()()(),i(24,"table",12),p(25,13),d(26,qe,2,0,"th",14)(27,Ge,3,5,"td",15),f(),p(28,16),d(29,Ue,2,0,"th",14)(30,Ye,2,1,"td",15),f(),p(31,17),d(32,Je,2,0,"th",14)(33,Ke,6,2,"td",15),f(),p(34,18),d(35,Xe,2,0,"th",14)(36,Ze,3,3,"td",15),f(),p(37,19),d(38,et,2,0,"th",14)(39,nt,3,1,"td",15),f(),p(40,20),d(41,ot,2,0,"th",14)(42,at,3,4,"td",15),f(),p(43,21),d(44,rt,2,0,"th",14)(45,mt,3,4,"td",15),f(),p(46,22),d(47,lt,1,0,"th",23)(48,ct,13,7,"td",15),f(),d(49,ut,1,0,"tr",24)(50,pt,1,0,"tr",25),n(),d(51,ft,9,0,"div",26),i(52,"mat-paginator",27),M("page",function(c){return r.onPageChange(c)}),n()()()()),s&2&&(m(6),_("",r.totalElements," total"),m(7),D("ngModel",r.searchTerm),m(6),D("ngModel",r.statusFilter),m(3),H(r.statuses),m(2),u("dataSource",r.dataSource),m(25),u("matHeaderRowDef",r.displayedColumns),m(),u("matRowDefColumns",r.displayedColumns),m(),S(r.dataSource.data.length===0?51:-1),m(),u("length",r.totalElements)("pageSize",r.pageSize)("pageSizeOptions",$(10,We)))},dependencies:[W,j,G,q,X,Y,J,K,re,oe,ae,Le,xe,Ee,De,ke,ve,Oe,Te,Pe,Ie,Fe,Ne,y,Ve,w,He,de,se,me,le,ue,ce,ze,Be,U,ne,ie,te,ee,Z,be,Se,Ce,fe,pe,_e,ge,ye],styles:[".my-submissions-container[_ngcontent-%COMP%]{padding:1rem}.header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem}.table-toolbar[_ngcontent-%COMP%]{display:flex;gap:1rem;margin-bottom:1rem}.search-field[_ngcontent-%COMP%]{flex:1;max-width:400px}.data-table[_ngcontent-%COMP%]{width:100%}.reference-link[_ngcontent-%COMP%]{color:#1976d2;text-decoration:none;font-weight:500}.reference-link[_ngcontent-%COMP%]:hover{text-decoration:underline}.workflow-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.workflow-info[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#1976d2;font-size:20px;width:20px;height:20px}.badge[_ngcontent-%COMP%]{padding:.25rem .5rem;border-radius:4px;font-size:.75rem;font-weight:500}.badge.pending[_ngcontent-%COMP%]{background:#fff3e0;color:#e65100}.badge.approved[_ngcontent-%COMP%]{background:#e8f5e9;color:#2e7d32}.badge.rejected[_ngcontent-%COMP%]{background:#ffebee;color:#c62828}.badge.draft[_ngcontent-%COMP%]{background:#f5f5f5;color:#666}.badge.escalated[_ngcontent-%COMP%]{background:#e3f2fd;color:#1565c0}.badge.recalled[_ngcontent-%COMP%]{background:#fce4ec;color:#c2185b}.badge.cancelled[_ngcontent-%COMP%]{background:#f5f5f5;color:#666}.badge.on_hold[_ngcontent-%COMP%]{background:#fff8e1;color:#f57f17}.empty-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:4rem 2rem;color:#666;text-align:center}.empty-state[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:64px;width:64px;height:64px;opacity:.5}.empty-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:1rem 0 .5rem}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 1.5rem}"]})}return e})();export{Kt as MySubmissionsComponent};
