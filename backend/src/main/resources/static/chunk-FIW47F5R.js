import{a as Ie,b as Re}from"./chunk-3ACZ4RNP.js";import{c as v,d as Ee,e as b,f as Le,g as Te}from"./chunk-JR55QIKH.js";import{a as De,b as Pe}from"./chunk-OJT3OVWQ.js";import"./chunk-M4AVZ6G2.js";import"./chunk-WPDQKNTD.js";import"./chunk-5LBLILVL.js";import"./chunk-CZLTQM4N.js";import{a as le,b as me}from"./chunk-2CETHFK6.js";import{a as ce,b as se,c as de,d as pe}from"./chunk-6Y7BGRIJ.js";import"./chunk-LAGNR76Q.js";import{a as ue,b as we,c as _e,d as ke,e as he,f as Ce,g as Me,h as ge,i as Se,j as xe,k as ve,l as be}from"./chunk-FEDFXP2D.js";import{a as fe}from"./chunk-W77BPQM7.js";import"./chunk-T6FL6ZBG.js";import{a as We,b as ye}from"./chunk-AIS23OW2.js";import{a as ne,c as re,d as ae}from"./chunk-XZVKBWV7.js";import{b as te,e as ie,i as oe}from"./chunk-IGML5J3D.js";import"./chunk-DLMMVLF7.js";import"./chunk-X4PFBHKL.js";import"./chunk-ORAJKTE5.js";import{b as Q,f as N,i as U,p as z}from"./chunk-DUSDXFBS.js";import{a as Y,c as Z,h as ee}from"./chunk-PWNKGTLH.js";import"./chunk-PSOPTTCW.js";import"./chunk-NMO4AZKI.js";import{d as H,g as j}from"./chunk-JQUVUDJB.js";import{l as $,m as A,qa as q,ra as G,sa as J,ta as K,va as X}from"./chunk-A3I6STGM.js";import{$b as L,Ab as s,Kb as i,Lb as o,Mb as w,Nb as p,Ob as f,Qb as g,Ub as _,Vb as C,Zb as y,_b as E,bb as c,cc as D,dc as n,ec as M,fc as S,gb as W,gc as P,hc as I,ic as R,jc as V,mc as B,na as k,nb as T,nc as x,oa as h,pc as F,sc as O,tb as d}from"./chunk-2HR56SRD.js";var Ve=()=>[10,25,50],Be=e=>["/workflows/builder",e],Fe=e=>["/workflows",e,"instances"],Oe=e=>["/workflows",e,"new"];function $e(e,l){e&1&&w(0,"th",23)}function Ae(e,l){if(e&1&&(i(0,"td",24)(1,"mat-icon",25),n(2),o()()),e&2){let t=l.$implicit;c(2),M(t.icon||"description")}}function He(e,l){e&1&&(i(0,"th",26),n(1,"Name"),o())}function je(e,l){if(e&1&&(i(0,"td",24)(1,"div",27)(2,"strong"),n(3),o(),i(4,"span",28),n(5),o()()()),e&2){let t=l.$implicit;c(3),M(t.name),c(2),M(t.code)}}function Qe(e,l){e&1&&(i(0,"th",23),n(1,"Description"),o())}function Ne(e,l){if(e&1&&(i(0,"td",24),n(1),F(2,"slice"),o()),e&2){let t=l.$implicit;c(),P(" ",O(2,2,t.description,0,100),"",(t.description==null?null:t.description.length)>100?"...":""," ")}}function Ue(e,l){e&1&&(i(0,"th",26),n(1,"Type"),o())}function ze(e,l){if(e&1&&(i(0,"td",24)(1,"mat-chip"),n(2),o()()),e&2){let t=l.$implicit;c(2),M(t.workflowTypeName||"General")}}function qe(e,l){e&1&&(i(0,"th",23),n(1,"Approvers"),o())}function Ge(e,l){if(e&1&&(i(0,"td",24),n(1),o()),e&2){let t=l.$implicit;c(),S(" ",(t.approvers==null?null:t.approvers.length)||0," levels ")}}function Je(e,l){e&1&&(i(0,"th",26),n(1,"Published"),o())}function Ke(e,l){if(e&1){let t=g();i(0,"td",24)(1,"mat-slide-toggle",29),_("change",function(a){let m=k(t).$implicit,u=C();return h(u.togglePublished(m,a.checked))}),n(2),o()()}if(e&2){let t=l.$implicit;c(),s("checked",t.isPublished),c(),S(" ",t.isPublished?"Published":"Draft"," ")}}function Xe(e,l){e&1&&(i(0,"th",26),n(1,"Status"),o())}function Ye(e,l){if(e&1){let t=g();i(0,"td",24)(1,"mat-slide-toggle",30),_("change",function(a){let m=k(t).$implicit,u=C();return h(u.toggleActive(m,a.checked))}),n(2),o()()}if(e&2){let t=l.$implicit;c(),s("checked",t.isActive),c(),S(" ",t.isActive?"Active":"Inactive"," ")}}function Ze(e,l){e&1&&w(0,"th",23)}function et(e,l){if(e&1){let t=g();i(0,"td",24)(1,"button",31)(2,"mat-icon"),n(3,"more_vert"),o()(),i(4,"mat-menu",null,0)(6,"button",32)(7,"mat-icon"),n(8,"build"),o(),i(9,"span"),n(10,"Edit Builder"),o()(),i(11,"button",32)(12,"mat-icon"),n(13,"list"),o(),i(14,"span"),n(15,"View Instances"),o()(),i(16,"button",32)(17,"mat-icon"),n(18,"add"),o(),i(19,"span"),n(20,"New Submission"),o()(),w(21,"mat-divider"),i(22,"button",33),_("click",function(){let a=k(t).$implicit,m=C();return h(m.duplicateWorkflow(a))}),i(23,"mat-icon"),n(24,"content_copy"),o(),i(25,"span"),n(26,"Duplicate"),o()(),i(27,"button",33),_("click",function(){let a=k(t).$implicit,m=C();return h(m.exportWorkflow(a))}),i(28,"mat-icon"),n(29,"download"),o(),i(30,"span"),n(31,"Export"),o()(),i(32,"button",34),_("click",function(){let a=k(t).$implicit,m=C();return h(m.deleteWorkflow(a))}),i(33,"mat-icon"),n(34,"delete"),o(),i(35,"span"),n(36,"Delete"),o()()()()}if(e&2){let t=l.$implicit,r=D(5);c(),s("matMenuTriggerFor",r),c(5),s("routerLink",x(4,Be,t.id)),c(5),s("routerLink",x(6,Fe,t.code)),c(5),s("routerLink",x(8,Oe,t.code))}}function tt(e,l){e&1&&w(0,"tr",35)}function it(e,l){e&1&&w(0,"tr",36)}var Ft=(()=>{class e{workflowService;snackBar;displayedColumns=["icon","name","description","type","approvers","published","active","actions"];dataSource=new be([]);searchTerm="";paginator;sort;constructor(t,r){this.workflowService=t,this.snackBar=r}ngOnInit(){this.loadWorkflows()}ngAfterViewInit(){this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort}loadWorkflows(){this.workflowService.getWorkflows().subscribe(t=>{t.success&&(this.dataSource.data=t.data)})}applyFilter(){this.dataSource.filter=this.searchTerm.trim().toLowerCase()}toggleActive(t,r){this.workflowService.toggleWorkflowActive(t.id,r).subscribe(a=>{a.success&&(t.isActive=r,this.snackBar.open(`Workflow ${r?"activated":"deactivated"} successfully`,"Close",{duration:3e3}))})}togglePublished(t,r){(r?this.workflowService.publishWorkflow(t.id):this.workflowService.unpublishWorkflow(t.id)).subscribe(m=>{m.success&&(t.isPublished=r,this.snackBar.open(`Workflow ${r?"published":"unpublished"} successfully`,"Close",{duration:3e3}))})}duplicateWorkflow(t){this.workflowService.duplicateWorkflow(t.id).subscribe(r=>{r.success&&(this.snackBar.open("Workflow duplicated successfully","Close",{duration:3e3}),this.loadWorkflows())})}exportWorkflow(t){this.workflowService.exportWorkflow(t.id).subscribe(r=>{let a=window.URL.createObjectURL(r),m=document.createElement("a");m.href=a,m.download=`${t.code}_workflow.json`,m.click(),window.URL.revokeObjectURL(a)})}deleteWorkflow(t){confirm(`Are you sure you want to delete the workflow "${t.name}"?`)&&this.workflowService.deleteWorkflow(t.id).subscribe(r=>{r.success&&(this.snackBar.open("Workflow deleted successfully","Close",{duration:3e3}),this.loadWorkflows())})}static \u0275fac=function(r){return new(r||e)(W(fe),W(We))};static \u0275cmp=T({type:e,selectors:[["app-workflow-list"]],viewQuery:function(r,a){if(r&1&&(y(v,5),y(b,5)),r&2){let m;E(m=L())&&(a.paginator=m.first),E(m=L())&&(a.sort=m.first)}},decls:45,vars:6,consts:[["menu","matMenu"],[1,"workflow-list-container"],[1,"header"],["mat-raised-button","","color","primary","routerLink","/workflows/builder/new"],[1,"table-toolbar"],["appearance","outline",1,"search-field"],["matInput","","placeholder","Search by name or code",3,"ngModelChange","keyup","ngModel"],["matPrefix",""],["mat-table","","matSort","",1,"data-table",3,"dataSource"],["matColumnDef","icon"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","name"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["matColumnDef","description"],["matColumnDef","type"],["matColumnDef","approvers"],["matColumnDef","published"],["matColumnDef","active"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","",3,"pageSizeOptions"],["mat-header-cell",""],["mat-cell",""],[1,"workflow-icon"],["mat-header-cell","","mat-sort-header",""],[1,"workflow-info"],[1,"code"],["color","primary",3,"change","checked"],[3,"change","checked"],["mat-icon-button","",3,"matMenuTriggerFor"],["mat-menu-item","",3,"routerLink"],["mat-menu-item","",3,"click"],["mat-menu-item","",1,"delete-action",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(r,a){r&1&&(i(0,"div",1)(1,"div",2)(2,"h1"),n(3,"Workflow Management"),o(),i(4,"button",3)(5,"mat-icon"),n(6,"add"),o(),n(7," Create Workflow "),o()(),i(8,"mat-card")(9,"mat-card-content")(10,"div",4)(11,"mat-form-field",5)(12,"mat-label"),n(13,"Search workflows"),o(),i(14,"input",6),V("ngModelChange",function(u){return R(a.searchTerm,u)||(a.searchTerm=u),u}),_("keyup",function(){return a.applyFilter()}),o(),i(15,"mat-icon",7),n(16,"search"),o()()(),i(17,"table",8),p(18,9),d(19,$e,1,0,"th",10)(20,Ae,3,1,"td",11),f(),p(21,12),d(22,He,2,0,"th",13)(23,je,6,2,"td",11),f(),p(24,14),d(25,Qe,2,0,"th",10)(26,Ne,3,6,"td",11),f(),p(27,15),d(28,Ue,2,0,"th",13)(29,ze,3,1,"td",11),f(),p(30,16),d(31,qe,2,0,"th",10)(32,Ge,2,1,"td",11),f(),p(33,17),d(34,Je,2,0,"th",13)(35,Ke,3,2,"td",11),f(),p(36,18),d(37,Xe,2,0,"th",13)(38,Ye,3,2,"td",11),f(),p(39,19),d(40,Ze,1,0,"th",10)(41,et,37,10,"td",11),f(),d(42,tt,1,0,"tr",20)(43,it,1,0,"tr",21),o(),w(44,"mat-paginator",22),o()()()),r&2&&(c(14),I("ngModel",a.searchTerm),c(3),s("dataSource",a.dataSource),c(25),s("matHeaderRowDef",a.displayedColumns),c(),s("matRowDefColumns",a.displayedColumns),c(),s("pageSizeOptions",B(5,Ve)))},dependencies:[A,$,j,H,z,Q,N,U,ee,Y,Z,ve,ue,_e,Me,ke,we,ge,he,Ce,Se,xe,Ee,v,Te,b,Le,ne,oe,te,ie,ae,re,X,K,J,G,q,pe,se,ce,de,Pe,De,Re,Ie,ye,me,le],styles:[".workflow-list-container[_ngcontent-%COMP%]{padding:1rem}.header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem}.table-toolbar[_ngcontent-%COMP%]{margin-bottom:1rem}.search-field[_ngcontent-%COMP%]{width:400px}.data-table[_ngcontent-%COMP%]{width:100%}.workflow-icon[_ngcontent-%COMP%]{color:#1976d2}.workflow-info[_ngcontent-%COMP%]{display:flex;flex-direction:column}.workflow-info[_ngcontent-%COMP%]   .code[_ngcontent-%COMP%]{font-size:.75rem;color:#666}.delete-action[_ngcontent-%COMP%]{color:#c62828}"]})}return e})();export{Ft as WorkflowListComponent};
