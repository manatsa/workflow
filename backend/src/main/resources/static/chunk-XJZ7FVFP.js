import{a as St}from"./chunk-3U3ZRNJ5.js";import{a as yt}from"./chunk-KHA6H2VC.js";import"./chunk-MS4AQ6UA.js";import{a as ft,b as gt}from"./chunk-5B5KDLSZ.js";import{d as $e}from"./chunk-WNUHNPS4.js";import{a as vt,c as Ct}from"./chunk-IVI3BL2S.js";import{b as xt,c as bt}from"./chunk-C5XODKZL.js";import"./chunk-LU6VCXUA.js";import"./chunk-AGZT6V36.js";import{b as dt,c as lt,i as ct,j as ut,l as pt,m as ht}from"./chunk-2AGPTHDJ.js";import{d as ze,f as De,i as He,j as je,n as Qe,q as qe,r as We,v as Ge,w as Xe,x as Ye}from"./chunk-QGDZCCER.js";import{a as nt,b as rt,c as st,f as ot,h as at}from"./chunk-BTSRKJZZ.js";import"./chunk-MNRHFUYD.js";import{c as Me}from"./chunk-UF7Y5AYJ.js";import{a as _t,b as mt}from"./chunk-PMYQJTBZ.js";import{$ as se,Aa as it,aa as Re,ea as Ue,ga as Ee,q as Ke,va as Ze,wa as Je,xa as et,ya as tt}from"./chunk-37H25STD.js";import{B as Be,C as Fe,Cc as ye,Da as fe,Db as ge,Dc as Se,Eb as D,F as pe,Fc as R,G as he,Gb as ie,Gc as re,J as k,Jb as v,L as Le,Mb as xe,Nb as be,Ob as o,Pb as a,Qb as Q,Tb as P,Ub as O,V as _e,Vb as ve,W as $,X as N,Yb as m,Z as z,Zb as h,a as X,ac as Ce,b as Y,ba as J,bc as ne,cc as V,da as Pe,dc as K,eb as c,ga as f,gb as Oe,gc as Ve,hc as l,i as Z,ic as S,j as T,jb as j,jc as A,lb as ee,m as Ae,o as g,oa as x,pa as b,pc as w,q as ce,qb as L,rb as te,s as C,sa as H,sb as E,t as U,ub as I,w as ue,wb as y,za as me}from"./chunk-UYCZSUYP.js";var Te=class{dataNodes;expansionModel=new Me(!0);trackBy;getLevel;isExpandable;getChildren;toggle(s){this.expansionModel.toggle(this._trackByValue(s))}expand(s){this.expansionModel.select(this._trackByValue(s))}collapse(s){this.expansionModel.deselect(this._trackByValue(s))}isExpanded(s){return this.expansionModel.isSelected(this._trackByValue(s))}toggleDescendants(s){this.expansionModel.isSelected(this._trackByValue(s))?this.collapseDescendants(s):this.expandDescendants(s)}collapseAll(){this.expansionModel.clear()}expandDescendants(s){let e=[s];e.push(...this.getDescendants(s)),this.expansionModel.select(...e.map(t=>this._trackByValue(t)))}collapseDescendants(s){let e=[s];e.push(...this.getDescendants(s)),this.expansionModel.deselect(...e.map(t=>this._trackByValue(t)))}_trackByValue(s){return this.trackBy?this.trackBy(s):s}};var oe=class extends Te{getChildren;options;constructor(s,e){super(),this.getChildren=s,this.options=e,this.options&&(this.trackBy=this.options.trackBy),this.options?.isExpandable&&(this.isExpandable=this.options.isExpandable)}expandAll(){this.expansionModel.clear();let s=this.dataNodes.reduce((e,t)=>[...e,...this.getDescendants(t),t],[]);this.expansionModel.select(...s.map(e=>this._trackByValue(e)))}getDescendants(s){let e=[];return this._getDescendants(e,s),e.splice(1)}_getDescendants(s,e){s.push(e);let t=this.getChildren(e);Array.isArray(t)?t.forEach(i=>this._getDescendants(s,i)):ce(t)&&t.pipe(k(1),Fe(Boolean)).subscribe(i=>{for(let r of i)this._getDescendants(s,r)})}},W=new Pe("CDK_TREE_NODE_OUTLET_NODE"),q=(()=>{class n{viewContainer=f(ee);_node=f(W,{optional:!0});constructor(){}static \u0275fac=function(t){return new(t||n)};static \u0275dir=E({type:n,selectors:[["","cdkTreeNodeOutlet",""]]})}return n})(),ke=class{$implicit;level;index;count;constructor(s){this.$implicit=s}},ae=(()=>{class n{template=f(Oe);when;constructor(){}static \u0275fac=function(t){return new(t||n)};static \u0275dir=E({type:n,selectors:[["","cdkTreeNodeDef",""]],inputs:{when:[0,"cdkTreeNodeDefWhen","when"]}})}return n})();function Et(){return Error("Could not find a tree control, levelAccessor, or childrenAccessor for the tree.")}var G=(()=>{class n{_differs=f(Se);_changeDetectorRef=f(ye);_elementRef=f(fe);_dir=f(Ue);_onDestroy=new Z;_dataDiffer;_defaultNodeDef;_dataSubscription;_levels=new Map;_parents=new Map;_ariaSets=new Map;get dataSource(){return this._dataSource}set dataSource(e){this._dataSource!==e&&this._switchDataSource(e)}_dataSource;treeControl;levelAccessor;childrenAccessor;trackBy;expansionKey;_nodeOutlet;_nodeDefs;viewChange=new T({start:0,end:Number.MAX_VALUE});_expansionModel;_flattenedNodes=new T([]);_nodeType=new T(null);_nodes=new T(new Map);_keyManagerNodes=new T([]);_keyManagerFactory=f(Re);_keyManager;_viewInit=!1;constructor(){}ngAfterContentInit(){this._initializeKeyManager()}ngAfterContentChecked(){this._updateDefaultNodeDefinition(),this._subscribeToDataChanges()}ngOnDestroy(){this._nodeOutlet.viewContainer.clear(),this.viewChange.complete(),this._onDestroy.next(),this._onDestroy.complete(),this._dataSource&&typeof this._dataSource.disconnect=="function"&&this.dataSource.disconnect(this),this._dataSubscription&&(this._dataSubscription.unsubscribe(),this._dataSubscription=null),this._keyManager?.destroy()}ngOnInit(){this._checkTreeControlUsage(),this._initializeDataDiffer()}ngAfterViewInit(){this._viewInit=!0}_updateDefaultNodeDefinition(){let e=this._nodeDefs.filter(t=>!t.when);e.length>1,this._defaultNodeDef=e[0]}_setNodeTypeIfUnset(e){this._nodeType.value===null&&this._nodeType.next(e)}_switchDataSource(e){this._dataSource&&typeof this._dataSource.disconnect=="function"&&this.dataSource.disconnect(this),this._dataSubscription&&(this._dataSubscription.unsubscribe(),this._dataSubscription=null),e||this._nodeOutlet.viewContainer.clear(),this._dataSource=e,this._nodeDefs&&this._subscribeToDataChanges()}_getExpansionModel(){return this.treeControl?this.treeControl.expansionModel:(this._expansionModel??=new Me(!0),this._expansionModel)}_subscribeToDataChanges(){if(this._dataSubscription)return;let e;mt(this._dataSource)?e=this._dataSource.connect(this):ce(this._dataSource)?e=this._dataSource:Array.isArray(this._dataSource)&&(e=g(this._dataSource)),e&&(this._dataSubscription=this._getRenderData(e).pipe(N(this._onDestroy)).subscribe(t=>{this._renderDataChanges(t)}))}_getRenderData(e){let t=this._getExpansionModel();return U([e,this._nodeType,t.changed.pipe(_e(null),z(i=>{this._emitExpansionChanges(i)}))]).pipe($(([i,r])=>r===null?g({renderNodes:i,flattenedNodes:null,nodeType:r}):this._computeRenderingData(i,r).pipe(C(d=>Y(X({},d),{nodeType:r})))))}_renderDataChanges(e){if(e.nodeType===null){this.renderNodeChanges(e.renderNodes);return}this._updateCachedData(e.flattenedNodes),this.renderNodeChanges(e.renderNodes),this._updateKeyManagerItems(e.flattenedNodes)}_emitExpansionChanges(e){if(!e)return;let t=this._nodes.value;for(let i of e.added)t.get(i)?._emitExpansionState(!0);for(let i of e.removed)t.get(i)?._emitExpansionState(!1)}_initializeKeyManager(){let e=U([this._keyManagerNodes,this._nodes]).pipe(C(([i,r])=>i.reduce((d,u)=>{let p=r.get(this._getExpansionKey(u));return p&&d.push(p),d},[]))),t={trackBy:i=>this._getExpansionKey(i.data),skipPredicate:i=>!!i.isDisabled,typeAheadDebounceInterval:!0,horizontalOrientation:this._dir.value};this._keyManager=this._keyManagerFactory(e,t)}_initializeDataDiffer(){let e=this.trackBy??((t,i)=>this._getExpansionKey(i));this._dataDiffer=this._differs.find([]).create(e)}_checkTreeControlUsage(){}renderNodeChanges(e,t=this._dataDiffer,i=this._nodeOutlet.viewContainer,r){let d=t.diff(e);!d&&!this._viewInit||(d?.forEachOperation((u,p,_)=>{if(u.previousIndex==null)this.insertNode(e[_],_,i,r);else if(_==null)i.remove(p);else{let M=i.get(p);i.move(M,_)}}),d?.forEachIdentityChange(u=>{let p=u.item;if(u.currentIndex!=null){let _=i.get(u.currentIndex);_.context.$implicit=p}}),r?this._changeDetectorRef.markForCheck():this._changeDetectorRef.detectChanges())}_getNodeDef(e,t){if(this._nodeDefs.length===1)return this._nodeDefs.first;let i=this._nodeDefs.find(r=>r.when&&r.when(t,e))||this._defaultNodeDef;return i}insertNode(e,t,i,r){let d=this._getLevelAccessor(),u=this._getNodeDef(e,t),p=this._getExpansionKey(e),_=new ke(e);r??=this._parents.get(p)??void 0,d?_.level=d(e):r!==void 0&&this._levels.has(this._getExpansionKey(r))?_.level=this._levels.get(this._getExpansionKey(r))+1:_.level=0,this._levels.set(p,_.level),(i||this._nodeOutlet.viewContainer).createEmbeddedView(u.template,_,t),B.mostRecentTreeNode&&(B.mostRecentTreeNode.data=e)}isExpanded(e){return!!(this.treeControl?.isExpanded(e)||this._expansionModel?.isSelected(this._getExpansionKey(e)))}toggle(e){this.treeControl?this.treeControl.toggle(e):this._expansionModel&&this._expansionModel.toggle(this._getExpansionKey(e))}expand(e){this.treeControl?this.treeControl.expand(e):this._expansionModel&&this._expansionModel.select(this._getExpansionKey(e))}collapse(e){this.treeControl?this.treeControl.collapse(e):this._expansionModel&&this._expansionModel.deselect(this._getExpansionKey(e))}toggleDescendants(e){this.treeControl?this.treeControl.toggleDescendants(e):this._expansionModel&&(this.isExpanded(e)?this.collapseDescendants(e):this.expandDescendants(e))}expandDescendants(e){if(this.treeControl)this.treeControl.expandDescendants(e);else if(this._expansionModel){let t=this._expansionModel;t.select(this._getExpansionKey(e)),this._getDescendants(e).pipe(k(1),N(this._onDestroy)).subscribe(i=>{t.select(...i.map(r=>this._getExpansionKey(r)))})}}collapseDescendants(e){if(this.treeControl)this.treeControl.collapseDescendants(e);else if(this._expansionModel){let t=this._expansionModel;t.deselect(this._getExpansionKey(e)),this._getDescendants(e).pipe(k(1),N(this._onDestroy)).subscribe(i=>{t.deselect(...i.map(r=>this._getExpansionKey(r)))})}}expandAll(){this.treeControl?this.treeControl.expandAll():this._expansionModel&&this._forEachExpansionKey(e=>this._expansionModel?.select(...e))}collapseAll(){this.treeControl?this.treeControl.collapseAll():this._expansionModel&&this._forEachExpansionKey(e=>this._expansionModel?.deselect(...e))}_getLevelAccessor(){return this.treeControl?.getLevel?.bind(this.treeControl)??this.levelAccessor}_getChildrenAccessor(){return this.treeControl?.getChildren?.bind(this.treeControl)??this.childrenAccessor}_getDirectChildren(e){let t=this._getLevelAccessor(),i=this._expansionModel??this.treeControl?.expansionModel;if(!i)return g([]);let r=this._getExpansionKey(e),d=i.changed.pipe($(p=>p.added.includes(r)?g(!0):p.removed.includes(r)?g(!1):Ae),_e(this.isExpanded(e)));if(t)return U([d,this._flattenedNodes]).pipe(C(([p,_])=>p?this._findChildrenByLevel(t,_,e,1):[]));let u=this._getChildrenAccessor();if(u)return se(u(e)??[]);throw Et()}_findChildrenByLevel(e,t,i,r){let d=this._getExpansionKey(i),u=t.findIndex(F=>this._getExpansionKey(F)===d),p=e(i),_=p+r,M=[];for(let F=u+1;F<t.length;F++){let Ie=e(t[F]);if(Ie<=p)break;Ie<=_&&M.push(t[F])}return M}_registerNode(e){this._nodes.value.set(this._getExpansionKey(e.data),e),this._nodes.next(this._nodes.value)}_unregisterNode(e){this._nodes.value.delete(this._getExpansionKey(e.data)),this._nodes.next(this._nodes.value)}_getLevel(e){return this._levels.get(this._getExpansionKey(e))}_getSetSize(e){return this._getAriaSet(e).length}_getPositionInSet(e){let t=this._getAriaSet(e),i=this._getExpansionKey(e);return t.findIndex(r=>this._getExpansionKey(r)===i)+1}_getNodeParent(e){let t=this._parents.get(this._getExpansionKey(e.data));return t&&this._nodes.value.get(this._getExpansionKey(t))}_getNodeChildren(e){return this._getDirectChildren(e.data).pipe(C(t=>t.reduce((i,r)=>{let d=this._nodes.value.get(this._getExpansionKey(r));return d&&i.push(d),i},[])))}_sendKeydownToKeyManager(e){if(e.target===this._elementRef.nativeElement)this._keyManager.onKeydown(e);else{let t=this._nodes.getValue();for(let[,i]of t)if(e.target===i._elementRef.nativeElement){this._keyManager.onKeydown(e);break}}}_getDescendants(e){if(this.treeControl)return g(this.treeControl.getDescendants(e));if(this.levelAccessor){let t=this._findChildrenByLevel(this.levelAccessor,this._flattenedNodes.value,e,1/0);return g(t)}if(this.childrenAccessor)return this._getAllChildrenRecursively(e).pipe(pe((t,i)=>(t.push(...i),t),[]));throw Et()}_getAllChildrenRecursively(e){return this.childrenAccessor?se(this.childrenAccessor(e)).pipe(k(1),$(t=>{for(let i of t)this._parents.set(this._getExpansionKey(i),e);return g(...t).pipe(he(i=>ue(g([i]),this._getAllChildrenRecursively(i))))})):g([])}_getExpansionKey(e){return this.expansionKey?.(e)??e}_getAriaSet(e){let t=this._getExpansionKey(e),i=this._parents.get(t),r=i?this._getExpansionKey(i):null;return this._ariaSets.get(r)??[e]}_findParentForNode(e,t,i){if(!i.length)return null;let r=this._levels.get(this._getExpansionKey(e))??0;for(let d=t-1;d>=0;d--){let u=i[d];if((this._levels.get(this._getExpansionKey(u))??0)<r)return u}return null}_flattenNestedNodesWithExpansion(e,t=0){let i=this._getChildrenAccessor();return i?g(...e).pipe(he(r=>{let d=this._getExpansionKey(r);this._parents.has(d)||this._parents.set(d,null),this._levels.set(d,t);let u=se(i(r));return ue(g([r]),u.pipe(k(1),z(p=>{this._ariaSets.set(d,[...p??[]]);for(let _ of p??[]){let M=this._getExpansionKey(_);this._parents.set(M,r),this._levels.set(M,t+1)}}),$(p=>p?this._flattenNestedNodesWithExpansion(p,t+1).pipe(C(_=>this.isExpanded(r)?_:[])):g([]))))}),pe((r,d)=>(r.push(...d),r),[])):g([...e])}_computeRenderingData(e,t){if(this.childrenAccessor&&t==="flat")return this._clearPreviousCache(),this._ariaSets.set(null,[...e]),this._flattenNestedNodesWithExpansion(e).pipe(C(i=>({renderNodes:i,flattenedNodes:i})));if(this.levelAccessor&&t==="nested"){let i=this.levelAccessor;return g(e.filter(r=>i(r)===0)).pipe(C(r=>({renderNodes:r,flattenedNodes:e})),z(({flattenedNodes:r})=>{this._calculateParents(r)}))}else return t==="flat"?g({renderNodes:e,flattenedNodes:e}).pipe(z(({flattenedNodes:i})=>{this._calculateParents(i)})):(this._clearPreviousCache(),this._ariaSets.set(null,[...e]),this._flattenNestedNodesWithExpansion(e).pipe(C(i=>({renderNodes:e,flattenedNodes:i}))))}_updateCachedData(e){this._flattenedNodes.next(e)}_updateKeyManagerItems(e){this._keyManagerNodes.next(e)}_calculateParents(e){let t=this._getLevelAccessor();if(t){this._clearPreviousCache();for(let i=0;i<e.length;i++){let r=e[i],d=this._getExpansionKey(r);this._levels.set(d,t(r));let u=this._findParentForNode(r,i,e);this._parents.set(d,u);let p=u?this._getExpansionKey(u):null,_=this._ariaSets.get(p)??[];_.splice(i,0,r),this._ariaSets.set(p,_)}}}_forEachExpansionKey(e){let t=[],i=[];this._nodes.value.forEach(r=>{t.push(this._getExpansionKey(r.data)),i.push(this._getDescendants(r.data))}),i.length>0?U(i).pipe(k(1),N(this._onDestroy)).subscribe(r=>{r.forEach(d=>d.forEach(u=>t.push(this._getExpansionKey(u)))),e(t)}):e(t)}_clearPreviousCache(){this._parents.clear(),this._levels.clear(),this._ariaSets.clear()}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=L({type:n,selectors:[["cdk-tree"]],contentQueries:function(t,i,r){if(t&1&&Ce(r,ae,5),t&2){let d;V(d=K())&&(i._nodeDefs=d)}},viewQuery:function(t,i){if(t&1&&ne(q,7),t&2){let r;V(r=K())&&(i._nodeOutlet=r.first)}},hostAttrs:["role","tree",1,"cdk-tree"],hostBindings:function(t,i){t&1&&m("keydown",function(d){return i._sendKeydownToKeyManager(d)})},inputs:{dataSource:"dataSource",treeControl:"treeControl",levelAccessor:"levelAccessor",childrenAccessor:"childrenAccessor",trackBy:"trackBy",expansionKey:"expansionKey"},exportAs:["cdkTree"],decls:1,vars:0,consts:[["cdkTreeNodeOutlet",""]],template:function(t,i){t&1&&P(0,0)},dependencies:[q],encapsulation:2})}return n})(),B=(()=>{class n{_elementRef=f(fe);_tree=f(G);_tabindex=-1;_type="flat";get role(){return"treeitem"}set role(e){}get isExpandable(){return this._isExpandable()}set isExpandable(e){this._inputIsExpandable=e,!(this.data&&!this._isExpandable||!this._inputIsExpandable)&&(this._inputIsExpanded?this.expand():this._inputIsExpanded===!1&&this.collapse())}get isExpanded(){return this._tree.isExpanded(this._data)}set isExpanded(e){this._inputIsExpanded=e,e?this.expand():this.collapse()}isDisabled;typeaheadLabel;getLabel(){return this.typeaheadLabel||this._elementRef.nativeElement.textContent?.trim()||""}activation=new me;expandedChange=new me;static mostRecentTreeNode=null;_destroyed=new Z;_dataChanges=new Z;_inputIsExpandable=!1;_inputIsExpanded=void 0;_shouldFocus=!0;_parentNodeAriaLevel;get data(){return this._data}set data(e){e!==this._data&&(this._data=e,this._dataChanges.next())}_data;get isLeafNode(){return this._tree.treeControl?.isExpandable!==void 0&&!this._tree.treeControl.isExpandable(this._data)?!0:this._tree.treeControl?.isExpandable===void 0&&this._tree.treeControl?.getDescendants(this._data).length===0}get level(){return this._tree._getLevel(this._data)??this._parentNodeAriaLevel}_isExpandable(){return this._tree.treeControl?!this.isLeafNode:this._inputIsExpandable}_getAriaExpanded(){return this._isExpandable()?String(this.isExpanded):null}_getSetSize(){return this._tree._getSetSize(this._data)}_getPositionInSet(){return this._tree._getPositionInSet(this._data)}_changeDetectorRef=f(ye);constructor(){n.mostRecentTreeNode=this}ngOnInit(){this._parentNodeAriaLevel=Bt(this._elementRef.nativeElement),this._tree._getExpansionModel().changed.pipe(C(()=>this.isExpanded),Le()).subscribe(()=>this._changeDetectorRef.markForCheck()),this._tree._setNodeTypeIfUnset(this._type),this._tree._registerNode(this)}ngOnDestroy(){n.mostRecentTreeNode===this&&(n.mostRecentTreeNode=null),this._dataChanges.complete(),this._destroyed.next(),this._destroyed.complete()}getParent(){return this._tree._getNodeParent(this)??null}getChildren(){return this._tree._getNodeChildren(this)}focus(){this._tabindex=0,this._shouldFocus&&this._elementRef.nativeElement.focus(),this._changeDetectorRef.markForCheck()}unfocus(){this._tabindex=-1,this._changeDetectorRef.markForCheck()}activate(){this.isDisabled||this.activation.next(this._data)}collapse(){this.isExpandable&&this._tree.collapse(this._data)}expand(){this.isExpandable&&this._tree.expand(this._data)}makeFocusable(){this._tabindex=0,this._changeDetectorRef.markForCheck()}_focusItem(){this.isDisabled||this._tree._keyManager.focusItem(this)}_setActiveItem(){this.isDisabled||(this._shouldFocus=!1,this._tree._keyManager.focusItem(this),this._shouldFocus=!0)}_emitExpansionState(e){this.expandedChange.emit(e)}static \u0275fac=function(t){return new(t||n)};static \u0275dir=E({type:n,selectors:[["cdk-tree-node"]],hostAttrs:["role","treeitem",1,"cdk-tree-node"],hostVars:5,hostBindings:function(t,i){t&1&&m("click",function(){return i._setActiveItem()})("focus",function(){return i._focusItem()}),t&2&&(ve("tabindex",i._tabindex),ge("aria-expanded",i._getAriaExpanded())("aria-level",i.level+1)("aria-posinset",i._getPositionInSet())("aria-setsize",i._getSetSize()))},inputs:{role:"role",isExpandable:[2,"isExpandable","isExpandable",R],isExpanded:"isExpanded",isDisabled:[2,"isDisabled","isDisabled",R],typeaheadLabel:[0,"cdkTreeNodeTypeaheadLabel","typeaheadLabel"]},outputs:{activation:"activation",expandedChange:"expandedChange"},exportAs:["cdkTreeNode"]})}return n})();function Bt(n){let s=n.parentElement;for(;s&&!Ft(s);)s=s.parentElement;return s?s.classList.contains("cdk-nested-tree-node")?re(s.getAttribute("aria-level")):0:-1}function Ft(n){let s=n.classList;return!!(s?.contains("cdk-nested-tree-node")||s?.contains("cdk-tree"))}var we=(()=>{class n extends B{_type="nested";_differs=f(Se);_dataDiffer;_children;nodeOutlet;constructor(){super()}ngAfterContentInit(){this._dataDiffer=this._differs.find([]).create(this._tree.trackBy),this._tree._getDirectChildren(this.data).pipe(N(this._destroyed)).subscribe(e=>this.updateChildrenNodes(e)),this.nodeOutlet.changes.pipe(N(this._destroyed)).subscribe(()=>this.updateChildrenNodes())}ngOnDestroy(){this._clear(),super.ngOnDestroy()}updateChildrenNodes(e){let t=this._getNodeOutlet();if(e&&(this._children=e),t&&this._children){let i=t.viewContainer;this._tree.renderNodeChanges(this._children,this._dataDiffer,i,this._data)}else this._dataDiffer.diff([])}_clear(){let e=this._getNodeOutlet();e&&(e.viewContainer.clear(),this._dataDiffer.diff([]))}_getNodeOutlet(){let e=this.nodeOutlet;return e&&e.find(t=>!t._node||t._node===this)}static \u0275fac=function(t){return new(t||n)};static \u0275dir=E({type:n,selectors:[["cdk-nested-tree-node"]],contentQueries:function(t,i,r){if(t&1&&Ce(r,q,5),t&2){let d;V(d=K())&&(i.nodeOutlet=d)}},hostAttrs:[1,"cdk-nested-tree-node"],exportAs:["cdkNestedTreeNode"],features:[w([{provide:B,useExisting:n},{provide:W,useExisting:n}]),I]})}return n})();var Ne=(()=>{class n{_tree=f(G);_treeNode=f(B);recursive=!1;constructor(){}_toggle(){this.recursive?this._tree.toggleDescendants(this._treeNode.data):this._tree.toggle(this._treeNode.data),this._tree._keyManager.focusItem(this._treeNode)}static \u0275fac=function(t){return new(t||n)};static \u0275dir=E({type:n,selectors:[["","cdkTreeNodeToggle",""]],hostAttrs:["tabindex","-1"],hostBindings:function(t,i){t&1&&m("click",function(d){return i._toggle(),d.stopPropagation()})("keydown.Enter",function(d){return i._toggle(),d.preventDefault()})("keydown.Space",function(d){return i._toggle(),d.preventDefault()})},inputs:{recursive:[2,"cdkTreeNodeToggleRecursive","recursive",R]}})}return n})();var Mt=(()=>{class n{static \u0275fac=function(t){return new(t||n)};static \u0275mod=te({type:n});static \u0275inj=J({})}return n})();var Tt=(()=>{class n extends ae{data;static \u0275fac=(()=>{let e;return function(i){return(e||(e=H(n)))(i||n)}})();static \u0275dir=E({type:n,selectors:[["","matTreeNodeDef",""]],inputs:{when:[0,"matTreeNodeDefWhen","when"],data:[0,"matTreeNode","data"]},features:[w([{provide:ae,useExisting:n}]),I]})}return n})(),kt=(()=>{class n extends we{node;get disabled(){return this.isDisabled}set disabled(e){this.isDisabled=e}get tabIndex(){return this.isDisabled?-1:this._tabIndex}set tabIndex(e){this._tabIndex=e}_tabIndex;ngOnInit(){super.ngOnInit()}ngAfterContentInit(){super.ngAfterContentInit()}ngOnDestroy(){super.ngOnDestroy()}static \u0275fac=(()=>{let e;return function(i){return(e||(e=H(n)))(i||n)}})();static \u0275dir=E({type:n,selectors:[["mat-nested-tree-node"]],hostAttrs:[1,"mat-nested-tree-node"],inputs:{node:[0,"matNestedTreeNode","node"],disabled:[2,"disabled","disabled",R],tabIndex:[2,"tabIndex","tabIndex",e=>e==null?0:re(e)]},outputs:{activation:"activation",expandedChange:"expandedChange"},exportAs:["matNestedTreeNode"],features:[w([{provide:we,useExisting:n},{provide:B,useExisting:n},{provide:W,useExisting:n}]),I]})}return n})();var de=(()=>{class n{viewContainer=f(ee);_node=f(W,{optional:!0});static \u0275fac=function(t){return new(t||n)};static \u0275dir=E({type:n,selectors:[["","matTreeNodeOutlet",""]],features:[w([{provide:q,useExisting:n}])]})}return n})(),wt=(()=>{class n extends G{_nodeOutlet=void 0;static \u0275fac=(()=>{let e;return function(i){return(e||(e=H(n)))(i||n)}})();static \u0275cmp=L({type:n,selectors:[["mat-tree"]],viewQuery:function(t,i){if(t&1&&ne(de,7),t&2){let r;V(r=K())&&(i._nodeOutlet=r.first)}},hostAttrs:[1,"mat-tree"],exportAs:["matTree"],features:[w([{provide:G,useExisting:n}]),I],decls:1,vars:0,consts:[["matTreeNodeOutlet",""]],template:function(t,i){t&1&&P(0,0)},dependencies:[de],styles:[`.mat-tree{display:block;background-color:var(--mat-tree-container-background-color, var(--mat-sys-surface))}.mat-tree-node,.mat-nested-tree-node{color:var(--mat-tree-node-text-color, var(--mat-sys-on-surface));font-family:var(--mat-tree-node-text-font, var(--mat-sys-body-large-font));font-size:var(--mat-tree-node-text-size, var(--mat-sys-body-large-size));font-weight:var(--mat-tree-node-text-weight, var(--mat-sys-body-large-weight))}.mat-tree-node{display:flex;align-items:center;flex:1;word-wrap:break-word;min-height:var(--mat-tree-node-min-height, 48px)}.mat-nested-tree-node{border-bottom-width:0}
`],encapsulation:2})}return n})(),Nt=(()=>{class n extends Ne{static \u0275fac=(()=>{let e;return function(i){return(e||(e=H(n)))(i||n)}})();static \u0275dir=E({type:n,selectors:[["","matTreeNodeToggle",""]],inputs:{recursive:[0,"matTreeNodeToggleRecursive","recursive"]},features:[w([{provide:Ne,useExisting:n}]),I]})}return n})();var It=(()=>{class n{static \u0275fac=function(t){return new(t||n)};static \u0275mod=te({type:n});static \u0275inj=J({imports:[Mt,Ee,Ee]})}return n})();var le=class extends _t{get data(){return this._data.value}set data(s){this._data.next(s)}_data=new T([]);connect(s){return Be(s.viewChange,this._data).pipe(C(()=>this.data))}disconnect(){}};var At=(n,s)=>s.id;function Pt(n,s){if(n&1&&(o(0,"span",20),l(1),a()),n&2){let e=h().$implicit;c(),A("(",e.code,")")}}function Ot(n,s){if(n&1&&(o(0,"mat-chip",21),l(1),a()),n&2){let e=h().$implicit;c(),S(e.corporateName)}}function Vt(n,s){if(n&1){let e=O();o(0,"mat-nested-tree-node")(1,"div",17),Q(2,"button",18),o(3,"div",19),m("click",function(){let i=x(e).$implicit,r=h();return b(r.selectSbu(i))}),o(4,"mat-icon"),l(5,"business"),a(),o(6,"span"),l(7),a(),y(8,Pt,2,1,"span",20)(9,Ot,2,1,"mat-chip",21),a(),o(10,"button",22),m("click",function(){let i=x(e).$implicit,r=h();return b(r.editSbu(i))}),o(11,"mat-icon"),l(12,"edit"),a()(),o(13,"button",23),m("click",function(){let i=x(e).$implicit,r=h();return b(r.deleteSbu(i))}),o(14,"mat-icon"),l(15,"delete"),a()()()()}if(n&2){let e=s.$implicit,t=h();c(3),ie("selected",(t.selectedSbu==null?null:t.selectedSbu.id)===e.id),c(4),S(e.name),c(),v(e.code?8:-1),c(),v(e.corporateName?9:-1)}}function Kt(n,s){if(n&1&&(o(0,"span",20),l(1),a()),n&2){let e=h().$implicit;c(),A("(",e.code,")")}}function Rt(n,s){if(n&1&&(o(0,"mat-chip",21),l(1),a()),n&2){let e=h().$implicit;c(),S(e.corporateName)}}function Ut(n,s){if(n&1){let e=O();o(0,"mat-nested-tree-node")(1,"div",17)(2,"button",24)(3,"mat-icon"),l(4),a()(),o(5,"div",19),m("click",function(){let i=x(e).$implicit,r=h();return b(r.selectSbu(i))}),o(6,"mat-icon"),l(7,"business"),a(),o(8,"span"),l(9),a(),y(10,Kt,2,1,"span",20)(11,Rt,2,1,"mat-chip",21),a(),o(12,"button",22),m("click",function(){let i=x(e).$implicit,r=h();return b(r.editSbu(i))}),o(13,"mat-icon"),l(14,"edit"),a()(),o(15,"button",23),m("click",function(){let i=x(e).$implicit,r=h();return b(r.deleteSbu(i))}),o(16,"mat-icon"),l(17,"delete"),a()()(),o(18,"div"),P(19,25),a()()}if(n&2){let e=s.$implicit,t=h();c(4),A(" ",t.treeControl.isExpanded(e)?"expand_more":"chevron_right"," "),c(),ie("selected",(t.selectedSbu==null?null:t.selectedSbu.id)===e.id),c(4),S(e.name),c(),v(e.code?10:-1),c(),v(e.corporateName?11:-1),c(7),ie("hidden",!t.treeControl.isExpanded(e))}}function $t(n,s){n&1&&(o(0,"div",12)(1,"mat-icon"),l(2,"business"),a(),o(3,"p"),l(4,"No SBUs configured. Add your first SBU to get started."),a()())}function zt(n,s){if(n&1&&(o(0,"mat-option",29),l(1),a()),n&2){let e=s.$implicit;D("value",e.id),c(),S(e.name)}}function Ht(n,s){n&1&&(o(0,"mat-error"),l(1,"Corporate is required"),a())}function jt(n,s){n&1&&(o(0,"mat-error"),l(1,"Name is required"),a())}function Qt(n,s){if(n&1&&l(0),n&2){let e=h(2).$implicit;A(" (",e.corporateName,") ")}}function qt(n,s){if(n&1&&(o(0,"mat-option",29),l(1),y(2,Qt,1,1),a()),n&2){let e=h().$implicit;D("value",e.id),c(),A("",e.name," "),c(),v(e.corporateName?2:-1)}}function Wt(n,s){if(n&1&&y(0,qt,3,3,"mat-option",29),n&2){let e=s.$implicit,t=h(2);v(!t.editingSbu||e.id!==t.editingSbu.id?0:-1)}}function Gt(n,s){if(n&1){let e=O();o(0,"form",26),m("ngSubmit",function(){x(e);let i=h();return b(i.saveSbu())}),o(1,"mat-form-field",27)(2,"mat-label"),l(3,"Corporate"),a(),o(4,"mat-select",28)(5,"mat-option",29),l(6,"-- Select Corporate --"),a(),xe(7,zt,2,2,"mat-option",29,At),a(),y(9,Ht,2,0,"mat-error"),a(),o(10,"mat-form-field",27)(11,"mat-label"),l(12,"Name"),a(),Q(13,"input",30),y(14,jt,2,0,"mat-error"),a(),o(15,"mat-form-field",27)(16,"mat-label"),l(17,"Code"),a(),Q(18,"input",31),a(),o(19,"mat-form-field",27)(20,"mat-label"),l(21,"Description"),a(),Q(22,"textarea",32),a(),o(23,"mat-form-field",27)(24,"mat-label"),l(25,"Parent SBU"),a(),o(26,"mat-select",33)(27,"mat-option",29),l(28,"None (Root Level)"),a(),xe(29,Wt,1,1,null,null,At),a()(),o(31,"div",34)(32,"button",35),m("click",function(){x(e);let i=h();return b(i.cancelEdit())}),l(33,"Cancel"),a(),o(34,"button",36),l(35),a()()()}if(n&2){let e,t,i=h();D("formGroup",i.sbuForm),c(5),D("value",null),c(2),be(i.corporates),c(2),v((e=i.sbuForm.get("corporateId"))!=null&&e.hasError("required")?9:-1),c(5),v((t=i.sbuForm.get("name"))!=null&&t.hasError("required")?14:-1),c(13),D("value",null),c(2),be(i.flatSbus),c(5),D("disabled",i.loading||i.sbuForm.invalid),c(),A(" ",i.editingSbu?"Update":"Create"," ")}}function Xt(n,s){if(n&1&&(o(0,"div",37)(1,"span",38),l(2,"Corporate"),a(),o(3,"span",39),l(4),a()()),n&2){let e=h(2);c(4),S(e.selectedSbu.corporateName)}}function Yt(n,s){if(n&1&&(o(0,"div",37)(1,"span",38),l(2,"Code"),a(),o(3,"span",39),l(4),a()()),n&2){let e=h(2);c(4),S(e.selectedSbu.code)}}function Zt(n,s){if(n&1&&(o(0,"div",37)(1,"span",38),l(2,"Description"),a(),o(3,"span",39),l(4),a()()),n&2){let e=h(2);c(4),S(e.selectedSbu.description)}}function Jt(n,s){if(n&1&&(o(0,"div",37)(1,"span",38),l(2,"Parent"),a(),o(3,"span",39),l(4),a()()),n&2){let e=h(2);c(4),S(e.selectedSbu.parent.name)}}function ei(n,s){if(n&1){let e=O();o(0,"div",15),y(1,Xt,5,1,"div",37),o(2,"div",37)(3,"span",38),l(4,"Name"),a(),o(5,"span",39),l(6),a()(),y(7,Yt,5,1,"div",37)(8,Zt,5,1,"div",37)(9,Jt,5,1,"div",37),o(10,"div",40)(11,"button",41),m("click",function(){x(e);let i=h();return b(i.editSbu(i.selectedSbu))}),o(12,"mat-icon"),l(13,"edit"),a(),l(14," Edit "),a(),o(15,"button",6),m("click",function(){x(e);let i=h();return b(i.addChildSbu())}),o(16,"mat-icon"),l(17,"add"),a(),l(18," Add Child "),a()()()}if(n&2){let e=h();c(),v(e.selectedSbu.corporateName?1:-1),c(5),S(e.selectedSbu.name),c(),v(e.selectedSbu.code?7:-1),c(),v(e.selectedSbu.description?8:-1),c(),v(e.selectedSbu.parent?9:-1)}}function ti(n,s){n&1&&(o(0,"div",16)(1,"mat-icon"),l(2,"touch_app"),a(),o(3,"p"),l(4,'Select an SBU to view details or click "Add SBU" to create a new one.'),a()())}var on=(()=>{class n{fb;userService;importExportService;snackBar;treeControl=new oe(e=>e.children);dataSource=new le;flatSbus=[];corporates=[];selectedSbu=null;editingSbu=null;showAddSbu=!1;loading=!1;sbuForm;constructor(e,t,i,r){this.fb=e,this.userService=t,this.importExportService=i,this.snackBar=r,this.sbuForm=this.fb.group({corporateId:[null,De.required],name:["",De.required],code:[""],description:[""],parentId:[null]})}ngOnInit(){this.loadSbus(),this.loadCorporates()}loadCorporates(){this.userService.getActiveCorporates().subscribe(e=>{e.success&&(this.corporates=e.data)})}hasChild=(e,t)=>!!t.children&&t.children.length>0;loadSbus(){this.userService.getSbus().subscribe(e=>{e.success&&(this.flatSbus=e.data,this.dataSource.data=this.buildTree(e.data))})}buildTree(e){let t=new Map,i=[];return e.forEach(r=>{t.set(r.id,Y(X({},r),{children:[]}))}),e.forEach(r=>{let d=t.get(r.id);if(r.parent?.id){let u=t.get(r.parent.id);u?(u.children=u.children||[],u.children.push(d)):i.push(d)}else i.push(d)}),i}selectSbu(e){this.selectedSbu=e}editSbu(e){this.editingSbu=e,this.showAddSbu=!1,this.sbuForm.patchValue({corporateId:e.corporateId||null,name:e.name,code:e.code,description:e.description,parentId:e.parent?.id||null})}addChildSbu(){this.showAddSbu=!0,this.editingSbu=null,this.sbuForm.reset(),this.sbuForm.patchValue({corporateId:this.selectedSbu?.corporateId||null,parentId:this.selectedSbu?.id||null})}cancelEdit(){this.showAddSbu=!1,this.editingSbu=null,this.sbuForm.reset()}saveSbu(){if(this.sbuForm.invalid)return;this.loading=!0;let e=this.sbuForm.value;(this.editingSbu?this.userService.updateSbu(this.editingSbu.id,e):this.userService.createSbu(e)).subscribe({next:i=>{this.loading=!1,i.success&&(this.snackBar.open(this.editingSbu?"SBU updated successfully":"SBU created successfully","Close",{duration:3e3}),this.cancelEdit(),this.loadSbus())},error:i=>{this.loading=!1,this.snackBar.open(i.error?.message||"Operation failed","Close",{duration:3e3})}})}deleteSbu(e){confirm(`Are you sure you want to delete "${e.name}"? This will also delete all child SBUs.`)&&this.userService.deleteSbu(e.id).subscribe({next:t=>{t.success&&(this.snackBar.open("SBU deleted successfully","Close",{duration:3e3}),this.selectedSbu?.id===e.id&&(this.selectedSbu=null),this.loadSbus())},error:t=>{this.snackBar.open(t.error?.message||"Failed to delete SBU","Close",{duration:3e3})}})}downloadTemplate(){this.importExportService.downloadTemplate("sbus").subscribe({next:e=>{this.importExportService.downloadFile(e,"SBUs_Template.xlsx"),this.snackBar.open("Template downloaded","Close",{duration:3e3})},error:()=>this.snackBar.open("Failed to download template","Close",{duration:3e3})})}importFromExcel(e){let t=e.target;if(!t.files?.length)return;let i=t.files[0];this.importExportService.importFromExcel("sbus",i).subscribe({next:r=>{r.success?(this.snackBar.open(r.message||"SBUs imported","Close",{duration:3e3}),this.loadSbus()):this.snackBar.open(r.message||"Failed to import","Close",{duration:3e3}),t.value=""},error:r=>{this.snackBar.open(r.error?.message||"Failed to import","Close",{duration:3e3}),t.value=""}})}exportToExcel(){this.importExportService.exportToExcel("sbus").subscribe({next:e=>{this.importExportService.downloadFile(e,"SBUs_Export.xlsx"),this.snackBar.open("SBUs exported","Close",{duration:3e3})},error:()=>this.snackBar.open("Failed to export","Close",{duration:3e3})})}static \u0275fac=function(t){return new(t||n)(j(Ge),j(yt),j(St),j(xt))};static \u0275cmp=L({type:n,selectors:[["app-sbu-list"]],decls:41,vars:6,consts:[["fileInput",""],[1,"sbu-list-container"],[1,"header"],[1,"header-actions"],["mat-stroked-button","",3,"click"],["hidden","","type","file","accept",".xlsx",3,"change"],["mat-raised-button","","color","primary",3,"click"],[1,"content-grid"],[1,"tree-card"],[1,"sbu-tree",3,"dataSource","treeControl"],[4,"matTreeNodeDef"],[4,"matTreeNodeDef","matTreeNodeDefWhen"],[1,"no-data"],[1,"form-card"],[3,"formGroup"],[1,"sbu-details"],[1,"no-selection"],[1,"mat-tree-node"],["mat-icon-button","","disabled",""],[1,"sbu-node",3,"click"],[1,"code"],[1,"corporate-chip"],["mat-icon-button","",3,"click"],["mat-icon-button","","color","warn",3,"click"],["mat-icon-button","","matTreeNodeToggle",""],["matTreeNodeOutlet",""],[3,"ngSubmit","formGroup"],["appearance","outline",1,"form-field"],["formControlName","corporateId"],[3,"value"],["matInput","","formControlName","name"],["matInput","","formControlName","code"],["matInput","","formControlName","description","rows","3"],["formControlName","parentId"],[1,"form-actions"],["mat-button","","type","button",3,"click"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],[1,"detail-row"],[1,"label"],[1,"value"],[1,"detail-actions"],["mat-raised-button","",3,"click"]],template:function(t,i){if(t&1){let r=O();o(0,"div",1)(1,"div",2)(2,"h1"),l(3,"SBU Management"),a(),o(4,"div",3)(5,"button",4),m("click",function(){return x(r),b(i.downloadTemplate())}),o(6,"mat-icon"),l(7,"description"),a(),l(8," Template "),a(),o(9,"button",4),m("click",function(){x(r);let u=Ve(14);return b(u.click())}),o(10,"mat-icon"),l(11,"upload"),a(),l(12," Import "),a(),o(13,"input",5,0),m("change",function(u){return x(r),b(i.importFromExcel(u))}),a(),o(15,"button",4),m("click",function(){return x(r),b(i.exportToExcel())}),o(16,"mat-icon"),l(17,"download"),a(),l(18," Export "),a(),o(19,"button",6),m("click",function(){return x(r),b(i.showAddSbu=!0)}),o(20,"mat-icon"),l(21,"add"),a(),l(22," Add SBU "),a()()(),o(23,"div",7)(24,"mat-card",8)(25,"mat-card-header")(26,"mat-card-title"),l(27,"Organization Structure"),a()(),o(28,"mat-card-content")(29,"mat-tree",9),y(30,Vt,16,5,"mat-nested-tree-node",10)(31,Ut,20,8,"mat-nested-tree-node",11),a(),y(32,$t,5,0,"div",12),a()(),o(33,"mat-card",13)(34,"mat-card-header")(35,"mat-card-title"),l(36),a()(),o(37,"mat-card-content"),y(38,Gt,36,7,"form",14)(39,ei,19,5,"div",15)(40,ti,5,0,"div",16),a()()()()}t&2&&(c(29),D("dataSource",i.dataSource)("treeControl",i.treeControl),c(2),D("matTreeNodeDefWhen",i.hasChild),c(),v(i.flatSbus.length===0?32:-1),c(4),S(i.editingSbu?"Edit SBU":i.showAddSbu?"Add SBU":"SBU Details"),c(2),v(i.showAddSbu||i.editingSbu?38:i.selectedSbu?39:40))},dependencies:[Ke,Xe,Qe,ze,He,je,Ye,qe,We,at,nt,st,ot,rt,It,kt,Tt,Nt,wt,de,ut,ct,dt,lt,ht,pt,gt,ft,$e,it,tt,et,Je,Ze,bt,Ct,vt],styles:[".sbu-list-container[_ngcontent-%COMP%]{padding:1rem}.header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem}.header-actions[_ngcontent-%COMP%]{display:flex;gap:.5rem;align-items:center}.content-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 400px;gap:1rem}.sbu-tree[_ngcontent-%COMP%]{min-height:300px}.mat-tree-node[_ngcontent-%COMP%]{display:flex;align-items:center}.sbu-node[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;flex:1;padding:.5rem;border-radius:4px;cursor:pointer}.sbu-node[_ngcontent-%COMP%]:hover{background:#f5f5f5}.sbu-node.selected[_ngcontent-%COMP%]{background:#e3f2fd}.sbu-node[_ngcontent-%COMP%]   .code[_ngcontent-%COMP%]{font-size:.75rem;color:#666}.hidden[_ngcontent-%COMP%]{display:none}.no-data[_ngcontent-%COMP%], .no-selection[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:2rem;color:#666;text-align:center}.no-data[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .no-selection[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:48px;width:48px;height:48px;opacity:.5}.form-field[_ngcontent-%COMP%]{width:100%;margin-bottom:.5rem}.form-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:.5rem;margin-top:1rem}.sbu-details[_ngcontent-%COMP%]{padding:.5rem}.detail-row[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-bottom:1rem}.detail-row[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-size:.75rem;color:#666}.detail-row[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-weight:500}.detail-actions[_ngcontent-%COMP%]{display:flex;gap:.5rem;margin-top:1.5rem}.corporate-chip[_ngcontent-%COMP%]{font-size:.7rem;min-height:20px;padding:2px 8px;margin-left:.5rem}"]})}return n})();export{on as SbuListComponent};
