import{b as We,c as qe,d as Ye}from"./chunk-SNBLP2IG.js";import{a as Q,b as He,c as G,d as Qe,e as Ge}from"./chunk-4QX4Z4YV.js";import"./chunk-26MIDNQT.js";import{a as Je}from"./chunk-3U3ZRNJ5.js";import{a as H}from"./chunk-KHA6H2VC.js";import"./chunk-5B5KDLSZ.js";import"./chunk-WNUHNPS4.js";import{a as we,b as Te,c as ye,d as Pe}from"./chunk-YWWQJANS.js";import{a as Ue,b as De}from"./chunk-I4PAJBBT.js";import{a as j,c as z}from"./chunk-IVI3BL2S.js";import{a as ve,b as be,c as Se,e as Me,f as Ee,g as ke,h as $}from"./chunk-ZLEDUOR5.js";import{b as N,c as A}from"./chunk-C5XODKZL.js";import"./chunk-LU6VCXUA.js";import"./chunk-AGZT6V36.js";import{b as _e,e as fe,i as ge,j as Ce,l as xe,m as he}from"./chunk-2AGPTHDJ.js";import{d as le,i as se,m as me,w as de}from"./chunk-QGDZCCER.js";import{a as Ie,b as Le,c as Oe,d as Be,e as Ve,f as Fe,g as Re,h as Ne,i as Ae,j as $e,k as je,l as ze}from"./chunk-ZLHYE5PR.js";import{a as ce,c as pe,h as ue}from"./chunk-BTSRKJZZ.js";import"./chunk-MNRHFUYD.js";import"./chunk-UF7Y5AYJ.js";import"./chunk-PMYQJTBZ.js";import{c as ae,d as oe,g as re}from"./chunk-M6HZK7Y7.js";import{Aa as R,m as I,q as L,va as O,wa as B,xa as V,ya as F}from"./chunk-37H25STD.js";import{Eb as U,Hb as P,Jb as g,Lb as X,Mb as x,Nb as h,Ob as i,Pb as t,Qb as v,Rb as b,Sb as S,Ub as M,Yb as u,Zb as p,bc as W,cc as q,dc as Y,eb as l,gc as J,hc as a,ic as d,jb as C,jc as D,lc as Z,mc as ee,nc as te,oa as _,pa as f,qb as y,qc as ie,rc as ne,tc as w,vc as T,wb as c}from"./chunk-UYCZSUYP.js";var lt=(e,r)=>r.id||r,K=(e,r)=>r.id;function st(e,r){e&1&&(i(0,"span",9),a(1,"Locked"),t())}function mt(e,r){e&1&&(i(0,"span",10),a(1,"Active"),t())}function dt(e,r){e&1&&(i(0,"span",11),a(1,"Inactive"),t())}function ct(e,r){e&1&&a(0," Locked ")}function pt(e,r){e&1&&a(0," Active ")}function ut(e,r){e&1&&a(0," Inactive ")}function _t(e,r){if(e&1&&(i(0,"div",19)(1,"span",16),a(2,"Lock Reason"),t(),i(3,"span",17),a(4),t()()),e&2){let n=p();l(4),d(n.data.lockReason)}}function ft(e,r){if(e&1&&(i(0,"mat-chip"),a(1),t()),e&2){let n=r.$implicit;l(),d(n.name||n)}}function gt(e,r){if(e&1&&(i(0,"div",22),x(1,ft,2,1,"mat-chip",null,lt),t()),e&2){let n=p();l(),h(n.data.roles)}}function Ct(e,r){e&1&&(i(0,"p",23),a(1,"No roles assigned"),t())}function xt(e,r){if(e&1&&(i(0,"mat-chip",32),a(1),t()),e&2){let n=r.$implicit;l(),d(n)}}function ht(e,r){if(e&1&&(i(0,"div",22),x(1,xt,2,1,"mat-chip",32,X),t()),e&2){let n=p();l(),h(n.data.privileges)}}function vt(e,r){e&1&&(i(0,"p",23),a(1,"No privileges assigned"),t())}function bt(e,r){if(e&1&&(i(0,"mat-chip"),a(1),t()),e&2){let n=r.$implicit;l(),d(n.name)}}function St(e,r){if(e&1&&(i(0,"div",22),x(1,bt,2,1,"mat-chip",null,K),t()),e&2){let n=p();l(),h(n.data.corporates)}}function Mt(e,r){if(e&1&&(i(0,"p",23),a(1),t()),e&2){let n=p();l(),D("",n.data.corporateIds.length," corporate(s) assigned")}}function Et(e,r){e&1&&(i(0,"p",23),a(1,"No corporates assigned (Global Access)"),t())}function kt(e,r){if(e&1&&(i(0,"mat-chip"),a(1),t()),e&2){let n=r.$implicit;l(),d(n.name)}}function Ut(e,r){if(e&1&&(i(0,"div",22),x(1,kt,2,1,"mat-chip",null,K),t()),e&2){let n=p();l(),h(n.data.sbus)}}function Dt(e,r){if(e&1&&(i(0,"p",23),a(1),t()),e&2){let n=p();l(),D("",n.data.sbuIds.length," SBU(s) assigned")}}function wt(e,r){e&1&&(i(0,"p",23),a(1,"No SBUs assigned"),t())}function Tt(e,r){if(e&1&&(i(0,"mat-chip"),a(1),t()),e&2){let n=r.$implicit;l(),d(n.name)}}function yt(e,r){if(e&1&&(i(0,"div",22),x(1,Tt,2,1,"mat-chip",null,K),t()),e&2){let n=p();l(),h(n.data.branches)}}function Pt(e,r){if(e&1&&(i(0,"p",23),a(1),t()),e&2){let n=p();l(),D("",n.data.branchIds.length," branch(es) assigned")}}function It(e,r){e&1&&(i(0,"p",23),a(1,"No branches assigned"),t())}function Lt(e,r){if(e&1){let n=M();i(0,"button",29),u("click",function(){_(n);let o=p();return f(o.unlockUser())}),i(1,"mat-icon"),a(2,"lock_open"),t(),a(3," Unlock "),t()}}function Ot(e,r){if(e&1){let n=M();i(0,"button",33),u("click",function(){_(n);let o=p();return f(o.lockUser())}),i(1,"mat-icon"),a(2,"lock"),t(),a(3," Lock "),t()}}var Ke=(()=>{class e{data;dialogRef;userService;router;snackBar;constructor(n,s,o,m,E){this.data=n,this.dialogRef=s,this.userService=o,this.router=m,this.snackBar=E}get isLocked(){return this.data.isLocked||this.data.locked||!1}getInitials(){let n=this.data.firstName?.[0]||"",s=this.data.lastName?.[0]||"";return(n+s).toUpperCase()||this.data.username?.[0]?.toUpperCase()||"?"}editUser(){this.dialogRef.close(),this.router.navigate(["/users",this.data.id])}lockUser(){this.userService.lockUser(this.data.id).subscribe({next:n=>{n.success&&(this.snackBar.open("User locked successfully","Close",{duration:3e3}),this.data.isLocked=!0,this.data.locked=!0,this.dialogRef.close("refresh"))},error:n=>{this.snackBar.open(n.error?.message||"Failed to lock user","Close",{duration:3e3})}})}unlockUser(){this.userService.unlockUser(this.data.id).subscribe({next:n=>{n.success&&(this.snackBar.open("User unlocked successfully","Close",{duration:3e3}),this.data.isLocked=!1,this.data.locked=!1,this.dialogRef.close("refresh"))},error:n=>{this.snackBar.open(n.error?.message||"Failed to unlock user","Close",{duration:3e3})}})}resetPassword(){this.userService.adminResetPassword(this.data.id).subscribe({next:n=>{n.success&&this.snackBar.open("Password reset email sent","Close",{duration:3e3})},error:n=>{this.snackBar.open(n.error?.message||"Failed to reset password","Close",{duration:3e3})}})}close(){this.dialogRef.close()}static \u0275fac=function(s){return new(s||e)(C(be),C(ve),C(H),C(ae),C(N))};static \u0275cmp=y({type:e,selectors:[["app-user-detail-dialog"]],decls:154,vars:37,consts:[[1,"dialog-header"],["mat-dialog-title",""],["mat-icon-button","",3,"click"],[1,"user-header"],[1,"avatar"],[1,"user-title"],[1,"username"],[1,"status-badges"],[1,"badge"],[1,"badge","locked"],[1,"badge","active"],[1,"badge","inactive"],["label","Personal Info"],[1,"tab-content"],[1,"detail-grid"],[1,"detail-item"],[1,"label"],[1,"value"],["label","Account Info"],[1,"detail-item","full-width"],["label","Roles & Permissions"],[1,"section"],[1,"chips-container"],[1,"no-data"],["label","Organization"],[1,"action-buttons"],["mat-stroked-button","","color","primary",3,"click"],["mat-stroked-button",""],["mat-stroked-button","","color","warn"],["mat-stroked-button","",3,"click"],[1,"spacer"],["mat-button","",3,"click"],[1,"privilege-chip"],["mat-stroked-button","","color","warn",3,"click"]],template:function(s,o){s&1&&(i(0,"div",0)(1,"h2",1)(2,"mat-icon"),a(3,"person"),t(),a(4," User Details "),t(),i(5,"button",2),u("click",function(){return o.close()}),i(6,"mat-icon"),a(7,"close"),t()()(),i(8,"mat-dialog-content")(9,"div",3)(10,"div",4),a(11),t(),i(12,"div",5)(13,"h3"),a(14),t(),i(15,"span",6),a(16),t(),i(17,"div",7)(18,"span",8),a(19),t(),c(20,st,2,0,"span",9)(21,mt,2,0,"span",10)(22,dt,2,0,"span",11),t()()(),v(23,"mat-divider"),i(24,"mat-tab-group")(25,"mat-tab",12)(26,"div",13)(27,"div",14)(28,"div",15)(29,"span",16),a(30,"First Name"),t(),i(31,"span",17),a(32),t()(),i(33,"div",15)(34,"span",16),a(35,"Last Name"),t(),i(36,"span",17),a(37),t()(),i(38,"div",15)(39,"span",16),a(40,"Email"),t(),i(41,"span",17),a(42),t()(),i(43,"div",15)(44,"span",16),a(45,"Phone"),t(),i(46,"span",17),a(47),t()(),i(48,"div",15)(49,"span",16),a(50,"Staff ID"),t(),i(51,"span",17),a(52),t()(),i(53,"div",15)(54,"span",16),a(55,"Department"),t(),i(56,"span",17),a(57),t()()()()(),i(58,"mat-tab",18)(59,"div",13)(60,"div",14)(61,"div",15)(62,"span",16),a(63,"Username"),t(),i(64,"span",17),a(65),t()(),i(66,"div",15)(67,"span",16),a(68,"User Type"),t(),i(69,"span",17),a(70),t()(),i(71,"div",15)(72,"span",16),a(73,"Status"),t(),i(74,"span",17),c(75,ct,1,0)(76,pt,1,0)(77,ut,1,0),t()(),c(78,_t,5,1,"div",19),i(79,"div",15)(80,"span",16),a(81,"Must Change Password"),t(),i(82,"span",17),a(83),t()(),i(84,"div",15)(85,"span",16),a(86,"Last Login"),t(),i(87,"span",17),a(88),w(89,"date"),t()(),i(90,"div",15)(91,"span",16),a(92,"Password Changed"),t(),i(93,"span",17),a(94),w(95,"date"),t()(),i(96,"div",15)(97,"span",16),a(98,"Created At"),t(),i(99,"span",17),a(100),w(101,"date"),t()(),i(102,"div",15)(103,"span",16),a(104,"Created By"),t(),i(105,"span",17),a(106),t()()()()(),i(107,"mat-tab",20)(108,"div",13)(109,"div",21)(110,"h4"),a(111,"Roles"),t(),c(112,gt,3,0,"div",22)(113,Ct,2,0,"p",23),t(),i(114,"div",21)(115,"h4"),a(116,"Privileges"),t(),c(117,ht,3,0,"div",22)(118,vt,2,0,"p",23),t()()(),i(119,"mat-tab",24)(120,"div",13)(121,"div",21)(122,"h4"),a(123,"Corporates"),t(),c(124,St,3,0,"div",22)(125,Mt,2,1,"p",23)(126,Et,2,0,"p",23),t(),i(127,"div",21)(128,"h4"),a(129,"SBUs"),t(),c(130,Ut,3,0,"div",22)(131,Dt,2,1,"p",23)(132,wt,2,0,"p",23),t(),i(133,"div",21)(134,"h4"),a(135,"Branches"),t(),c(136,yt,3,0,"div",22)(137,Pt,2,1,"p",23)(138,It,2,0,"p",23),t()()()()(),i(139,"mat-dialog-actions")(140,"div",25)(141,"button",26),u("click",function(){return o.editUser()}),i(142,"mat-icon"),a(143,"edit"),t(),a(144," Edit "),t(),c(145,Lt,4,0,"button",27)(146,Ot,4,0,"button",28),i(147,"button",29),u("click",function(){return o.resetPassword()}),i(148,"mat-icon"),a(149,"vpn_key"),t(),a(150," Reset Password "),t()(),v(151,"span",30),i(152,"button",31),u("click",function(){return o.close()}),a(153,"Close"),t()()),s&2&&(l(11),d(o.getInitials()),l(3),d(o.data.fullName||o.data.firstName+" "+o.data.lastName),l(2),d(o.data.username),l(2),P(o.data.userType==null?null:o.data.userType.toLowerCase()),l(),d(o.data.userType),l(),g(o.data.isLocked||o.data.locked?20:o.data.isActive||o.data.enabled?21:22),l(12),d(o.data.firstName||"-"),l(5),d(o.data.lastName||"-"),l(5),d(o.data.email||"-"),l(5),d(o.data.phoneNumber||o.data.phone||"-"),l(5),d(o.data.staffId||"-"),l(5),d(o.data.department||"-"),l(8),d(o.data.username),l(5),d(o.data.userType),l(5),g(o.data.isLocked||o.data.locked?75:o.data.isActive||o.data.enabled?76:77),l(3),g(o.data.lockReason?78:-1),l(5),d(o.data.mustChangePassword?"Yes":"No"),l(5),d(o.data.lastLogin?T(89,28,o.data.lastLogin,"medium"):"Never"),l(6),d(o.data.passwordChangedAt?T(95,31,o.data.passwordChangedAt,"medium"):"-"),l(6),d(T(101,34,o.data.createdAt,"medium")),l(6),d(o.data.createdBy||"-"),l(6),g(o.data.roles&&o.data.roles.length>0?112:113),l(5),g(o.data.privileges&&o.data.privileges.length>0?117:118),l(7),g(o.data.corporates&&o.data.corporates.length>0?124:o.data.corporateIds&&o.data.corporateIds.length>0?125:126),l(6),g(o.data.sbus&&o.data.sbus.length>0?130:o.data.sbuIds&&o.data.sbuIds.length>0?131:132),l(6),g(o.data.branches&&o.data.branches.length>0?136:o.data.branchIds&&o.data.branchIds.length>0?137:138),l(9),g(o.isLocked?145:146))},dependencies:[L,I,$,Me,ke,Ee,R,F,V,B,O,De,Ue,z,j,Ye,We,qe,A],styles:[".dialog-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:0 16px}.dialog-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;margin:0}mat-dialog-content[_ngcontent-%COMP%]{min-width:550px;max-height:70vh}.user-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;padding:1rem 0}.avatar[_ngcontent-%COMP%]{width:64px;height:64px;border-radius:50%;background:#1976d2;color:#fff;display:flex;align-items:center;justify-content:center;font-size:1.5rem;font-weight:500}.user-title[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:1.25rem}.user-title[_ngcontent-%COMP%]   .username[_ngcontent-%COMP%]{color:#666;font-size:.875rem}.status-badges[_ngcontent-%COMP%]{display:flex;gap:.5rem;margin-top:.5rem}.badge[_ngcontent-%COMP%]{display:inline-block;padding:.25rem .75rem;border-radius:4px;font-size:.75rem;font-weight:500}.badge.active[_ngcontent-%COMP%]{background:#e8f5e9;color:#2e7d32}.badge.inactive[_ngcontent-%COMP%]{background:#f5f5f5;color:#666}.badge.locked[_ngcontent-%COMP%]{background:#ffebee;color:#c62828}.badge.system[_ngcontent-%COMP%]{background:#e3f2fd;color:#1565c0}.badge.staff[_ngcontent-%COMP%]{background:#e8f5e9;color:#2e7d32}.badge.manager[_ngcontent-%COMP%]{background:#fff3e0;color:#e65100}.badge.external[_ngcontent-%COMP%]{background:#f3e5f5;color:#7b1fa2}.tab-content[_ngcontent-%COMP%]{padding:1rem 0}.detail-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);gap:1rem}.detail-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.25rem}.detail-item.full-width[_ngcontent-%COMP%]{grid-column:span 2}.detail-item[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-size:.75rem;color:#666;text-transform:uppercase;letter-spacing:.5px}.detail-item[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-weight:500}.section[_ngcontent-%COMP%]{margin-bottom:1.5rem}.section[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 .75rem;color:#1976d2;font-size:.875rem;font-weight:500}.chips-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:.5rem}.privilege-chip[_ngcontent-%COMP%]{background:#e3f2fd!important}.no-data[_ngcontent-%COMP%]{color:#666;font-style:italic;margin:0}mat-divider[_ngcontent-%COMP%]{margin:.5rem 0}mat-dialog-actions[_ngcontent-%COMP%]{display:flex;align-items:center;padding:8px 16px}.action-buttons[_ngcontent-%COMP%]{display:flex;gap:.5rem}.action-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.25rem}.spacer[_ngcontent-%COMP%]{flex:1}"]})}return e})();var Bt=()=>[10,25,50,100],Vt=e=>["/users",e],Ft=(e,r)=>r.id;function Rt(e,r){e&1&&(i(0,"th",26),a(1,"Name"),t())}function Nt(e,r){if(e&1&&(i(0,"td",27)(1,"div",28)(2,"div",29),a(3),t(),i(4,"div")(5,"div",30),a(6),t(),i(7,"div",31),a(8),t()()()()),e&2){let n=r.$implicit,s=p();l(3),d(s.getInitials(n)),l(3),d(n.fullName),l(2),d(n.email)}}function At(e,r){e&1&&(i(0,"th",26),a(1,"Username"),t())}function $t(e,r){if(e&1&&(i(0,"td",27),a(1),t()),e&2){let n=r.$implicit;l(),d(n.username)}}function jt(e,r){e&1&&(i(0,"th",26),a(1,"Type"),t())}function zt(e,r){if(e&1&&(i(0,"td",27)(1,"span",32),a(2),t()()),e&2){let n=r.$implicit;l(),P(n.userType.toLowerCase()),l(),d(n.userType)}}function Ht(e,r){e&1&&(i(0,"th",33),a(1,"Roles"),t())}function Qt(e,r){if(e&1&&(i(0,"mat-chip"),a(1),t()),e&2){let n=r.$implicit;l(),d(n.name)}}function Gt(e,r){if(e&1&&(i(0,"span",34),a(1),t()),e&2){let n=p().$implicit;l(),D("+",n.roles.length-2," more")}}function Wt(e,r){if(e&1&&(i(0,"td",27),x(1,Qt,2,1,"mat-chip",null,Ft),c(3,Gt,2,1,"span",34),t()),e&2){let n=r.$implicit;l(),h(n.roles==null?null:n.roles.slice(0,2)),l(2),g((n.roles==null?null:n.roles.length)>2?3:-1)}}function qt(e,r){e&1&&(i(0,"th",26),a(1,"Status"),t())}function Yt(e,r){e&1&&(i(0,"span",35),a(1,"Locked"),t())}function Jt(e,r){e&1&&(i(0,"span",36),a(1,"Active"),t())}function Kt(e,r){e&1&&(i(0,"span",37),a(1,"Inactive"),t())}function Xt(e,r){if(e&1&&(i(0,"td",27),c(1,Yt,2,0,"span",35)(2,Jt,2,0,"span",36)(3,Kt,2,0,"span",37),t()),e&2){let n=r.$implicit;l(),g(n.locked?1:n.enabled?2:3)}}function Zt(e,r){e&1&&(i(0,"th",26),a(1,"Last Login"),t())}function ei(e,r){if(e&1&&(i(0,"td",27),a(1),w(2,"date"),t()),e&2){let n=r.$implicit;l(),D(" ",T(2,1,n.lastLogin,"short")," ")}}function ti(e,r){e&1&&v(0,"th",33)}function ii(e,r){if(e&1){let n=M();i(0,"button",39),u("click",function(){_(n);let o=p().$implicit,m=p();return f(m.unlockUser(o))}),i(1,"mat-icon"),a(2,"lock_open"),t(),i(3,"span"),a(4,"Unlock"),t()()}}function ni(e,r){if(e&1){let n=M();i(0,"button",39),u("click",function(){_(n);let o=p().$implicit,m=p();return f(m.lockUser(o))}),i(1,"mat-icon"),a(2,"lock"),t(),i(3,"span"),a(4,"Lock"),t()()}}function ai(e,r){if(e&1){let n=M();i(0,"td",27)(1,"button",38)(2,"mat-icon"),a(3,"more_vert"),t()(),i(4,"mat-menu",null,1)(6,"button",39),u("click",function(){let o=_(n).$implicit,m=p();return f(m.viewUser(o))}),i(7,"mat-icon"),a(8,"visibility"),t(),i(9,"span"),a(10,"View"),t()(),i(11,"button",40)(12,"mat-icon"),a(13,"edit"),t(),i(14,"span"),a(15,"Edit"),t()(),c(16,ii,5,0,"button",41)(17,ni,5,0,"button",41),i(18,"button",39),u("click",function(){let o=_(n).$implicit,m=p();return f(m.resetPassword(o))}),i(19,"mat-icon"),a(20,"vpn_key"),t(),i(21,"span"),a(22,"Reset Password"),t()(),i(23,"button",42),u("click",function(){let o=_(n).$implicit,m=p();return f(m.deleteUser(o))}),i(24,"mat-icon"),a(25,"delete"),t(),i(26,"span"),a(27,"Delete"),t()()()()}if(e&2){let n=r.$implicit,s=J(5);l(),U("matMenuTriggerFor",s),l(10),U("routerLink",ne(3,Vt,n.id)),l(5),g(n.locked?16:17)}}function oi(e,r){e&1&&v(0,"tr",43)}function ri(e,r){e&1&&v(0,"tr",44)}var zi=(()=>{class e{userService;importExportService;snackBar;dialog;displayedColumns=["fullName","username","userType","roles","status","lastLogin","actions"];dataSource=new ze([]);searchTerm="";paginator;sort;constructor(n,s,o,m){this.userService=n,this.importExportService=s,this.snackBar=o,this.dialog=m}ngOnInit(){this.loadUsers()}ngAfterViewInit(){this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort}loadUsers(){this.userService.getUsers().subscribe(n=>{n.success&&(this.dataSource.data=n.data)})}applyFilter(){this.dataSource.filter=this.searchTerm.trim().toLowerCase()}getInitials(n){return(n.firstName?.[0]||"")+(n.lastName?.[0]||"")}viewUser(n){this.dialog.open(Ke,{width:"650px",maxHeight:"90vh",data:n}).afterClosed().subscribe(o=>{o==="refresh"&&this.loadUsers()})}lockUser(n){this.userService.lockUser(n.id).subscribe(s=>{s.success&&(this.snackBar.open("User locked successfully","Close",{duration:3e3}),this.loadUsers())})}unlockUser(n){this.userService.unlockUser(n.id).subscribe(s=>{s.success&&(this.snackBar.open("User unlocked successfully","Close",{duration:3e3}),this.loadUsers())})}resetPassword(n){this.userService.adminResetPassword(n.id).subscribe(s=>{s.success&&this.snackBar.open("Password reset email sent","Close",{duration:3e3})})}deleteUser(n){confirm(`Are you sure you want to delete ${n.fullName}?`)&&this.userService.deleteUser(n.id).subscribe(s=>{s.success&&(this.snackBar.open("User deleted successfully","Close",{duration:3e3}),this.loadUsers())})}downloadTemplate(){this.importExportService.downloadTemplate("users").subscribe({next:n=>{this.importExportService.downloadFile(n,"Users_Template.xlsx"),this.snackBar.open("Template downloaded","Close",{duration:3e3})},error:()=>this.snackBar.open("Failed to download template","Close",{duration:3e3})})}importFromExcel(n){let s=n.target;if(!s.files?.length)return;let o=s.files[0];this.importExportService.importFromExcel("users",o).subscribe({next:m=>{m.success?(this.snackBar.open(m.message||"Users imported successfully","Close",{duration:3e3}),this.loadUsers()):this.snackBar.open(m.message||"Failed to import","Close",{duration:3e3}),s.value=""},error:m=>{this.snackBar.open(m.error?.message||"Failed to import","Close",{duration:3e3}),s.value=""}})}exportToExcel(){this.importExportService.exportToExcel("users").subscribe({next:n=>{this.importExportService.downloadFile(n,"Users_Export.xlsx"),this.snackBar.open("Users exported","Close",{duration:3e3})},error:()=>this.snackBar.open("Failed to export","Close",{duration:3e3})})}static \u0275fac=function(s){return new(s||e)(C(H),C(Je),C(N),C(Se))};static \u0275cmp=y({type:e,selectors:[["app-user-list"]],viewQuery:function(s,o){if(s&1&&(W(Q,5),W(G,5)),s&2){let m;q(m=Y())&&(o.paginator=m.first),q(m=Y())&&(o.sort=m.first)}},decls:57,vars:6,consts:[["fileInput",""],["menu","matMenu"],[1,"user-list-container"],[1,"header"],[1,"header-actions"],["mat-stroked-button","",3,"click"],["hidden","","type","file","accept",".xlsx",3,"change"],["mat-raised-button","","color","primary","routerLink","/users/new"],[1,"table-toolbar"],["appearance","outline",1,"search-field"],["matInput","","placeholder","Search by name, username, or email",3,"ngModelChange","keyup","ngModel"],["matPrefix",""],["mat-table","","matSort","",1,"data-table",3,"dataSource"],["matColumnDef","fullName"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","username"],["matColumnDef","userType"],["matColumnDef","roles"],["mat-header-cell","",4,"matHeaderCellDef"],["matColumnDef","status"],["matColumnDef","lastLogin"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","",3,"pageSizeOptions"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],[1,"user-info"],[1,"avatar"],[1,"name"],[1,"email"],[1,"badge"],["mat-header-cell",""],[1,"more"],[1,"badge","locked"],[1,"badge","active"],[1,"badge","inactive"],["mat-icon-button","",3,"matMenuTriggerFor"],["mat-menu-item","",3,"click"],["mat-menu-item","",3,"routerLink"],["mat-menu-item",""],["mat-menu-item","",1,"delete-action",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(s,o){if(s&1){let m=M();i(0,"div",2)(1,"div",3)(2,"h1"),a(3,"Users"),t(),i(4,"div",4)(5,"button",5),u("click",function(){return _(m),f(o.downloadTemplate())}),i(6,"mat-icon"),a(7,"description"),t(),a(8," Template "),t(),i(9,"button",5),u("click",function(){_(m);let k=J(14);return f(k.click())}),i(10,"mat-icon"),a(11,"upload"),t(),a(12," Import "),t(),i(13,"input",6,0),u("change",function(k){return _(m),f(o.importFromExcel(k))}),t(),i(15,"button",5),u("click",function(){return _(m),f(o.exportToExcel())}),i(16,"mat-icon"),a(17,"download"),t(),a(18," Export "),t(),i(19,"button",7)(20,"mat-icon"),a(21,"add"),t(),a(22," Add User "),t()()(),i(23,"mat-card")(24,"mat-card-content")(25,"div",8)(26,"mat-form-field",9)(27,"mat-label"),a(28,"Search users"),t(),i(29,"input",10),te("ngModelChange",function(k){return _(m),ee(o.searchTerm,k)||(o.searchTerm=k),f(k)}),u("keyup",function(){return _(m),f(o.applyFilter())}),t(),i(30,"mat-icon",11),a(31,"search"),t()()(),i(32,"table",12),b(33,13),c(34,Rt,2,0,"th",14)(35,Nt,9,3,"td",15),S(),b(36,16),c(37,At,2,0,"th",14)(38,$t,2,1,"td",15),S(),b(39,17),c(40,jt,2,0,"th",14)(41,zt,3,3,"td",15),S(),b(42,18),c(43,Ht,2,0,"th",19)(44,Wt,4,1,"td",15),S(),b(45,20),c(46,qt,2,0,"th",14)(47,Xt,4,1,"td",15),S(),b(48,21),c(49,Zt,2,0,"th",14)(50,ei,3,4,"td",15),S(),b(51,22),c(52,ti,1,0,"th",19)(53,ai,28,5,"td",15),S(),c(54,oi,1,0,"tr",23)(55,ri,1,0,"tr",24),t(),v(56,"mat-paginator",25),t()()()}s&2&&(l(29),Z("ngModel",o.searchTerm),l(3),U("dataSource",o.dataSource),l(22),U("matHeaderRowDef",o.displayedColumns),l(),U("matRowDefColumns",o.displayedColumns),l(),U("pageSizeOptions",ie(5,Bt)))},dependencies:[L,I,re,oe,de,le,se,me,ue,ce,pe,je,Ie,Oe,Re,Be,Le,Ne,Ve,Fe,Ae,$e,He,Q,Ge,G,Qe,Ce,ge,_e,fe,he,xe,R,F,V,B,O,Pe,Te,we,ye,z,j,A,$],styles:[".user-list-container[_ngcontent-%COMP%]{padding:1rem}.header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem}.header-actions[_ngcontent-%COMP%]{display:flex;gap:.5rem;align-items:center}.table-toolbar[_ngcontent-%COMP%]{margin-bottom:1rem}.search-field[_ngcontent-%COMP%]{width:400px}.data-table[_ngcontent-%COMP%]{width:100%}.user-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem}.avatar[_ngcontent-%COMP%]{width:36px;height:36px;border-radius:50%;background:#1976d2;color:#fff;display:flex;align-items:center;justify-content:center;font-size:.875rem;font-weight:500}.user-info[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-weight:500}.user-info[_ngcontent-%COMP%]   .email[_ngcontent-%COMP%]{font-size:.75rem;color:#666}.badge[_ngcontent-%COMP%]{padding:.25rem .5rem;border-radius:4px;font-size:.75rem;font-weight:500}.badge.active[_ngcontent-%COMP%]{background:#e8f5e9;color:#2e7d32}.badge.inactive[_ngcontent-%COMP%]{background:#f5f5f5;color:#666}.badge.locked[_ngcontent-%COMP%]{background:#ffebee;color:#c62828}.badge.system[_ngcontent-%COMP%]{background:#e3f2fd;color:#1565c0}.badge.staff[_ngcontent-%COMP%]{background:#e8f5e9;color:#2e7d32}.badge.manager[_ngcontent-%COMP%]{background:#fff3e0;color:#e65100}.badge.external[_ngcontent-%COMP%]{background:#f3e5f5;color:#7b1fa2}.more[_ngcontent-%COMP%]{font-size:.75rem;color:#666;margin-left:.25rem}.delete-action[_ngcontent-%COMP%]{color:#c62828}"]})}return e})();export{zi as UserListComponent};
