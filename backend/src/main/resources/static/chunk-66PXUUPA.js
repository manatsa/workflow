import{a as Lt,b as Bt,c as Wt,d as At,e as $t,f as Qt}from"./chunk-E7Q73I3P.js";import{a as It,b as Ft}from"./chunk-67L4UISH.js";import{b as Nt,c as Rt,d as Pt}from"./chunk-YNJRABZA.js";import"./chunk-F5X5MWHG.js";import{a as kt,b as Vt}from"./chunk-26MIDNQT.js";import"./chunk-J43BGVIN.js";import"./chunk-MS4AQ6UA.js";import{a as lt,b as rt}from"./chunk-DCGWK6OW.js";import{d as I}from"./chunk-WNUHNPS4.js";import{a as pt,b as ut,c as Ct,d as ft}from"./chunk-YWWQJANS.js";import{a as st,b as _t}from"./chunk-I4PAJBBT.js";import{a as xt,b as gt,c as bt}from"./chunk-INV3KQYA.js";import{h as dt}from"./chunk-ZLEDUOR5.js";import{b as ct,c as mt}from"./chunk-C5XODKZL.js";import"./chunk-LU6VCXUA.js";import"./chunk-AGZT6V36.js";import{a as ot,b as at}from"./chunk-CDWC6WKW.js";import{b as J,d as Z,i as tt,j as et,l as nt,m as it}from"./chunk-ZS434AQM.js";import{d as F,i as L,m as B,o as W,v as A,w as $}from"./chunk-M3VCE5SG.js";import{b as qt}from"./chunk-5DEAF6L4.js";import{a as wt,b as St,c as ht,d as Ot,e as Mt,f as jt,g as yt,h as vt,i as Dt,j as Et,k as Tt}from"./chunk-ZLHYE5PR.js";import{a as X,c as K,h as Y}from"./chunk-BTSRKJZZ.js";import"./chunk-UF7Y5AYJ.js";import"./chunk-PMYQJTBZ.js";import{Aa as U,q as P,va as Q,wa as H,xa as z,ya as G}from"./chunk-37H25STD.js";import{Eb as C,Gb as N,Jb as g,Mb as v,Nb as D,Ob as n,Pb as i,Qb as j,Rb as O,Sb as M,Ub as f,Yb as p,Zb as l,a as k,eb as d,gc as R,hc as a,ic as h,jb as T,jc as y,lc as b,mc as w,nc as S,oa as s,pa as _,qb as V,qc as q,wb as u}from"./chunk-UYCZSUYP.js";var Ht=()=>[],E=(e,c)=>c.columnName;function zt(e,c){e&1&&(n(0,"div",6),j(1,"mat-spinner",9),n(2,"p"),a(3,"Loading SQL Objects..."),i()())}function Gt(e,c){e&1&&(n(0,"th",22),a(1,"Display Name"),i())}function Ut(e,c){if(e&1&&(n(0,"td",23)(1,"div",24)(2,"mat-icon"),a(3,"table_chart"),i(),n(4,"span"),a(5),i()()()),e&2){let t=c.$implicit;d(5),h(t.displayName)}}function Xt(e,c){e&1&&(n(0,"th",22),a(1,"Table Name"),i())}function Kt(e,c){if(e&1&&(n(0,"td",23)(1,"code"),a(2),i()()),e&2){let t=c.$implicit;d(2),y("sql_data_",t.tableName,"")}}function Yt(e,c){e&1&&(n(0,"th",22),a(1,"Columns"),i())}function Jt(e,c){if(e&1&&(n(0,"mat-chip"),a(1),i()),e&2){let t=c.$implicit;d(),h(t.displayName)}}function Zt(e,c){if(e&1&&(n(0,"mat-chip"),a(1),i()),e&2){let t=l().$implicit;d(),y("+",t.columns.length-3," more")}}function te(e,c){if(e&1&&(n(0,"td",23)(1,"mat-chip-set"),v(2,Jt,2,1,"mat-chip",null,E),u(4,Zt,2,1,"mat-chip"),i()()),e&2){let t=c.$implicit;d(2),D(t.columns==null?null:t.columns.slice(0,3)),d(2),g((t.columns==null?null:t.columns.length)>3?4:-1)}}function ee(e,c){e&1&&(n(0,"th",22),a(1,"Options Config"),i())}function ne(e,c){if(e&1&&(n(0,"span",25),a(1," Value: "),n(2,"strong"),a(3),i(),a(4,", Label: "),n(5,"strong"),a(6),i()()),e&2){let t=l().$implicit;d(3),h(t.valueColumn),d(3),h(t.labelColumn)}}function ie(e,c){e&1&&(n(0,"span",26),a(1,"Not configured"),i())}function oe(e,c){if(e&1&&(n(0,"td",23),u(1,ne,7,2,"span",25)(2,ie,2,0,"span",26),i()),e&2){let t=c.$implicit;d(),g(t.valueColumn&&t.labelColumn?1:2)}}function ae(e,c){e&1&&(n(0,"th",22),a(1,"Status"),i())}function le(e,c){if(e&1&&(n(0,"td",23)(1,"span",27),a(2),i()()),e&2){let t=c.$implicit;d(),N("active",t.isActive)("inactive",!t.isActive),d(),y(" ",t.isActive?"Active":"Inactive"," ")}}function re(e,c){e&1&&(n(0,"th",22),a(1,"Actions"),i())}function ce(e,c){if(e&1){let t=f();n(0,"button",29),p("click",function(){s(t);let o=l().$implicit,m=l(2);return _(m.deactivate(o))}),n(1,"mat-icon"),a(2,"visibility_off"),i(),n(3,"span"),a(4,"Deactivate"),i()()}}function me(e,c){if(e&1){let t=f();n(0,"button",29),p("click",function(){s(t);let o=l().$implicit,m=l(2);return _(m.activate(o))}),n(1,"mat-icon"),a(2,"visibility"),i(),n(3,"span"),a(4,"Activate"),i()()}}function de(e,c){if(e&1){let t=f();n(0,"td",23)(1,"button",28)(2,"mat-icon"),a(3,"more_vert"),i()(),n(4,"mat-menu",null,0)(6,"button",29),p("click",function(){let o=s(t).$implicit,m=l(2);return _(m.openDataManager(o))}),n(7,"mat-icon"),a(8,"table_rows"),i(),n(9,"span"),a(10,"Manage Data"),i()(),n(11,"button",29),p("click",function(){let o=s(t).$implicit,m=l(2);return _(m.openEditDialog(o))}),n(12,"mat-icon"),a(13,"edit"),i(),n(14,"span"),a(15,"Edit"),i()(),j(16,"mat-divider"),u(17,ce,5,0,"button",30)(18,me,5,0,"button",30),n(19,"button",31),p("click",function(){let o=s(t).$implicit,m=l(2);return _(m.confirmDelete(o))}),n(20,"mat-icon",32),a(21,"delete"),i(),n(22,"span"),a(23,"Delete"),i()()()()}if(e&2){let t=c.$implicit,r=R(5);d(),C("matMenuTriggerFor",r),d(16),g(t.isActive?17:18),d(2),C("disabled",t.isSystem)}}function se(e,c){e&1&&j(0,"tr",33)}function _e(e,c){e&1&&j(0,"tr",34)}function pe(e,c){if(e&1){let t=f();n(0,"div",21)(1,"mat-icon"),a(2,"storage"),i(),n(3,"h3"),a(4,"No SQL Objects"),i(),n(5,"p"),a(6,"Create your first SQL Object to use as dropdown options in your workflows."),i(),n(7,"button",5),p("click",function(){s(t);let o=l(2);return _(o.openCreateDialog())}),n(8,"mat-icon"),a(9,"add"),i(),a(10," Create SQL Object "),i()()}}function ue(e,c){if(e&1&&(n(0,"mat-card",7)(1,"mat-card-content")(2,"table",10),O(3,11),u(4,Gt,2,0,"th",12)(5,Ut,6,1,"td",13),M(),O(6,14),u(7,Xt,2,0,"th",12)(8,Kt,3,1,"td",13),M(),O(9,15),u(10,Yt,2,0,"th",12)(11,te,5,1,"td",13),M(),O(12,16),u(13,ee,2,0,"th",12)(14,oe,3,1,"td",13),M(),O(15,17),u(16,ae,2,0,"th",12)(17,le,3,5,"td",13),M(),O(18,18),u(19,re,2,0,"th",12)(20,de,24,3,"td",13),M(),u(21,se,1,0,"tr",19)(22,_e,1,0,"tr",20),i(),u(23,pe,11,0,"div",21),i()()),e&2){let t=l();d(2),C("dataSource",t.sqlObjects),d(19),C("matHeaderRowDef",t.displayedColumns),d(),C("matRowDefColumns",t.displayedColumns),d(),g(t.sqlObjects.length===0?23:-1)}}function Ce(e,c){if(e&1&&(n(0,"mat-option",49),a(1),i()),e&2){let t=c.$implicit;C("value",t.columnName),d(),h(t.displayName)}}function fe(e,c){if(e&1&&(n(0,"mat-option",49),a(1),i()),e&2){let t=c.$implicit;C("value",t.columnName),d(),h(t.displayName)}}function xe(e,c){if(e&1){let t=f();n(0,"mat-form-field",73)(1,"mat-label"),a(2,"Length"),i(),n(3,"input",75),S("ngModelChange",function(o){s(t);let m=l().$implicit;return w(m.columnLength,o)||(m.columnLength=o),_(o)}),i()()}if(e&2){let t=l().$implicit;d(3),b("ngModel",t.columnLength)}}function ge(e,c){if(e&1){let t=f();n(0,"div",54)(1,"mat-icon",60),a(2,"drag_indicator"),i(),n(3,"mat-form-field",61)(4,"mat-label"),a(5,"Column Name"),i(),n(6,"input",62),S("ngModelChange",function(o){let m=s(t).$implicit;return w(m.columnName,o)||(m.columnName=o),_(o)}),p("input",function(){let o=s(t).$implicit,m=l(2);return _(m.sanitizeColumnName(o))}),i()(),n(7,"mat-form-field",61)(8,"mat-label"),a(9,"Display Name"),i(),n(10,"input",63),S("ngModelChange",function(o){let m=s(t).$implicit;return w(m.displayName,o)||(m.displayName=o),_(o)}),i()(),n(11,"mat-form-field",64)(12,"mat-label"),a(13,"Type"),i(),n(14,"mat-select",48),S("ngModelChange",function(o){let m=s(t).$implicit;return w(m.dataType,o)||(m.dataType=o),_(o)}),n(15,"mat-option",65),a(16,"Text"),i(),n(17,"mat-option",66),a(18,"Long Text"),i(),n(19,"mat-option",67),a(20,"Integer"),i(),n(21,"mat-option",68),a(22,"Big Integer"),i(),n(23,"mat-option",69),a(24,"Decimal"),i(),n(25,"mat-option",70),a(26,"Boolean"),i(),n(27,"mat-option",71),a(28,"Date"),i(),n(29,"mat-option",72),a(30,"Timestamp"),i()()(),u(31,xe,4,1,"mat-form-field",73),n(32,"mat-checkbox",48),S("ngModelChange",function(o){let m=s(t).$implicit;return w(m.isNullable,o)||(m.isNullable=o),_(o)}),a(33,"Nullable"),i(),n(34,"button",74),p("click",function(){let o=s(t).$index,m=l(2);return _(m.removeColumn(o))}),n(35,"mat-icon"),a(36,"delete"),i()()()}if(e&2){let t=c.$implicit;d(6),b("ngModel",t.columnName),d(4),b("ngModel",t.displayName),d(4),b("ngModel",t.dataType),d(17),g(t.dataType==="VARCHAR"?31:-1),d(),b("ngModel",t.isNullable)}}function be(e,c){e&1&&(n(0,"div",55)(1,"mat-icon"),a(2,"view_column"),i(),n(3,"p"),a(4,"No columns defined. Add at least one column."),i()())}function we(e,c){e&1&&j(0,"mat-spinner",59)}function Se(e,c){if(e&1&&a(0),e&2){let t=l(2);y(" ",t.editingObject?"Save Changes":"Create"," ")}}function he(e,c){if(e&1){let t=f();n(0,"div",35),p("click",function(){s(t);let o=l();return _(o.closeDialog())}),n(1,"div",36),p("click",function(o){return s(t),_(o.stopPropagation())}),n(2,"div",37)(3,"h2"),a(4),i(),n(5,"button",38),p("click",function(){s(t);let o=l();return _(o.closeDialog())}),n(6,"mat-icon"),a(7,"close"),i()()(),n(8,"div",39)(9,"mat-tab-group")(10,"mat-tab",40)(11,"div",41)(12,"mat-form-field",42)(13,"mat-label"),a(14,"Display Name"),i(),n(15,"input",43),S("ngModelChange",function(o){s(t);let m=l();return w(m.formData.displayName,o)||(m.formData.displayName=o),_(o)}),i(),n(16,"mat-hint"),a(17,"User-friendly name for this data table"),i()(),n(18,"mat-form-field",42)(19,"mat-label"),a(20,"Table Name"),i(),n(21,"input",44),S("ngModelChange",function(o){s(t);let m=l();return w(m.formData.tableName,o)||(m.formData.tableName=o),_(o)}),p("input",function(){s(t);let o=l();return _(o.sanitizeTableName())}),i(),n(22,"mat-hint"),a(23,"Database table name (lowercase, no spaces). Prefixed with sql_data_"),i()(),n(24,"mat-form-field",42)(25,"mat-label"),a(26,"Description"),i(),n(27,"textarea",45),S("ngModelChange",function(o){s(t);let m=l();return w(m.formData.description,o)||(m.formData.description=o),_(o)}),i()(),n(28,"div",46)(29,"mat-form-field",47)(30,"mat-label"),a(31,"Value Column"),i(),n(32,"mat-select",48),S("ngModelChange",function(o){s(t);let m=l();return w(m.formData.valueColumn,o)||(m.formData.valueColumn=o),_(o)}),n(33,"mat-option",49),a(34,"-- Select --"),i(),v(35,Ce,2,2,"mat-option",49,E),i(),n(37,"mat-hint"),a(38,"Column to use as option value"),i()(),n(39,"mat-form-field",47)(40,"mat-label"),a(41,"Label Column"),i(),n(42,"mat-select",48),S("ngModelChange",function(o){s(t);let m=l();return w(m.formData.labelColumn,o)||(m.formData.labelColumn=o),_(o)}),n(43,"mat-option",49),a(44,"-- Select --"),i(),v(45,fe,2,2,"mat-option",49,E),i(),n(47,"mat-hint"),a(48,"Column to display as option label"),i()()()()(),n(49,"mat-tab",50)(50,"div",41)(51,"div",51)(52,"h3"),a(53,"Define Columns"),i(),n(54,"button",52),p("click",function(){s(t);let o=l();return _(o.addColumn())}),n(55,"mat-icon"),a(56,"add"),i(),a(57," Add Column "),i()(),n(58,"div",53),p("cdkDropListDropped",function(o){s(t);let m=l();return _(m.dropColumn(o))}),v(59,ge,37,5,"div",54,E),i(),u(61,be,5,0,"div",55),i()()()(),n(62,"div",56)(63,"button",57),p("click",function(){s(t);let o=l();return _(o.closeDialog())}),a(64,"Cancel"),i(),n(65,"button",58),p("click",function(){s(t);let o=l();return _(o.save())}),u(66,we,1,0,"mat-spinner",59)(67,Se,1,1),i()()()()}if(e&2){let t=l();d(4),h(t.editingObject?"Edit SQL Object":"Create SQL Object"),d(11),b("ngModel",t.formData.displayName),d(6),b("ngModel",t.formData.tableName),C("disabled",!!t.editingObject),d(6),b("ngModel",t.formData.description),d(5),b("ngModel",t.formData.valueColumn),d(),C("value",null),d(2),D(t.formData.columns),d(7),b("ngModel",t.formData.labelColumn),d(),C("value",null),d(2),D(t.formData.columns),d(4),C("disabled",!!t.editingObject),d(10),D(t.formData.columns),d(2),g(!t.formData.columns||t.formData.columns.length===0?61:-1),d(4),C("disabled",t.saving),d(),g(t.saving?66:67)}}function Oe(e,c){e&1&&(n(0,"div",6),j(1,"mat-spinner",80),n(2,"p"),a(3,"Loading data..."),i()())}function Me(e,c){e&1&&(n(0,"th",22),a(1,"ID"),i())}function je(e,c){if(e&1&&(n(0,"td",23),a(1),i()),e&2){let t=c.$implicit;d(),h(t.id)}}function ye(e,c){if(e&1&&(n(0,"th",22),a(1),i()),e&2){let t=l().$implicit;d(),h(t.displayName)}}function ve(e,c){if(e&1){let t=f();n(0,"input",87),S("ngModelChange",function(o){s(t);let m=l(2).$implicit,x=l(3);return w(x.editingRowData[m.columnName],o)||(x.editingRowData[m.columnName]=o),_(o)}),i()}if(e&2){let t=l(2).$implicit,r=l(3);b("ngModel",r.editingRowData[t.columnName])}}function De(e,c){if(e&1&&a(0),e&2){let t=l().$implicit,r=l().$implicit;y(" ",t[r.columnName]," ")}}function Ee(e,c){if(e&1&&(n(0,"td",23),u(1,ve,1,1,"input",86)(2,De,1,1),i()),e&2){let t=c.$implicit,r=l(4);d(),g(r.editingRowId===t.id?1:2)}}function Te(e,c){if(e&1&&(O(0,84),u(1,ye,2,1,"th",12)(2,Ee,3,1,"td",13),M()),e&2){let t=c.$implicit;C("matColumnDef",t.columnName)}}function qe(e,c){e&1&&(n(0,"th",22),a(1,"Actions"),i())}function ke(e,c){if(e&1){let t=f();n(0,"button",88),p("click",function(){s(t);let o=l(4);return _(o.saveRow())}),n(1,"mat-icon"),a(2,"check"),i()(),n(3,"button",89),p("click",function(){s(t);let o=l(4);return _(o.cancelEditRow())}),n(4,"mat-icon"),a(5,"close"),i()()}}function Ve(e,c){if(e&1){let t=f();n(0,"button",90),p("click",function(){s(t);let o=l().$implicit,m=l(3);return _(m.editRow(o))}),n(1,"mat-icon"),a(2,"edit"),i()(),n(3,"button",91),p("click",function(){s(t);let o=l().$implicit,m=l(3);return _(m.deleteRow(o))}),n(4,"mat-icon"),a(5,"delete"),i()()}}function Ne(e,c){if(e&1&&(n(0,"td",23),u(1,ke,6,0)(2,Ve,6,0),i()),e&2){let t=c.$implicit,r=l(3);d(),g(r.editingRowId===t.id?1:2)}}function Re(e,c){e&1&&j(0,"tr",33)}function Pe(e,c){e&1&&j(0,"tr",34)}function Ie(e,c){e&1&&(n(0,"div",85)(1,"mat-icon"),a(2,"inbox"),i(),n(3,"p"),a(4,"No data in this table. Add some rows to get started."),i()())}function Fe(e,c){if(e&1&&(n(0,"div",81)(1,"table",82),O(2,83),u(3,Me,2,0,"th",12)(4,je,2,1,"td",13),M(),v(5,Te,3,1,"ng-container",84,E),O(7,18),u(8,qe,2,0,"th",12)(9,Ne,3,1,"td",13),M(),u(10,Re,1,0,"tr",19)(11,Pe,1,0,"tr",20),i()(),u(12,Ie,5,0,"div",85)),e&2){let t=l(2);d(),C("dataSource",t.tableData),d(4),D((t.selectedObject==null?null:t.selectedObject.columns)||q(4,Ht)),d(5),C("matHeaderRowDef",t.dataColumns),d(),C("matRowDefColumns",t.dataColumns),d(),g(t.tableData.length===0?12:-1)}}function Le(e,c){if(e&1){let t=f();n(0,"textarea",63),S("ngModelChange",function(o){s(t);let m=l().$implicit,x=l(3);return w(x.newRowData[m.columnName],o)||(x.newRowData[m.columnName]=o),_(o)}),i()}if(e&2){let t=l().$implicit,r=l(3);b("ngModel",r.newRowData[t.columnName])}}function Be(e,c){if(e&1){let t=f();n(0,"mat-select",48),S("ngModelChange",function(o){s(t);let m=l().$implicit,x=l(3);return w(x.newRowData[m.columnName],o)||(x.newRowData[m.columnName]=o),_(o)}),n(1,"mat-option",49),a(2,"Yes"),i(),n(3,"mat-option",49),a(4,"No"),i()()}if(e&2){let t=l().$implicit,r=l(3);b("ngModel",r.newRowData[t.columnName]),d(),C("value",!0),d(2),C("value",!1)}}function We(e,c){if(e&1){let t=f();n(0,"input",75),S("ngModelChange",function(o){s(t);let m=l().$implicit,x=l(3);return w(x.newRowData[m.columnName],o)||(x.newRowData[m.columnName]=o),_(o)}),i()}if(e&2){let t=l().$implicit,r=l(3);b("ngModel",r.newRowData[t.columnName])}}function Ae(e,c){if(e&1){let t=f();n(0,"input",98),S("ngModelChange",function(o){s(t);let m=l().$implicit,x=l(3);return w(x.newRowData[m.columnName],o)||(x.newRowData[m.columnName]=o),_(o)}),i()}if(e&2){let t=l().$implicit,r=l(3);b("ngModel",r.newRowData[t.columnName])}}function $e(e,c){if(e&1){let t=f();n(0,"input",63),S("ngModelChange",function(o){s(t);let m=l().$implicit,x=l(3);return w(x.newRowData[m.columnName],o)||(x.newRowData[m.columnName]=o),_(o)}),i()}if(e&2){let t=l().$implicit,r=l(3);b("ngModel",r.newRowData[t.columnName])}}function Qe(e,c){if(e&1&&(n(0,"mat-form-field",47)(1,"mat-label"),a(2),i(),u(3,Le,1,1,"textarea",94)(4,Be,5,3,"mat-select",95)(5,We,1,1,"input",96)(6,Ae,1,1,"input",97)(7,$e,1,1,"input",94),i()),e&2){let t=c.$implicit;d(2),h(t.displayName),d(),g(t.dataType==="TEXT"?3:t.dataType==="BOOLEAN"?4:t.dataType==="INTEGER"||t.dataType==="BIGINT"||t.dataType==="DECIMAL"?5:t.dataType==="DATE"?6:7)}}function He(e,c){if(e&1){let t=f();n(0,"div",79)(1,"h4"),a(2),i(),n(3,"div",92),v(4,Qe,8,2,"mat-form-field",47,E),i(),n(6,"div",93)(7,"button",57),p("click",function(){s(t);let o=l(2);return _(o.cancelRowForm())}),a(8,"Cancel"),i(),n(9,"button",5),p("click",function(){s(t);let o=l(2);return _(o.saveNewRow())}),a(10),i()()()}if(e&2){let t=l(2);d(2),h(t.editingRowId?"Edit Row":"Add New Row"),d(2),D((t.selectedObject==null?null:t.selectedObject.columns)||q(2,Ht)),d(6),y(" ",t.editingRowId?"Update":"Add"," ")}}function ze(e,c){if(e&1){let t=f();n(0,"div",35),p("click",function(){s(t);let o=l();return _(o.closeDataManager())}),n(1,"div",76),p("click",function(o){return s(t),_(o.stopPropagation())}),n(2,"div",37)(3,"h2")(4,"mat-icon"),a(5,"table_rows"),i(),a(6),i(),n(7,"button",38),p("click",function(){s(t);let o=l();return _(o.closeDataManager())}),n(8,"mat-icon"),a(9,"close"),i()()(),n(10,"div",39)(11,"div",77)(12,"button",5),p("click",function(){s(t);let o=l();return _(o.addRow())}),n(13,"mat-icon"),a(14,"add"),i(),a(15," Add Row "),i(),n(16,"button",78),p("click",function(){s(t);let o=l();return _(o.refreshData())}),n(17,"mat-icon"),a(18,"refresh"),i(),a(19," Refresh "),i()(),u(20,Oe,4,0,"div",6)(21,Fe,13,5)(22,He,11,3,"div",79),i()()()}if(e&2){let t=l();d(6),y(" Manage Data: ",t.selectedObject==null?null:t.selectedObject.displayName," "),d(14),g(t.loadingData?20:21),d(2),g(t.showRowForm?22:-1)}}var Vn=(()=>{class e{sqlObjectService;snackBar;sqlObjects=[];loading=!1;saving=!1;displayedColumns=["displayName","tableName","columns","optionsConfig","status","actions"];showDialog=!1;editingObject=null;formData=this.getEmptyForm();showDataManager=!1;selectedObject=null;tableData=[];dataColumns=[];loadingData=!1;showRowForm=!1;newRowData={};editingRowId=null;editingRowData={};constructor(t,r){this.sqlObjectService=t,this.snackBar=r}ngOnInit(){this.loadSqlObjects()}loadSqlObjects(){this.loading=!0,this.sqlObjectService.getAllSqlObjects().subscribe({next:t=>{this.sqlObjects=t,this.loading=!1},error:t=>{this.snackBar.open("Failed to load SQL Objects","Close",{duration:3e3}),this.loading=!1}})}getEmptyForm(){return{displayName:"",tableName:"",description:"",valueColumn:"",labelColumn:"",columns:[]}}openCreateDialog(){this.editingObject=null,this.formData=this.getEmptyForm(),this.showDialog=!0}openEditDialog(t){this.editingObject=t,this.formData={displayName:t.displayName,tableName:t.tableName,description:t.description,valueColumn:t.valueColumn,labelColumn:t.labelColumn,columns:[...t.columns||[]]},this.showDialog=!0}closeDialog(){this.showDialog=!1,this.editingObject=null}sanitizeTableName(){this.formData.tableName&&(this.formData.tableName=this.formData.tableName.toLowerCase().replace(/[^a-z0-9_]/g,"_").replace(/^[0-9]/,"_$&").replace(/__+/g,"_"))}sanitizeColumnName(t){t.columnName&&(t.columnName=t.columnName.toLowerCase().replace(/[^a-z0-9_]/g,"_").replace(/^[0-9]/,"_$&").replace(/__+/g,"_"))}addColumn(){this.formData.columns||(this.formData.columns=[]),this.formData.columns.push({columnName:"",displayName:"",dataType:qt.VARCHAR,columnLength:255,isNullable:!0,isPrimaryKey:!1,displayOrder:this.formData.columns.length})}removeColumn(t){this.formData.columns?.splice(t,1)}dropColumn(t){this.formData.columns&&(Lt(this.formData.columns,t.previousIndex,t.currentIndex),this.formData.columns.forEach((r,o)=>r.displayOrder=o))}save(){if(!this.formData.displayName||!this.formData.tableName){this.snackBar.open("Please fill in required fields","Close",{duration:3e3});return}if(!this.editingObject&&(!this.formData.columns||this.formData.columns.length===0)){this.snackBar.open("Please add at least one column","Close",{duration:3e3});return}this.saving=!0,this.editingObject?this.sqlObjectService.updateSqlObject(this.editingObject.id,this.formData).subscribe({next:()=>{this.snackBar.open("SQL Object updated","Close",{duration:3e3}),this.closeDialog(),this.loadSqlObjects(),this.saving=!1},error:t=>{this.snackBar.open("Failed to update SQL Object","Close",{duration:3e3}),this.saving=!1}}):this.sqlObjectService.createSqlObject(this.formData).subscribe({next:()=>{this.snackBar.open("SQL Object created","Close",{duration:3e3}),this.closeDialog(),this.loadSqlObjects(),this.saving=!1},error:t=>{this.snackBar.open(t.error?.message||"Failed to create SQL Object","Close",{duration:3e3}),this.saving=!1}})}activate(t){this.sqlObjectService.activateSqlObject(t.id).subscribe({next:()=>{this.snackBar.open("SQL Object activated","Close",{duration:3e3}),this.loadSqlObjects()},error:()=>{this.snackBar.open("Failed to activate","Close",{duration:3e3})}})}deactivate(t){this.sqlObjectService.deactivateSqlObject(t.id).subscribe({next:()=>{this.snackBar.open("SQL Object deactivated","Close",{duration:3e3}),this.loadSqlObjects()},error:()=>{this.snackBar.open("Failed to deactivate","Close",{duration:3e3})}})}confirmDelete(t){confirm(`Are you sure you want to delete "${t.displayName}"? This will also delete all data in the table.`)&&this.sqlObjectService.deleteSqlObject(t.id).subscribe({next:()=>{this.snackBar.open("SQL Object deleted","Close",{duration:3e3}),this.loadSqlObjects()},error:()=>{this.snackBar.open("Failed to delete","Close",{duration:3e3})}})}openDataManager(t){this.selectedObject=t,this.showDataManager=!0,this.dataColumns=["id",...t.columns?.map(r=>r.columnName)||[],"actions"],this.refreshData()}closeDataManager(){this.showDataManager=!1,this.selectedObject=null,this.tableData=[],this.showRowForm=!1,this.editingRowId=null}refreshData(){this.selectedObject&&(this.loadingData=!0,this.sqlObjectService.getTableData(this.selectedObject.id).subscribe({next:t=>{this.tableData=t,this.loadingData=!1},error:()=>{this.snackBar.open("Failed to load data","Close",{duration:3e3}),this.loadingData=!1}}))}addRow(){this.showRowForm=!0,this.editingRowId=null,this.newRowData={}}editRow(t){this.editingRowId=t.id,this.editingRowData=k({},t)}cancelEditRow(){this.editingRowId=null,this.editingRowData={}}saveRow(){!this.selectedObject||!this.editingRowId||this.sqlObjectService.updateTableRow(this.selectedObject.id,this.editingRowId,this.editingRowData).subscribe({next:()=>{this.snackBar.open("Row updated","Close",{duration:3e3}),this.editingRowId=null,this.refreshData()},error:()=>{this.snackBar.open("Failed to update row","Close",{duration:3e3})}})}cancelRowForm(){this.showRowForm=!1,this.newRowData={}}saveNewRow(){this.selectedObject&&this.sqlObjectService.addTableRow(this.selectedObject.id,this.newRowData).subscribe({next:()=>{this.snackBar.open("Row added","Close",{duration:3e3}),this.showRowForm=!1,this.newRowData={},this.refreshData()},error:()=>{this.snackBar.open("Failed to add row","Close",{duration:3e3})}})}deleteRow(t){this.selectedObject&&confirm("Are you sure you want to delete this row?")&&this.sqlObjectService.deleteTableRow(this.selectedObject.id,t.id).subscribe({next:()=>{this.snackBar.open("Row deleted","Close",{duration:3e3}),this.refreshData()},error:()=>{this.snackBar.open("Failed to delete row","Close",{duration:3e3})}})}static \u0275fac=function(r){return new(r||e)(T(Qt),T(ct))};static \u0275cmp=V({type:e,selectors:[["app-sql-objects"]],decls:17,vars:3,consts:[["menu","matMenu"],[1,"sql-objects-container"],[1,"header"],[1,"header-content"],[1,"subtitle"],["mat-raised-button","","color","primary",3,"click"],[1,"loading"],[1,"table-card"],[1,"dialog-overlay"],["diameter","40"],["mat-table","",1,"full-width",3,"dataSource"],["matColumnDef","displayName"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","tableName"],["matColumnDef","columns"],["matColumnDef","optionsConfig"],["matColumnDef","status"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[1,"empty-state"],["mat-header-cell",""],["mat-cell",""],[1,"name-cell"],[1,"config-info"],[1,"not-configured"],[1,"status-badge"],["mat-icon-button","","matTooltip","More actions",3,"matMenuTriggerFor"],["mat-menu-item","",3,"click"],["mat-menu-item",""],["mat-menu-item","",3,"click","disabled"],["color","warn"],["mat-header-row",""],["mat-row",""],[1,"dialog-overlay",3,"click"],[1,"dialog-container",3,"click"],[1,"dialog-header"],["mat-icon-button","",3,"click"],[1,"dialog-content"],["label","Basic Info"],[1,"tab-content"],["appearance","outline",1,"full-width"],["matInput","","placeholder","e.g., Countries",3,"ngModelChange","ngModel"],["matInput","","placeholder","e.g., countries",3,"ngModelChange","input","ngModel","disabled"],["matInput","","rows","2",3,"ngModelChange","ngModel"],[1,"form-row"],["appearance","outline"],[3,"ngModelChange","ngModel"],[3,"value"],["label","Columns",3,"disabled"],[1,"columns-header"],["mat-stroked-button","","color","primary",3,"click"],["cdkDropList","",1,"columns-list",3,"cdkDropListDropped"],["cdkDrag","",1,"column-item"],[1,"empty-columns"],[1,"dialog-actions"],["mat-button","",3,"click"],["mat-raised-button","","color","primary",3,"click","disabled"],["diameter","20"],["cdkDragHandle","",1,"drag-handle"],["appearance","outline",1,"col-field"],["matInput","",3,"ngModelChange","input","ngModel"],["matInput","",3,"ngModelChange","ngModel"],["appearance","outline",1,"col-field-small"],["value","VARCHAR"],["value","TEXT"],["value","INTEGER"],["value","BIGINT"],["value","DECIMAL"],["value","BOOLEAN"],["value","DATE"],["value","TIMESTAMP"],["appearance","outline",1,"col-field-tiny"],["mat-icon-button","","color","warn","matTooltip","Remove column",3,"click"],["matInput","","type","number",3,"ngModelChange","ngModel"],[1,"dialog-container","data-manager",3,"click"],[1,"data-toolbar"],["mat-stroked-button","",3,"click"],[1,"row-form"],["diameter","30"],[1,"data-table-container"],["mat-table","",1,"full-width","data-table",3,"dataSource"],["matColumnDef","id"],[3,"matColumnDef"],[1,"empty-data"],["matInput","",1,"inline-edit",3,"ngModel"],["matInput","",1,"inline-edit",3,"ngModelChange","ngModel"],["mat-icon-button","","color","primary","matTooltip","Save",3,"click"],["mat-icon-button","","matTooltip","Cancel",3,"click"],["mat-icon-button","","matTooltip","Edit",3,"click"],["mat-icon-button","","color","warn","matTooltip","Delete",3,"click"],[1,"row-fields"],[1,"row-form-actions"],["matInput","",3,"ngModel"],[3,"ngModel"],["matInput","","type","number",3,"ngModel"],["matInput","","type","date",3,"ngModel"],["matInput","","type","date",3,"ngModelChange","ngModel"]],template:function(r,o){r&1&&(n(0,"div",1)(1,"div",2)(2,"div",3)(3,"h1")(4,"mat-icon"),a(5,"storage"),i(),a(6," SQL Objects "),i(),n(7,"p",4),a(8,"Manage custom data tables for dropdown options"),i()(),n(9,"button",5),p("click",function(){return o.openCreateDialog()}),n(10,"mat-icon"),a(11,"add"),i(),a(12," New SQL Object "),i()(),u(13,zt,4,0,"div",6)(14,ue,24,4,"mat-card",7)(15,he,68,13,"div",8)(16,ze,23,3,"div",8),i()),r&2&&(d(13),g(o.loading?13:14),d(2),g(o.showDialog?15:-1),d(),g(o.showDataManager?16:-1))},dependencies:[P,A,F,W,L,B,$,Y,X,K,Tt,wt,ht,yt,Ot,St,vt,Mt,jt,Dt,Et,U,G,z,H,Q,dt,et,tt,J,Z,it,nt,rt,lt,I,Ft,It,bt,xt,gt,Pt,Nt,Rt,Vt,kt,mt,at,ot,ft,ut,pt,Ct,_t,st,$t,At,Wt,Bt],styles:[".sql-objects-container[_ngcontent-%COMP%]{padding:1.5rem;max-width:1400px;margin:0 auto}.header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:1.5rem}.header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0;display:flex;align-items:center;gap:.5rem}.subtitle[_ngcontent-%COMP%]{margin:.25rem 0 0;color:#666}.loading[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;padding:3rem;color:#666}.table-card[_ngcontent-%COMP%]{overflow:hidden}table[_ngcontent-%COMP%]{width:100%}.name-cell[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}code[_ngcontent-%COMP%]{background:#f5f5f5;padding:.25rem .5rem;border-radius:4px;font-size:.85em}.config-info[_ngcontent-%COMP%]{font-size:.85em;color:#666}.not-configured[_ngcontent-%COMP%]{color:#999;font-style:italic}.status-badge[_ngcontent-%COMP%]{padding:.25rem .75rem;border-radius:12px;font-size:.75rem;font-weight:500}.status-badge.active[_ngcontent-%COMP%]{background:#e8f5e9;color:#2e7d32}.status-badge.inactive[_ngcontent-%COMP%]{background:#fafafa;color:#999}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:4rem 2rem;color:#666}.empty-state[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:64px;width:64px;height:64px;color:#ccc}.empty-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:1rem 0 .5rem}.dialog-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#00000080;display:flex;align-items:center;justify-content:center;z-index:1000}.dialog-container[_ngcontent-%COMP%]{background:#fff;border-radius:8px;width:90%;max-width:800px;max-height:90vh;display:flex;flex-direction:column}.dialog-container.data-manager[_ngcontent-%COMP%]{max-width:1000px}.dialog-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:1rem 1.5rem;border-bottom:1px solid #eee}.dialog-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;display:flex;align-items:center;gap:.5rem}.dialog-content[_ngcontent-%COMP%]{padding:1.5rem;overflow-y:auto;flex:1}.dialog-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:.5rem;padding:1rem 1.5rem;border-top:1px solid #eee}.tab-content[_ngcontent-%COMP%]{padding:1.5rem 0}.full-width[_ngcontent-%COMP%]{width:100%}.form-row[_ngcontent-%COMP%]{display:flex;gap:1rem}.form-row[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{flex:1}.columns-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem}.columns-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0}.column-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding:.5rem;background:#fafafa;border-radius:4px;margin-bottom:.5rem}.drag-handle[_ngcontent-%COMP%]{cursor:move;color:#999}.col-field[_ngcontent-%COMP%]{flex:1}.col-field-small[_ngcontent-%COMP%]{width:120px}.col-field-tiny[_ngcontent-%COMP%]{width:80px}.empty-columns[_ngcontent-%COMP%]{text-align:center;padding:2rem;color:#999}.empty-columns[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:48px;width:48px;height:48px}.data-toolbar[_ngcontent-%COMP%]{display:flex;gap:.5rem;margin-bottom:1rem}.data-table-container[_ngcontent-%COMP%]{overflow-x:auto}.data-table[_ngcontent-%COMP%]{min-width:600px}.inline-edit[_ngcontent-%COMP%]{width:100%;border:1px solid #1976d2;border-radius:4px;padding:.25rem .5rem}.empty-data[_ngcontent-%COMP%]{text-align:center;padding:2rem;color:#999}.row-form[_ngcontent-%COMP%]{margin-top:1.5rem;padding:1rem;background:#f5f5f5;border-radius:8px}.row-form[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 1rem}.row-fields[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:1rem}.row-form-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:.5rem;margin-top:1rem}"]})}return e})();export{Vn as SqlObjectsComponent};
