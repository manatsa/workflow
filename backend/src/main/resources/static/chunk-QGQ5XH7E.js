import{a as dt,b as ct}from"./chunk-L6VEMCPS.js";import{a as st,b as lt,c as mt}from"./chunk-IGTQ3GOP.js";import"./chunk-MS4AQ6UA.js";import{a as rt,b as at}from"./chunk-B7S7HKPH.js";import{a as N}from"./chunk-V6VZ6TGW.js";import"./chunk-DVTP2NLI.js";import{c as V}from"./chunk-RP3FIGZU.js";import{a as ot}from"./chunk-Y46M7IGS.js";import{a as Z,b as tt}from"./chunk-D7R5IUPR.js";import{h as et}from"./chunk-5TLSQL4E.js";import"./chunk-22QFHSXK.js";import{a as X,b as Y}from"./chunk-UYHUY2FW.js";import"./chunk-KPLEND2O.js";import{a as nt,b as it}from"./chunk-XQHIDIE5.js";import"./chunk-LETYTNCA.js";import"./chunk-M3GLKEYP.js";import{a as J,c as K,d as Q}from"./chunk-ZK2UDSKG.js";import{b as q,i as H}from"./chunk-FHBRY4FZ.js";import{d as B,h as W,k as I,m as A,s as L}from"./chunk-JITRQZ7S.js";import{a as $,c as R,h as U}from"./chunk-LB6LFADN.js";import"./chunk-Q5RCCGFX.js";import"./chunk-W4XF3NOO.js";import{m as k,qa as j,ra as G,ta as z,va as D}from"./chunk-LBWRLA47.js";import{Ab as c,Fb as h,Hb as E,Ib as v,Jb as F,Kb as r,Lb as o,Mb as T,Qb as g,Ub as w,Vb as m,bb as l,dc as d,ec as y,gb as O,hc as u,ic as C,jc as f,mc as x,na as _,nb as P,oa as p,tb as S}from"./chunk-5XIHPI6O.js";var b=()=>({standalone:!0}),_t=(e,s)=>s.category,pt=(e,s)=>s.key;function gt(e,s){e&1&&(r(0,"mat-card")(1,"mat-card-content",3),T(2,"mat-spinner",4),r(3,"p"),d(4,"Loading settings..."),o()()())}function ut(e,s){if(e&1){let t=g();r(0,"mat-card")(1,"mat-card-content",5)(2,"mat-icon"),d(3,"error_outline"),o(),r(4,"p"),d(5),o(),r(6,"button",6),w("click",function(){_(t);let n=m();return p(n.loadSettings())}),r(7,"mat-icon"),d(8,"refresh"),o(),d(9," Retry "),o()()()}if(e&2){let t=m();l(5),y(t.error)}}function Ct(e,s){e&1&&(r(0,"mat-card")(1,"mat-card-content",7)(2,"mat-icon"),d(3,"settings"),o(),r(4,"p"),d(5,"No settings found."),o(),r(6,"p",8),d(7,"Settings will be automatically created when the system initializes."),o()()())}function ft(e,s){e&1&&T(0,"mat-spinner",16)}function Mt(e,s){e&1&&(r(0,"mat-icon"),d(1,"send"),o())}function xt(e,s){if(e&1){let t=g();r(0,"div",12)(1,"mat-form-field",13)(2,"mat-label"),d(3,"Test Email Address"),o(),r(4,"input",14),f("ngModelChange",function(n){_(t);let a=m(3);return C(a.testEmailAddress,n)||(a.testEmailAddress=n),p(n)}),o()(),r(5,"button",15),w("click",function(){_(t);let n=m(3);return p(n.sendTestEmail())}),S(6,ft,1,0,"mat-spinner",16)(7,Mt,2,0,"mat-icon"),d(8," Send Test Email "),o()(),T(9,"mat-divider")}if(e&2){let t=m(3);l(4),u("ngModel",t.testEmailAddress),l(),c("disabled",t.sendingTestEmail||!t.testEmailAddress),l(),h(t.sendingTestEmail?6:7)}}function St(e,s){if(e&1&&(r(0,"span",21),d(1),o()),e&2){let t=m().$implicit;l(),y(t.description)}}function ht(e,s){if(e&1){let t=g();r(0,"mat-slide-toggle",26),w("change",function(n){_(t);let a=m().$implicit;return p(a.value=n.checked?"true":"false")}),o()}if(e&2){let t=m().$implicit;c("checked",t.value==="true")}}function yt(e,s){if(e&1){let t=g();r(0,"div",24)(1,"input",27),f("ngModelChange",function(n){_(t);let a=m().$implicit;return C(a.value,n)||(a.value=n),p(n)}),o(),r(2,"input",28),f("ngModelChange",function(n){_(t);let a=m().$implicit;return C(a.value,n)||(a.value=n),p(n)}),o()()}if(e&2){let t=m().$implicit;l(),u("ngModel",t.value),c("ngModelOptions",x(4,b)),l(),u("ngModel",t.value),c("ngModelOptions",x(5,b))}}function bt(e,s){if(e&1){let t=g();r(0,"mat-form-field",25)(1,"input",29),f("ngModelChange",function(n){_(t);let a=m().$implicit;return C(a.value,n)||(a.value=n),p(n)}),o()()}if(e&2){let t=m().$implicit;l(),u("ngModel",t.value),c("ngModelOptions",x(2,b))}}function vt(e,s){if(e&1){let t=g();r(0,"mat-form-field",25)(1,"input",30),f("ngModelChange",function(n){_(t);let a=m().$implicit;return C(a.value,n)||(a.value=n),p(n)}),o()()}if(e&2){let t=m().$implicit;l(),u("ngModel",t.value),c("ngModelOptions",x(2,b))}}function Ft(e,s){if(e&1&&(r(0,"mat-option",32),d(1),o()),e&2){let t=s.$implicit;c("value",t),l(),y(t)}}function wt(e,s){if(e&1){let t=g();r(0,"mat-form-field",25)(1,"mat-select",31),f("ngModelChange",function(n){_(t);let a=m().$implicit;return C(a.value,n)||(a.value=n),p(n)}),v(2,Ft,2,2,"mat-option",32,E),o()()}if(e&2){let t=m().$implicit,i=m(4);l(),u("ngModel",t.value),c("ngModelOptions",x(2,b)),l(),F(i.getSelectOptions(t))}}function Ot(e,s){if(e&1){let t=g();r(0,"mat-form-field",25)(1,"input",33),f("ngModelChange",function(n){_(t);let a=m().$implicit;return C(a.value,n)||(a.value=n),p(n)}),o()()}if(e&2){let t=m().$implicit;l(),u("ngModel",t.value),c("ngModelOptions",x(2,b))}}function Tt(e,s){if(e&1&&(r(0,"div",19)(1,"div",20)(2,"strong"),d(3),o(),S(4,St,2,1,"span",21),o(),r(5,"div",22),S(6,ht,1,1,"mat-slide-toggle",23)(7,yt,3,6,"div",24)(8,bt,2,3,"mat-form-field",25)(9,vt,2,3,"mat-form-field",25)(10,wt,4,3,"mat-form-field",25)(11,Ot,2,3,"mat-form-field",25),o()()),e&2){let t,i=s.$implicit;l(3),y(i.label||i.key),l(),h(i.description?4:-1),l(2),h((t=i.type)==="BOOLEAN"?6:t==="COLOR"?7:t==="NUMBER"?8:t==="PASSWORD"?9:t==="SELECT"?10:11)}}function Et(e,s){if(e&1&&(r(0,"div",11)(1,"h3",17),d(2),o(),r(3,"div",18),v(4,Tt,12,3,"div",19,pt),o()()),e&2){let t=s.$implicit;l(2),y(t.category),l(2),F(t.settings)}}function Pt(e,s){if(e&1&&(r(0,"mat-tab",9)(1,"div",10),S(2,xt,10,3),v(3,Et,6,1,"div",11,_t),o()()),e&2){let t=s.$implicit,i=m(2);c("label",t),l(2),h(t==="Mail Settings"?2:-1),l(),F(i.getGroupedSettingsForTab(t))}}function kt(e,s){if(e&1&&(r(0,"mat-card")(1,"mat-tab-group"),v(2,Pt,5,2,"mat-tab",9,E),o()()),e&2){let t=m();l(2),F(t.tabs)}}var se=(()=>{class e{settingService;themeService;snackBar;settings=[];tabs=[];settingsGrouped={};loading=!0;error=null;testEmailAddress="";sendingTestEmail=!1;constructor(t,i,n){this.settingService=t,this.themeService=i,this.snackBar=n}ngOnInit(){this.loadSettings()}loadSettings(){this.loading=!0,this.error=null,this.settingService.getSettingsGrouped().subscribe({next:t=>{this.loading=!1,t.success&&t.data?(this.settingsGrouped=t.data,this.tabs=Object.keys(t.data),this.settings=Object.values(t.data).flat()):this.error=t.message||"Failed to load settings"},error:t=>{this.loading=!1,this.error=t.error?.message||"Failed to load settings. Please check your permissions."}})}getSettingsForTab(t){return this.settingsGrouped[t]||[]}getGroupedSettingsForTab(t){let i=this.getSettingsForTab(t),n=new Map;return i.forEach(a=>{let M=a.category||"General";n.has(M)||n.set(M,[]),n.get(M).push(a)}),Array.from(n.entries()).map(([a,M])=>({category:a,settings:M})).sort((a,M)=>a.category.localeCompare(M.category))}getSelectOptions(t){return t.options?t.options.split(",").map(i=>i.trim()).filter(i=>i.length>0):[]}saveAll(){let t=this.settings.map(i=>({id:i.id,key:i.key,value:String(i.value),label:i.label,type:i.type,tab:i.tab,category:i.category}));this.settingService.saveSettings(t).subscribe({next:i=>{i.success&&(this.snackBar.open("Settings saved successfully","Close",{duration:3e3}),this.themeService.refreshTheme())},error:()=>{this.snackBar.open("Failed to save settings","Close",{duration:3e3})}})}sendTestEmail(){if(!this.testEmailAddress){this.snackBar.open("Please enter an email address","Close",{duration:3e3});return}this.sendingTestEmail=!0,this.settingService.sendTestEmail(this.testEmailAddress).subscribe({next:t=>{this.sendingTestEmail=!1,t.success?this.snackBar.open(t.message||"Test email sent successfully!","Close",{duration:5e3}):this.snackBar.open(t.message||"Failed to send test email","Close",{duration:5e3})},error:t=>{this.sendingTestEmail=!1,this.snackBar.open(t.error?.message||"Failed to send test email","Close",{duration:5e3})}})}static \u0275fac=function(i){return new(i||e)(O(N),O(ot),O(nt))};static \u0275cmp=P({type:e,selectors:[["app-settings"]],decls:12,vars:2,consts:[[1,"settings-container"],[1,"header"],["mat-raised-button","","color","primary",3,"click","disabled"],[1,"loading-state"],["diameter","40"],[1,"error-state"],["mat-raised-button","","color","primary",3,"click"],[1,"empty-state"],[1,"hint"],[3,"label"],[1,"tab-content"],[1,"category-section"],[1,"tab-actions"],["appearance","outline",1,"test-email-field"],["matInput","","placeholder","Enter email address",3,"ngModelChange","ngModel"],["mat-raised-button","","color","accent",3,"click","disabled"],["diameter","20"],[1,"category-title"],[1,"settings-grid"],[1,"setting-item"],[1,"setting-label"],[1,"description"],[1,"setting-input"],[3,"checked"],[1,"color-input"],["appearance","outline",1,"compact-field"],[3,"change","checked"],["type","color",3,"ngModelChange","ngModel","ngModelOptions"],["matInput","",1,"color-text",3,"ngModelChange","ngModel","ngModelOptions"],["matInput","","type","number",3,"ngModelChange","ngModel","ngModelOptions"],["matInput","","type","password",3,"ngModelChange","ngModel","ngModelOptions"],[3,"ngModelChange","ngModel","ngModelOptions"],[3,"value"],["matInput","",3,"ngModelChange","ngModel","ngModelOptions"]],template:function(i,n){i&1&&(r(0,"div",0)(1,"div",1)(2,"h1"),d(3,"Settings"),o(),r(4,"button",2),w("click",function(){return n.saveAll()}),r(5,"mat-icon"),d(6,"save"),o(),d(7," Save Changes "),o()(),S(8,gt,5,0,"mat-card")(9,ut,10,1,"mat-card")(10,Ct,8,0,"mat-card")(11,kt,4,0,"mat-card"),o()),i&2&&(l(4),c("disabled",n.loading||n.tabs.length===0),l(4),h(n.loading?8:n.error?9:n.tabs.length===0?10:11))},dependencies:[k,L,B,A,W,I,U,$,R,mt,st,lt,J,H,q,Q,K,at,rt,V,ct,dt,D,z,G,j,it,Y,X,tt,Z,et],styles:[".settings-container[_ngcontent-%COMP%]{padding:1rem}.header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem}.tab-content[_ngcontent-%COMP%]{padding:1rem}.tab-actions[_ngcontent-%COMP%]{display:flex;gap:1rem;align-items:center;margin-bottom:1rem;padding:1rem;background:#f5f5f5;border-radius:8px}.test-email-field[_ngcontent-%COMP%]{flex:1;max-width:400px}.tab-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{height:56px}.tab-actions[_ngcontent-%COMP%]   mat-spinner[_ngcontent-%COMP%]{display:inline-block;margin-right:8px}.category-section[_ngcontent-%COMP%]{margin-bottom:1.5rem}.category-title[_ngcontent-%COMP%]{font-size:1rem;font-weight:500;color:#1976d2;margin-bottom:1rem;padding-bottom:.5rem;border-bottom:2px solid #e0e0e0}.settings-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);gap:1rem}@media (max-width: 1200px){.settings-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}.setting-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:.75rem;background:#fafafa;border-radius:4px;border:1px solid #e0e0e0}.setting-label[_ngcontent-%COMP%]{flex:1;min-width:0;padding-right:1rem}.setting-label[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{display:block;font-size:.875rem;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.setting-label[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{display:block;font-size:.7rem;color:#666;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.setting-input[_ngcontent-%COMP%]{flex-shrink:0;width:200px}.compact-field[_ngcontent-%COMP%]{width:100%}.compact-field[_ngcontent-%COMP%]     .mat-mdc-form-field-subscript-wrapper{display:none}.color-input[_ngcontent-%COMP%]{display:flex;gap:.5rem;align-items:center}.color-input[_ngcontent-%COMP%]   input[type=color][_ngcontent-%COMP%]{width:40px;height:36px;border:none;cursor:pointer;border-radius:4px}.color-input[_ngcontent-%COMP%]   .color-text[_ngcontent-%COMP%]{flex:1;font-size:.8rem}.loading-state[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%], .empty-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:3rem;text-align:center;color:#666}.loading-state[_ngcontent-%COMP%]   mat-spinner[_ngcontent-%COMP%]{margin-bottom:1rem}.error-state[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .empty-state[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:64px;width:64px;height:64px;margin-bottom:1rem;opacity:.5}.error-state[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#f44336}.error-state[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-top:1rem}.empty-state[_ngcontent-%COMP%]   .hint[_ngcontent-%COMP%]{font-size:.875rem;opacity:.7;margin-top:.5rem}mat-divider[_ngcontent-%COMP%]{margin:1rem 0}"]})}return e})();export{se as SettingsComponent};
