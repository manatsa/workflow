import{a as Ft,b as zt}from"./chunk-4WQK3HXU.js";import{a as Zt}from"./chunk-QDCPXM6W.js";import{a as Gt}from"./chunk-4LJSTQBG.js";import{a as At,b as Lt,e as Tt}from"./chunk-PM74EOZI.js";import{a as Pt,b as Dt,c as Ot,d as It}from"./chunk-GTA6LP7E.js";import{a as W,b as L}from"./chunk-RORH5LGT.js";import{a as U,b as Rt,c as Bt,d as jt,e as Nt,f as Vt,g as Qt,h as T}from"./chunk-K3UXCVE5.js";import{b as Wt}from"./chunk-L6PTED5A.js";import{b as lt}from"./chunk-NDFZT543.js";import{a as St,b as Et}from"./chunk-D7HGT47B.js";import{a as Ht}from"./chunk-3AZ62B2F.js";import"./chunk-2HMVGF7U.js";import{b as Ut,c as qt}from"./chunk-LNAKRYVP.js";import"./chunk-3WEQTSJY.js";import{b as bt,c as vt,e as wt,f as xt,i as kt,j as yt,l as Ct,m as Mt}from"./chunk-W7HGFPQV.js";import{d as dt,f as F,h as mt,i as ht,m as pt,p as gt,q as _t,t as ut,v as ft}from"./chunk-MFE2U5AV.js";import{h as K}from"./chunk-KNH3VKXQ.js";import"./chunk-OWVO723I.js";import{a as Q}from"./chunk-3PG53WPE.js";import{b as it,c as nt,d as at,e as ot,g as rt}from"./chunk-GMPFJIFP.js";import{Q as st,fa as y,l as et,p as P,ra as ct,ta as D,ua as O,va as I,wa as V,ya as A}from"./chunk-ZJGSEVKG.js";import{Cb as g,Eb as f,Fb as H,Hb as m,Jb as tt,Kb as x,Lb as k,Mb as e,Nb as t,Ob as _,Sb as B,Wb as u,Xb as b,a as X,b as J,ba as S,cb as r,ec as G,fc as i,gc as c,hb as h,hc as j,oa as C,ob as v,pa as M,pb as E,pc as N,rc as Z,tc as $,ub as p}from"./chunk-BMOUMNDR.js";var te=(()=>{class n{static \u0275fac=function(s){return new(s||n)};static \u0275mod=E({type:n});static \u0275inj=S({imports:[y,K,K,y]})}return n})();var ee=(()=>{class n{static \u0275fac=function(s){return new(s||n)};static \u0275mod=E({type:n});static \u0275inj=S({imports:[y,y]})}return n})();var ie=(()=>{class n{static \u0275fac=function(s){return new(s||n)};static \u0275mod=E({type:n});static \u0275inj=S({imports:[st,y,ct,lt,L]})}return n})();var _e=(n,d)=>d.id;function ue(n,d){if(n&1&&(e(0,"span",18),i(1),t()),n&2){let o=d.$implicit;r(),c(o)}}function fe(n,d){if(n&1&&x(0,ue,2,1,"span",18,tt),n&2){let o=b();k(o.data.roles)}}function be(n,d){n&1&&(e(0,"span",15),i(1,"No roles assigned"),t())}function ve(n,d){if(n&1&&(e(0,"span",19),i(1),t()),n&2){let o=d.$implicit;r(),c(o.name)}}function we(n,d){if(n&1&&(_(0,"mat-divider"),e(1,"div",7)(2,"h4")(3,"mat-icon"),i(4,"business"),t(),i(5," Business Units"),t(),e(6,"div",14),x(7,ve,2,1,"span",19,_e),t()()),n&2){let o=b();r(7),k(o.data.sbus)}}var re=(()=>{class n{dialogRef;data;constructor(o,s){this.dialogRef=o,this.data=s}get userInitials(){return(this.data.fullName||"").split(" ").map(s=>s[0]).join("").substring(0,2).toUpperCase()}static \u0275fac=function(s){return new(s||n)(h(U),h(Rt))};static \u0275cmp=v({type:n,selectors:[["app-profile-dialog"]],decls:98,vars:28,consts:[[1,"profile-dialog"],[1,"profile-header"],[1,"avatar"],[1,"header-info"],[1,"user-type"],["mat-icon-button","","mat-dialog-close","",1,"close-btn"],[1,"profile-content"],[1,"info-section"],[1,"info-grid"],[1,"info-item"],[1,"label"],[1,"value"],[1,"info-item","full-width"],[1,"value","badge"],[1,"chips-container"],[1,"no-data"],[1,"dialog-actions"],["mat-button","","mat-dialog-close",""],[1,"role-chip"],[1,"sbu-chip"]],template:function(s,a){s&1&&(e(0,"div",0)(1,"div",1)(2,"div",2),i(3),t(),e(4,"div",3)(5,"h2"),i(6),t(),e(7,"span",4),i(8),t()(),e(9,"button",5)(10,"mat-icon"),i(11,"close"),t()()(),_(12,"mat-divider"),e(13,"div",6)(14,"div",7)(15,"h4")(16,"mat-icon"),i(17,"person"),t(),i(18," Personal Information"),t(),e(19,"div",8)(20,"div",9)(21,"span",10),i(22,"Username"),t(),e(23,"span",11),i(24),t()(),e(25,"div",9)(26,"span",10),i(27,"Email"),t(),e(28,"span",11),i(29),t()(),e(30,"div",9)(31,"span",10),i(32,"First Name"),t(),e(33,"span",11),i(34),t()(),e(35,"div",9)(36,"span",10),i(37,"Last Name"),t(),e(38,"span",11),i(39),t()(),e(40,"div",9)(41,"span",10),i(42,"Phone"),t(),e(43,"span",11),i(44),t()(),e(45,"div",9)(46,"span",10),i(47,"Staff ID"),t(),e(48,"span",11),i(49),t()(),e(50,"div",12)(51,"span",10),i(52,"Department"),t(),e(53,"span",11),i(54),t()()()(),_(55,"mat-divider"),e(56,"div",7)(57,"h4")(58,"mat-icon"),i(59,"security"),t(),i(60," Account Information"),t(),e(61,"div",8)(62,"div",9)(63,"span",10),i(64,"User Type"),t(),e(65,"span",13),i(66),t()(),e(67,"div",9)(68,"span",10),i(69,"Account Status"),t(),e(70,"span",13),i(71),t()(),e(72,"div",9)(73,"span",10),i(74,"Last Login"),t(),e(75,"span",11),i(76),Z(77,"date"),t()(),e(78,"div",9)(79,"span",10),i(80,"Account Created"),t(),e(81,"span",11),i(82),Z(83,"date"),t()()()(),_(84,"mat-divider"),e(85,"div",7)(86,"h4")(87,"mat-icon"),i(88,"admin_panel_settings"),t(),i(89," Roles"),t(),e(90,"div",14),p(91,fe,2,0)(92,be,2,0,"span",15),t()(),p(93,we,9,0),t(),_(94,"mat-divider"),e(95,"div",16)(96,"button",17),i(97,"Close"),t()()()),s&2&&(r(3),c(a.userInitials),r(3),c(a.data.fullName),r(2),c(a.data.userType),r(16),c(a.data.username),r(5),c(a.data.email||"-"),r(5),c(a.data.firstName||"-"),r(5),c(a.data.lastName||"-"),r(5),c(a.data.phoneNumber||"-"),r(5),c(a.data.staffId||"-"),r(5),c(a.data.department||"-"),r(11),H(a.data.userType.toLowerCase()),r(),c(a.data.userType),r(4),f("active",a.data.isActive)("inactive",!a.data.isActive),r(),j(" ",a.data.isActive?"Active":"Inactive"," "),r(5),c(a.data.lastLogin?$(77,22,a.data.lastLogin,"medium"):"Never"),r(6),c(a.data.createdAt?$(83,25,a.data.createdAt,"medium"):"-"),r(9),m(a.data.roles&&a.data.roles.length>0?91:92),r(2),m(a.data.sbus&&a.data.sbus.length>0?93:-1))},dependencies:[P,et,T,jt,A,V,I,O,D,L,W,Wt],styles:[".profile-dialog[_ngcontent-%COMP%]{min-width:500px;max-width:600px}.profile-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;padding:1.5rem;position:relative}.avatar[_ngcontent-%COMP%]{width:64px;height:64px;border-radius:50%;background:linear-gradient(135deg,#1976d2,#1565c0);color:#fff;display:flex;align-items:center;justify-content:center;font-size:1.5rem;font-weight:500}.header-info[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:1.5rem}.user-type[_ngcontent-%COMP%]{color:#666;font-size:.875rem}.close-btn[_ngcontent-%COMP%]{position:absolute;top:.5rem;right:.5rem}.profile-content[_ngcontent-%COMP%]{padding:0 1.5rem;max-height:60vh;overflow-y:auto}.info-section[_ngcontent-%COMP%]{padding:1rem 0}.info-section[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 1rem;display:flex;align-items:center;gap:.5rem;color:#1976d2;font-size:.9rem;text-transform:uppercase;letter-spacing:.5px}.info-section[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:1.25rem;width:1.25rem;height:1.25rem}.info-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);gap:1rem}.info-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.25rem}.info-item.full-width[_ngcontent-%COMP%]{grid-column:1/-1}.info-item[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-size:.75rem;color:#666;text-transform:uppercase;letter-spacing:.5px}.info-item[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-size:.95rem;font-weight:500;color:#333}.badge[_ngcontent-%COMP%]{display:inline-block;padding:.25rem .5rem;border-radius:4px;font-size:.75rem;width:fit-content}.badge.system[_ngcontent-%COMP%]{background:#e3f2fd;color:#1565c0}.badge.staff[_ngcontent-%COMP%]{background:#f5f5f5;color:#666}.badge.manager[_ngcontent-%COMP%]{background:#fff3e0;color:#e65100}.badge.external[_ngcontent-%COMP%]{background:#fce4ec;color:#c62828}.badge.active[_ngcontent-%COMP%]{background:#e8f5e9;color:#2e7d32}.badge.inactive[_ngcontent-%COMP%]{background:#ffebee;color:#c62828}.chips-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:.5rem}.role-chip[_ngcontent-%COMP%], .sbu-chip[_ngcontent-%COMP%]{padding:.375rem .75rem;border-radius:16px;font-size:.8rem;font-weight:500}.role-chip[_ngcontent-%COMP%]{background:#e3f2fd;color:#1565c0}.sbu-chip[_ngcontent-%COMP%]{background:#f3e5f5;color:#7b1fa2}.no-data[_ngcontent-%COMP%]{color:#999;font-style:italic}.dialog-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;padding:1rem 1.5rem}"]})}return n})();function ke(n,d){if(n&1&&(e(0,"div",3),i(1),t()),n&2){let o=b();r(),c(o.errorMessage)}}function ye(n,d){n&1&&(e(0,"mat-error"),i(1,"Current password is required"),t())}function Ce(n,d){n&1&&(e(0,"mat-error"),i(1,"New password is required"),t())}function Me(n,d){n&1&&(e(0,"mat-error"),i(1,"Password must be at least 8 characters"),t())}function Se(n,d){n&1&&(e(0,"mat-error"),i(1,"Please confirm your new password"),t())}function Ee(n,d){n&1&&(e(0,"mat-error"),i(1,"Passwords do not match"),t())}function Pe(n,d){n&1&&_(0,"mat-spinner",15)}function De(n,d){n&1&&i(0," Change Password ")}var se=(()=>{class n{fb;authService;dialogRef;snackBar;changePasswordForm;loading=!1;hideCurrentPassword=!0;hideNewPassword=!0;hideConfirmPassword=!0;errorMessage="";constructor(o,s,a,l){this.fb=o,this.authService=s,this.dialogRef=a,this.snackBar=l,this.changePasswordForm=this.fb.group({currentPassword:["",F.required],newPassword:["",[F.required,F.minLength(8)]],confirmPassword:["",F.required]},{validators:this.passwordMatchValidator})}passwordMatchValidator(o){let s=o.get("newPassword")?.value,a=o.get("confirmPassword")?.value;return s===a?null:{passwordMismatch:!0}}get newPassword(){return this.changePasswordForm.get("newPassword")?.value||""}get hasMinLength(){return this.newPassword.length>=8}get hasUppercase(){return/[A-Z]/.test(this.newPassword)}get hasLowercase(){return/[a-z]/.test(this.newPassword)}get hasNumber(){return/[0-9]/.test(this.newPassword)}get hasSpecial(){return/[!@#$%^&*(),.?":{}|<>]/.test(this.newPassword)}onSubmit(){if(this.changePasswordForm.invalid)return;this.loading=!0,this.errorMessage="";let{currentPassword:o,newPassword:s,confirmPassword:a}=this.changePasswordForm.value;this.authService.changePassword(o,s,a).subscribe({next:l=>{this.loading=!1,l.success?(this.snackBar.open("Password changed successfully","Close",{duration:3e3}),this.dialogRef.close(!0)):this.errorMessage=l.message||"Failed to change password"},error:l=>{this.loading=!1,this.errorMessage=l.error?.message||"An error occurred. Please try again."}})}close(){this.dialogRef.close()}static \u0275fac=function(s){return new(s||n)(h(ut),h(Q),h(U),h(Ut))};static \u0275cmp=v({type:n,selectors:[["app-change-password-dialog"]],decls:63,vars:25,consts:[[1,"dialog-header"],["mat-dialog-title",""],["mat-icon-button","",3,"click"],[1,"error-message"],[3,"ngSubmit","formGroup"],["appearance","outline",1,"form-field"],["matInput","","formControlName","currentPassword","autocomplete","current-password",3,"type"],["matPrefix",""],["mat-icon-button","","matSuffix","","type","button",3,"click"],["matInput","","formControlName","newPassword","autocomplete","new-password",3,"type"],["matInput","","formControlName","confirmPassword","autocomplete","new-password",3,"type"],[1,"password-requirements"],["align","end"],["mat-button","",3,"click"],["mat-raised-button","","color","primary",3,"click","disabled"],["diameter","20"]],template:function(s,a){if(s&1&&(e(0,"div",0)(1,"h2",1)(2,"mat-icon"),i(3,"lock"),t(),i(4," Change Password "),t(),e(5,"button",2),u("click",function(){return a.close()}),e(6,"mat-icon"),i(7,"close"),t()()(),e(8,"mat-dialog-content"),p(9,ke,2,1,"div",3),e(10,"form",4),u("ngSubmit",function(){return a.onSubmit()}),e(11,"mat-form-field",5)(12,"mat-label"),i(13,"Current Password"),t(),_(14,"input",6),e(15,"mat-icon",7),i(16,"lock"),t(),e(17,"button",8),u("click",function(){return a.hideCurrentPassword=!a.hideCurrentPassword}),e(18,"mat-icon"),i(19),t()(),p(20,ye,2,0,"mat-error"),t(),e(21,"mat-form-field",5)(22,"mat-label"),i(23,"New Password"),t(),_(24,"input",9),e(25,"mat-icon",7),i(26,"lock_outline"),t(),e(27,"button",8),u("click",function(){return a.hideNewPassword=!a.hideNewPassword}),e(28,"mat-icon"),i(29),t()(),p(30,Ce,2,0,"mat-error")(31,Me,2,0,"mat-error"),t(),e(32,"mat-form-field",5)(33,"mat-label"),i(34,"Confirm New Password"),t(),_(35,"input",10),e(36,"mat-icon",7),i(37,"lock_outline"),t(),e(38,"button",8),u("click",function(){return a.hideConfirmPassword=!a.hideConfirmPassword}),e(39,"mat-icon"),i(40),t()(),p(41,Se,2,0,"mat-error")(42,Ee,2,0,"mat-error"),t(),e(43,"div",11)(44,"h4"),i(45,"Password Requirements:"),t(),e(46,"ul")(47,"li"),i(48,"At least 8 characters"),t(),e(49,"li"),i(50,"At least one uppercase letter"),t(),e(51,"li"),i(52,"At least one lowercase letter"),t(),e(53,"li"),i(54,"At least one number"),t(),e(55,"li"),i(56,"At least one special character"),t()()()()(),e(57,"mat-dialog-actions",12)(58,"button",13),u("click",function(){return a.close()}),i(59,"Cancel"),t(),e(60,"button",14),u("click",function(){return a.onSubmit()}),p(61,Pe,1,0,"mat-spinner",15)(62,De,1,0),t()()),s&2){let l,w,R,Y;r(9),m(a.errorMessage?9:-1),r(),g("formGroup",a.changePasswordForm),r(4),g("type",a.hideCurrentPassword?"password":"text"),r(5),c(a.hideCurrentPassword?"visibility_off":"visibility"),r(),m((l=a.changePasswordForm.get("currentPassword"))!=null&&l.hasError("required")?20:-1),r(4),g("type",a.hideNewPassword?"password":"text"),r(5),c(a.hideNewPassword?"visibility_off":"visibility"),r(),m((w=a.changePasswordForm.get("newPassword"))!=null&&w.hasError("required")?30:-1),r(),m((R=a.changePasswordForm.get("newPassword"))!=null&&R.hasError("minlength")?31:-1),r(4),g("type",a.hideConfirmPassword?"password":"text"),r(5),c(a.hideConfirmPassword?"visibility_off":"visibility"),r(),m((Y=a.changePasswordForm.get("confirmPassword"))!=null&&Y.hasError("required")?41:-1),r(),m(a.changePasswordForm.hasError("passwordMismatch")?42:-1),r(5),f("met",a.hasMinLength),r(2),f("met",a.hasUppercase),r(2),f("met",a.hasLowercase),r(2),f("met",a.hasNumber),r(2),f("met",a.hasSpecial),r(5),g("disabled",a.loading||a.changePasswordForm.invalid),r(),m(a.loading?61:62)}},dependencies:[P,ft,pt,dt,mt,ht,gt,_t,T,Nt,Qt,Vt,yt,kt,bt,vt,wt,xt,Mt,Ct,A,V,I,O,D,Et,St,qt],styles:['@charset "UTF-8";.dialog-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:0 16px}.dialog-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;margin:0}mat-dialog-content[_ngcontent-%COMP%]{min-width:400px;max-width:500px}.form-field[_ngcontent-%COMP%]{width:100%;margin-bottom:.5rem}.error-message[_ngcontent-%COMP%]{background:#ffebee;color:#c62828;padding:.75rem;border-radius:4px;margin-bottom:1rem}.password-requirements[_ngcontent-%COMP%]{background:#f5f5f5;padding:1rem;border-radius:4px;margin-top:.5rem}.password-requirements[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 .5rem;font-size:.875rem}.password-requirements[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{margin:0;padding-left:1.25rem;font-size:.8rem}.password-requirements[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{color:#666;margin-bottom:.25rem}.password-requirements[_ngcontent-%COMP%]   li.met[_ngcontent-%COMP%]{color:#2e7d32}.password-requirements[_ngcontent-%COMP%]   li.met[_ngcontent-%COMP%]::marker{content:"\\2713  "}mat-dialog-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   mat-spinner[_ngcontent-%COMP%]{display:inline-block}']})}return n})();var Oe=n=>["/workflows/builder",n],Ie=n=>["/workflows",n,"instances"],Ae=n=>["/reports",n],q=(n,d)=>d.id;function Le(n,d){n&1&&(e(0,"mat-expansion-panel",12)(1,"mat-expansion-panel-header")(2,"mat-icon"),i(3,"admin_panel_settings"),t(),e(4,"span"),i(5,"System Admin"),t()(),e(6,"div",14)(7,"a",35)(8,"mat-icon"),i(9,"people"),t(),e(10,"span"),i(11,"Users"),t()(),e(12,"a",36)(13,"mat-icon"),i(14,"security"),t(),e(15,"span"),i(16,"Roles"),t()(),e(17,"a",37)(18,"mat-icon"),i(19,"category"),t(),e(20,"span"),i(21,"Categories"),t()(),e(22,"a",38)(23,"mat-icon"),i(24,"corporate_fare"),t(),e(25,"span"),i(26,"Corporates"),t()(),e(27,"a",39)(28,"mat-icon"),i(29,"business"),t(),e(30,"span"),i(31,"SBU Management"),t()(),e(32,"a",40)(33,"mat-icon"),i(34,"store"),t(),e(35,"span"),i(36,"Branches"),t()(),e(37,"a",41)(38,"mat-icon"),i(39,"account_tree"),t(),e(40,"span"),i(41,"Departments"),t()(),e(42,"a",42)(43,"mat-icon"),i(44,"settings"),t(),e(45,"span"),i(46,"Settings"),t()(),e(47,"a",43)(48,"mat-icon"),i(49,"history"),t(),e(50,"span"),i(51,"Audit Logs"),t()()()())}function Te(n,d){if(n&1&&(e(0,"a",15)(1,"mat-icon"),i(2,"edit"),t(),e(3,"span"),i(4),t()()),n&2){let o=d.$implicit;g("routerLink",N(2,Oe,o.id)),r(4),c(o.name)}}function Fe(n,d){if(n&1&&(e(0,"mat-expansion-panel",12)(1,"mat-expansion-panel-header")(2,"mat-icon"),i(3,"build"),t(),e(4,"span"),i(5,"Workflow Admin"),t()(),e(6,"div",14)(7,"a",44)(8,"mat-icon"),i(9,"list"),t(),e(10,"span"),i(11,"Manage Workflows"),t()(),x(12,Te,5,4,"a",15,q),t()()),n&2){let o=b();r(12),k(o.workflows)}}function ze(n,d){if(n&1&&(e(0,"a",15)(1,"mat-icon"),i(2),t(),e(3,"span"),i(4),t()()),n&2){let o=d.$implicit;g("routerLink",N(3,Ie,o.code)),r(2),c(o.icon||"description"),r(2),c(o.name)}}function Re(n,d){if(n&1&&(e(0,"span",18),i(1),t()),n&2){let o=b();r(),c(o.pendingApprovalsCount)}}function Be(n,d){if(n&1&&(e(0,"span",21),i(1),t()),n&2){let o=b();r(),c(o.mySubmissionsCount)}}function je(n,d){if(n&1&&(e(0,"a",15)(1,"mat-icon"),i(2),t(),e(3,"span"),i(4),t()()),n&2){let o=d.$implicit;g("routerLink",N(3,Ae,o.id)),r(2),c(o.icon),r(2),c(o.name)}}function Ne(n,d){if(n&1&&(e(0,"mat-expansion-panel",23)(1,"mat-expansion-panel-header")(2,"mat-icon"),i(3),t(),e(4,"span"),i(5),t()(),e(6,"div",45),x(7,je,5,5,"a",15,q),t()()),n&2){let o=d.$implicit;r(3),c(o.icon),r(2),c(o.name),r(2),k(o.reports)}}var Yi=(()=>{class n{authService;workflowService;themeService;reportService;router;dialog;workflows=[];activeWorkflows=[];reportCategories=[];sidebarOpen=!0;pendingApprovalsCount=0;mySubmissionsCount=0;currentYear=new Date().getFullYear();constructor(o,s,a,l,w,R){this.authService=o,this.workflowService=s,this.themeService=a,this.reportService=l,this.router=w,this.dialog=R}ngOnInit(){this.themeService.loadTheme(),this.loadWorkflows(),this.loadPendingApprovalsCount(),this.loadMySubmissionsCount(),this.loadReportCategories()}loadReportCategories(){let o=this.reportService.getReportCategories(),s=this.reportService.getAllReports();this.reportCategories=o.map(a=>J(X({},a),{reports:s.filter(l=>l.category===a.id).map(l=>({id:l.id,name:l.name,icon:l.icon}))}))}loadPendingApprovalsCount(){this.workflowService.getPendingApprovalsCount().subscribe({next:o=>{o.success&&(this.pendingApprovalsCount=o.data||0)},error:()=>{this.pendingApprovalsCount=0}})}loadMySubmissionsCount(){this.workflowService.getMySubmissionsCount().subscribe({next:o=>{o.success&&(this.mySubmissionsCount=o.data||0)},error:()=>{this.mySubmissionsCount=0}})}get fullName(){return this.authService.currentUser?.fullName||"User"}get userInitials(){return this.fullName.split(" ").map(s=>s[0]).join("").substring(0,2).toUpperCase()}get userType(){return this.authService.currentUser?.userType||"STAFF"}get isAdmin(){return this.authService.hasRole("ROLE_ADMIN")||this.authService.hasPrivilege("ADMIN")}get canBuildWorkflows(){return this.isAdmin||this.authService.hasPrivilege("WORKFLOW_BUILDER")}loadWorkflows(){this.workflowService.getWorkflows().subscribe(o=>{o.success&&(this.workflows=o.data)}),this.workflowService.getActiveWorkflows().subscribe(o=>{o.success&&(this.activeWorkflows=o.data)})}toggleSidebar(){this.sidebarOpen=!this.sidebarOpen}logout(){this.authService.logout()}openProfileDialog(){let o=this.authService.currentUser;o&&this.dialog.open(re,{width:"600px",data:{username:o.username,email:o.email,firstName:o.firstName,lastName:o.lastName,fullName:o.fullName,phoneNumber:o.phoneNumber,staffId:o.staffId,department:o.department,userType:o.userType,roles:o.roles||[],sbus:[],lastLogin:o.lastLogin,createdAt:o.createdAt,isActive:!0,isLocked:!1}})}openChangePasswordDialog(){this.dialog.open(se,{width:"500px",disableClose:!0})}static \u0275fac=function(s){return new(s||n)(h(Q),h(Ht),h(Gt),h(Zt),h(nt),h(Bt))};static \u0275cmp=v({type:n,selectors:[["app-main-layout"]],decls:88,vars:18,consts:[["userMenu","matMenu"],[1,"layout-container"],[1,"sidebar"],[1,"sidebar-header"],[1,"brand-text"],[1,"user-profile"],[1,"avatar"],[1,"user-info"],[1,"name"],[1,"role"],[1,"sidebar-nav"],["routerLink","/dashboard","routerLinkActive","active",1,"menu-item"],[1,"nav-panel"],[1,"nav-panel",3,"expanded"],[1,"submenu"],[1,"menu-item",3,"routerLink"],["routerLink","/approvals","routerLinkActive","active",1,"menu-item"],["matBadgeColor","warn","matBadgeSize","small",3,"matBadge","matBadgeHidden"],[1,"badge-count"],["routerLink","/my-submissions","routerLinkActive","active",1,"menu-item"],["matBadgeColor","primary","matBadgeSize","small",3,"matBadge","matBadgeHidden"],[1,"badge-count","primary"],[1,"submenu","reports-submenu"],[1,"nav-panel","nested-panel"],[1,"sidebar-footer"],[1,"developer"],[1,"copyright"],[1,"main-content"],[1,"main-header"],[1,"header-left"],["mat-icon-button","",3,"click"],[1,"header-right"],["mat-icon-button","",3,"matMenuTriggerFor"],["mat-menu-item","",3,"click"],[1,"page-content"],["routerLink","/users","routerLinkActive","active",1,"menu-item"],["routerLink","/roles","routerLinkActive","active",1,"menu-item"],["routerLink","/categories","routerLinkActive","active",1,"menu-item"],["routerLink","/corporates","routerLinkActive","active",1,"menu-item"],["routerLink","/sbus","routerLinkActive","active",1,"menu-item"],["routerLink","/branches","routerLinkActive","active",1,"menu-item"],["routerLink","/departments","routerLinkActive","active",1,"menu-item"],["routerLink","/settings","routerLinkActive","active",1,"menu-item"],["routerLink","/audit","routerLinkActive","active",1,"menu-item"],["routerLink","/workflows","routerLinkActive","active",1,"menu-item"],[1,"submenu","nested-submenu"]],template:function(s,a){if(s&1){let l=B();e(0,"div",1)(1,"aside",2)(2,"div",3)(3,"mat-icon"),i(4,"workflow"),t(),e(5,"span",4),i(6,"Sonarworks"),t()(),e(7,"div",5)(8,"div",6),i(9),t(),e(10,"div",7)(11,"div",8),i(12),t(),e(13,"div",9),i(14),t()()(),e(15,"nav",10)(16,"a",11)(17,"mat-icon"),i(18,"dashboard"),t(),e(19,"span"),i(20,"Home"),t()(),p(21,Le,52,0,"mat-expansion-panel",12)(22,Fe,14,0,"mat-expansion-panel",12),e(23,"mat-expansion-panel",13)(24,"mat-expansion-panel-header")(25,"mat-icon"),i(26,"folder"),t(),e(27,"span"),i(28,"Workflows"),t()(),e(29,"div",14),x(30,ze,5,5,"a",15,q),t()(),e(32,"a",16)(33,"mat-icon",17),i(34,"thumb_up"),t(),e(35,"span"),i(36,"Pending Approvals"),t(),p(37,Re,2,1,"span",18),t(),e(38,"a",19)(39,"mat-icon",20),i(40,"send"),t(),e(41,"span"),i(42,"My Submissions"),t(),p(43,Be,2,1,"span",21),t(),e(44,"mat-expansion-panel",12)(45,"mat-expansion-panel-header")(46,"mat-icon"),i(47,"assessment"),t(),e(48,"span"),i(49,"Reports"),t()(),e(50,"div",22),x(51,Ne,9,2,"mat-expansion-panel",23,q),t()()(),e(53,"div",24)(54,"div",25),i(55,"Developed By: Sonar Microsystems"),t(),e(56,"div",26),i(57),t()()(),e(58,"main",27)(59,"header",28)(60,"div",29)(61,"button",30),u("click",function(){return C(l),M(a.toggleSidebar())}),e(62,"mat-icon"),i(63,"menu"),t()()(),e(64,"div",31)(65,"button",32)(66,"mat-icon"),i(67,"account_circle"),t()(),e(68,"mat-menu",null,0)(70,"button",33),u("click",function(){return C(l),M(a.openProfileDialog())}),e(71,"mat-icon"),i(72,"person"),t(),e(73,"span"),i(74,"Profile"),t()(),e(75,"button",33),u("click",function(){return C(l),M(a.openChangePasswordDialog())}),e(76,"mat-icon"),i(77,"lock"),t(),e(78,"span"),i(79,"Change Password"),t()(),_(80,"mat-divider"),e(81,"button",33),u("click",function(){return C(l),M(a.logout())}),e(82,"mat-icon"),i(83,"exit_to_app"),t(),e(84,"span"),i(85,"Logout"),t()()()()(),e(86,"div",34),_(87,"router-outlet"),t()()()}if(s&2){let l=G(69);r(),f("collapsed",!a.sidebarOpen),r(8),c(a.userInitials),r(3),c(a.fullName),r(2),c(a.userType),r(7),m(a.isAdmin?21:-1),r(),m(a.canBuildWorkflows?22:-1),r(),g("expanded",!0),r(7),k(a.activeWorkflows),r(3),g("matBadge",a.pendingApprovalsCount>0?a.pendingApprovalsCount:null)("matBadgeHidden",a.pendingApprovalsCount===0),r(4),m(a.pendingApprovalsCount>0?37:-1),r(2),g("matBadge",a.mySubmissionsCount>0?a.mySubmissionsCount:null)("matBadgeHidden",a.mySubmissionsCount===0),r(4),m(a.mySubmissionsCount>0?43:-1),r(8),k(a.reportCategories),r(6),j("v1.0.0 | \xA9 ",a.currentYear," All Rights Reserved"),r(),f("expanded",!a.sidebarOpen),r(7),g("matMenuTriggerFor",l)}},dependencies:[P,rt,it,at,ot,te,ee,ie,W,O,D,A,I,It,Dt,Pt,Ot,Tt,At,Lt,zt,Ft,L,T],styles:[".layout-container[_ngcontent-%COMP%]{display:flex;min-height:100vh}.sidebar[_ngcontent-%COMP%]{width:260px;background:var(--sidebar-bg, #263238);color:var(--sidebar-text, white);display:flex;flex-direction:column;position:fixed;left:0;top:0;height:100vh;z-index:1000}.sidebar-header[_ngcontent-%COMP%]{padding:1rem;background:var(--sidebar-header-bg, #1e272c);display:flex;align-items:center;gap:.5rem;font-size:1.25rem;font-weight:500}.user-profile[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;padding:1rem;background:var(--user-profile-bg, #1e272c);color:var(--user-profile-text, white);border-bottom:1px solid var(--menu-hover-bg, #37474f)}.avatar[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:50%;background:var(--primary-color, #1976d2);display:flex;align-items:center;justify-content:center;font-weight:500}.user-info[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-weight:500}.user-info[_ngcontent-%COMP%]   .role[_ngcontent-%COMP%]{font-size:.75rem;opacity:.7}.sidebar-nav[_ngcontent-%COMP%]{flex:1;overflow-y:auto;padding:.5rem 0}.menu-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;padding:.75rem 1rem;color:var(--sidebar-text, white);text-decoration:none;cursor:pointer;transition:background .2s}.menu-item[_ngcontent-%COMP%]:hover{background:var(--menu-hover-bg, #37474f)}.menu-item.active[_ngcontent-%COMP%]{background:var(--menu-active-bg, #1976d2)}.nav-panel[_ngcontent-%COMP%]{background:transparent!important;box-shadow:none!important;color:var(--sidebar-text, white)}.nav-panel[_ngcontent-%COMP%]     .mat-expansion-panel-header{padding:0 1rem;color:var(--sidebar-text, white)}.nav-panel[_ngcontent-%COMP%]     .mat-expansion-panel-body{padding:0}.submenu[_ngcontent-%COMP%]   .menu-item[_ngcontent-%COMP%]{padding-left:2.5rem;font-size:.875rem}.nested-panel[_ngcontent-%COMP%]{margin:0!important}.nested-panel[_ngcontent-%COMP%]     .mat-expansion-panel-header{padding-left:2.5rem!important;font-size:.875rem;min-height:40px!important}.nested-submenu[_ngcontent-%COMP%]   .menu-item[_ngcontent-%COMP%]{padding-left:4rem!important;font-size:.8rem}.reports-submenu[_ngcontent-%COMP%]{max-height:400px;overflow-y:auto}.badge-count[_ngcontent-%COMP%]{margin-left:auto;background:#f44336;color:#fff;border-radius:10px;padding:2px 8px;font-size:.75rem;font-weight:500;min-width:20px;text-align:center}.badge-count.primary[_ngcontent-%COMP%]{background:#1976d2}.sidebar-footer[_ngcontent-%COMP%]{padding:1rem;text-align:center;border-top:1px solid var(--menu-hover-bg, #37474f);font-size:.75rem;opacity:.8}.sidebar-footer[_ngcontent-%COMP%]   .developer[_ngcontent-%COMP%]{font-weight:500;margin-bottom:.25rem}.sidebar-footer[_ngcontent-%COMP%]   .copyright[_ngcontent-%COMP%]{opacity:.7}.main-content[_ngcontent-%COMP%]{flex:1;margin-left:260px;min-height:100vh;display:flex;flex-direction:column;transition:margin-left .3s ease}.main-header[_ngcontent-%COMP%]{background:var(--header-bg, white);color:var(--header-text, #333);padding:.5rem 1rem;display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid var(--border-color, #e0e0e0);position:sticky;top:0;z-index:100}.page-content[_ngcontent-%COMP%]{flex:1;padding:1.5rem;background:var(--body-bg, #f5f5f5)}.sidebar[_ngcontent-%COMP%]{transition:transform .3s ease,width .3s ease}.sidebar.collapsed[_ngcontent-%COMP%]{transform:translate(-260px)}.main-content.expanded[_ngcontent-%COMP%]{margin-left:0}"]})}return n})();export{Yi as MainLayoutComponent};
