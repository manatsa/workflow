import{a as ne,b as ae}from"./chunk-5IID7QRZ.js";import{b as X,c as Z,e as $,f as ee,i as te,j as ie,l as re,m as oe}from"./chunk-QPNPC3UF.js";import{d as k,f as P,h as R,i as I,m as F,p as T,q as V,t as N,v as O}from"./chunk-PTVBPAL6.js";import{a as z,b as H,c as Y,d as J,e as K,f as Q,g as U,h as W}from"./chunk-FDHOQCIP.js";import{a as D}from"./chunk-4ZZG7ICJ.js";import{a as b,c as S,d as y,g as E}from"./chunk-7HWBNCDZ.js";import{p as v,ta as q,ua as A,va as j,wa as B,xa as G,ya as L}from"./chunk-SKGZNIDJ.js";import{Cb as f,Hb as m,Mb as i,Nb as r,Ob as C,Sb as M,Wb as h,Xb as c,cb as a,fc as n,gc as w,hb as u,oa as _,ob as x,pa as g,ub as p}from"./chunk-2CONVDTD.js";function se(e,l){if(e&1&&(i(0,"div",3),n(1),r()),e&2){let t=c();a(),w(t.successMessage)}}function de(e,l){if(e&1&&(i(0,"div",4),n(1),r()),e&2){let t=c();a(),w(t.errorMessage)}}function me(e,l){e&1&&(i(0,"mat-error"),n(1,"Password is required"),r())}function le(e,l){e&1&&(i(0,"mat-error"),n(1,"Password must be at least 8 characters"),r())}function ce(e,l){e&1&&(i(0,"mat-error"),n(1,"Please confirm your password"),r())}function ue(e,l){e&1&&(i(0,"mat-error"),n(1,"Passwords do not match"),r())}function pe(e,l){e&1&&C(0,"mat-spinner",15)}function fe(e,l){e&1&&n(0," Reset Password ")}function we(e,l){if(e&1){let t=M();i(0,"form",8),h("ngSubmit",function(){_(t);let o=c();return g(o.onSubmit())}),i(1,"mat-form-field",9)(2,"mat-label"),n(3,"New Password"),r(),C(4,"input",10),i(5,"mat-icon",11),n(6,"lock"),r(),i(7,"button",12),h("click",function(){_(t);let o=c();return g(o.hidePassword=!o.hidePassword)}),i(8,"mat-icon"),n(9),r()(),p(10,me,2,0,"mat-error")(11,le,2,0,"mat-error"),r(),i(12,"mat-form-field",9)(13,"mat-label"),n(14,"Confirm Password"),r(),C(15,"input",13),i(16,"mat-icon",11),n(17,"lock_outline"),r(),i(18,"button",12),h("click",function(){_(t);let o=c();return g(o.hideConfirmPassword=!o.hideConfirmPassword)}),i(19,"mat-icon"),n(20),r()(),p(21,ce,2,0,"mat-error")(22,ue,2,0,"mat-error"),r(),i(23,"button",14),p(24,pe,1,0,"mat-spinner",15)(25,fe,1,0),r()()}if(e&2){let t,s,o,d=c();f("formGroup",d.resetPasswordForm),a(4),f("type",d.hidePassword?"password":"text"),a(5),w(d.hidePassword?"visibility_off":"visibility"),a(),m((t=d.resetPasswordForm.get("password"))!=null&&t.hasError("required")?10:-1),a(),m((s=d.resetPasswordForm.get("password"))!=null&&s.hasError("minlength")?11:-1),a(4),f("type",d.hideConfirmPassword?"password":"text"),a(5),w(d.hideConfirmPassword?"visibility_off":"visibility"),a(),m((o=d.resetPasswordForm.get("confirmPassword"))!=null&&o.hasError("required")?21:-1),a(),m(d.resetPasswordForm.hasError("passwordMismatch")?22:-1),a(),f("disabled",d.loading),a(),m(d.loading?24:25)}}var Oe=(()=>{class e{fb;authService;router;route;resetPasswordForm;loading=!1;submitted=!1;tokenInvalid=!1;hidePassword=!0;hideConfirmPassword=!0;successMessage="";errorMessage="";token="";constructor(t,s,o,d){this.fb=t,this.authService=s,this.router=o,this.route=d,this.resetPasswordForm=this.fb.group({password:["",[P.required,P.minLength(8)]],confirmPassword:["",P.required]},{validators:this.passwordMatchValidator})}ngOnInit(){this.token=this.route.snapshot.queryParams.token,this.token||(this.tokenInvalid=!0,this.errorMessage="Invalid or missing reset token. Please request a new password reset.")}passwordMatchValidator(t){let s=t.get("password")?.value,o=t.get("confirmPassword")?.value;return s===o?null:{passwordMismatch:!0}}onSubmit(){this.resetPasswordForm.invalid||(this.loading=!0,this.errorMessage="",this.authService.resetPassword(this.token,this.resetPasswordForm.value.password).subscribe({next:t=>{this.loading=!1,t.success?(this.submitted=!0,this.successMessage="Your password has been reset successfully. Redirecting to login...",setTimeout(()=>this.router.navigate(["/login"]),3e3)):this.errorMessage=t.message||"Failed to reset password"},error:t=>{this.loading=!1,this.errorMessage=t.error?.message||"An error occurred. Please try again."}}))}static \u0275fac=function(s){return new(s||e)(u(N),u(D),u(S),u(b))};static \u0275cmp=x({type:e,selectors:[["app-reset-password"]],decls:16,vars:3,consts:[[1,"reset-password-container"],[1,"reset-password-card"],["mat-card-avatar",""],[1,"success-message"],[1,"error-message"],[3,"formGroup"],["align","end"],["mat-button","","routerLink","/login"],[3,"ngSubmit","formGroup"],["appearance","outline",1,"form-field"],["matInput","","formControlName","password","autocomplete","new-password",3,"type"],["matPrefix",""],["mat-icon-button","","matSuffix","","type","button",3,"click"],["matInput","","formControlName","confirmPassword","autocomplete","new-password",3,"type"],["mat-raised-button","","color","primary","type","submit",1,"submit-button",3,"disabled"],["diameter","20"]],template:function(s,o){s&1&&(i(0,"div",0)(1,"mat-card",1)(2,"mat-card-header")(3,"mat-icon",2),n(4,"workflow"),r(),i(5,"mat-card-title"),n(6,"Reset Password"),r(),i(7,"mat-card-subtitle"),n(8,"Enter your new password"),r()(),i(9,"mat-card-content"),p(10,se,2,1,"div",3)(11,de,2,1,"div",4)(12,we,26,11,"form",5),r(),i(13,"mat-card-actions",6)(14,"a",7),n(15,"Back to Login"),r()()()()),s&2&&(a(10),m(o.successMessage?10:-1),a(),m(o.errorMessage?11:-1),a(),m(!o.tokenInvalid&&!o.submitted?12:-1))},dependencies:[v,O,F,k,R,I,T,V,E,y,W,z,K,U,Y,Q,J,H,ie,te,X,Z,$,ee,oe,re,L,G,B,j,A,q,ae,ne],styles:[".reset-password-container[_ngcontent-%COMP%]{min-height:100vh;display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg,#1976d2,#1565c0)}.reset-password-card[_ngcontent-%COMP%]{width:100%;max-width:400px;margin:1rem}mat-card-header[_ngcontent-%COMP%]{margin-bottom:1rem}.form-field[_ngcontent-%COMP%]{width:100%;margin-bottom:.5rem}.submit-button[_ngcontent-%COMP%]{width:100%;height:48px;font-size:1rem}.success-message[_ngcontent-%COMP%]{background:#e8f5e9;color:#2e7d32;padding:.75rem;border-radius:4px;margin-bottom:1rem}.error-message[_ngcontent-%COMP%]{background:#ffebee;color:#c62828;padding:.75rem;border-radius:4px;margin-bottom:1rem}"]})}return e})();export{Oe as ResetPasswordComponent};
