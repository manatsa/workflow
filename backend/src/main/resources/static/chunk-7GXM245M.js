import{a as ie,b as re}from"./chunk-D7HGT47B.js";import{b as J,c as K,e as Q,f as X,i as Z,j as $,l as ee,m as te}from"./chunk-W7HGFPQV.js";import{d as y,f as h,h as x,i as E,m as k,p as F,q as I,t as L,v as T}from"./chunk-MFE2U5AV.js";import{a as D,b as G,c as V,d as U,e as z,f as H,g as W,h as Y}from"./chunk-XRACF4N4.js";import{a as B}from"./chunk-3PG53WPE.js";import{c as _,d as w,g as P}from"./chunk-GMPFJIFP.js";import{p as S,ta as N,ua as q,va as A,wa as O,xa as R,ya as j}from"./chunk-ZJGSEVKG.js";import{Cb as g,Hb as l,Mb as t,Nb as i,Ob as p,Wb as f,Xb as C,cb as a,fc as n,gc as M,hb as u,ob as v,ub as s}from"./chunk-BMOUMNDR.js";function ne(r,d){if(r&1&&(t(0,"div",3),n(1),i()),r&2){let e=C();a(),M(e.errorMessage)}}function oe(r,d){r&1&&(t(0,"mat-error"),n(1,"Username is required"),i())}function ae(r,d){r&1&&(t(0,"mat-error"),n(1,"Password is required"),i())}function me(r,d){r&1&&p(0,"mat-spinner",11)}function se(r,d){r&1&&n(0," Sign In ")}var ke=(()=>{class r{fb;authService;router;loginForm;loading=!1;hidePassword=!0;errorMessage="";constructor(e,m,o){this.fb=e,this.authService=m,this.router=o,this.loginForm=this.fb.group({username:["",h.required],password:["",h.required]})}onSubmit(){this.loginForm.invalid||(this.loading=!0,this.errorMessage="",this.authService.login(this.loginForm.value).subscribe({next:e=>{this.loading=!1,e.success?e.data.mustChangePassword?this.router.navigate(["/change-password"]):this.router.navigate(["/dashboard"]):this.errorMessage=e.message||"Login failed"},error:e=>{this.loading=!1,this.errorMessage=this.getErrorMessage(e)}}))}getErrorMessage(e){if(e.status===0)return e.error instanceof ProgressEvent?"Cannot connect to server. Please check if the server is running and accessible.":"Network error. Please check your internet connection.";switch(e.status){case 401:return"Invalid username or password.";case 403:return"Access denied. Your account may be disabled or locked.";case 404:return"Authentication service not available.";case 500:return"Server error. Please try again later.";case 502:return"Server is temporarily unavailable. Please try again later.";case 503:return"Service is currently unavailable. Please try again later.";case 504:return"Request timed out. Please try again.";default:break}return e.error?.message?e.error.message:e.message?e.message.includes("CORS")||e.message.includes("cross-origin")?"Connection blocked. Please contact your administrator.":e.message:"Login failed. Please try again."}static \u0275fac=function(m){return new(m||r)(u(L),u(B),u(_))};static \u0275cmp=v({type:r,selectors:[["app-login"]],decls:35,vars:8,consts:[[1,"login-container"],[1,"login-card"],["mat-card-avatar",""],[1,"error-message"],[3,"ngSubmit","formGroup"],["appearance","outline",1,"form-field"],["matInput","","formControlName","username","autocomplete","username"],["matPrefix",""],["matInput","","formControlName","password","autocomplete","current-password",3,"type"],["mat-icon-button","","matSuffix","","type","button",3,"click"],["mat-raised-button","","color","primary","type","submit",1,"login-button",3,"disabled"],["diameter","20"],["align","end"],["mat-button","","routerLink","/forgot-password"]],template:function(m,o){if(m&1&&(t(0,"div",0)(1,"mat-card",1)(2,"mat-card-header")(3,"mat-icon",2),n(4,"workflow"),i(),t(5,"mat-card-title"),n(6,"Sonarworks Workflow"),i(),t(7,"mat-card-subtitle"),n(8,"Sign in to your account"),i()(),t(9,"mat-card-content"),s(10,ne,2,1,"div",3),t(11,"form",4),f("ngSubmit",function(){return o.onSubmit()}),t(12,"mat-form-field",5)(13,"mat-label"),n(14,"Username"),i(),p(15,"input",6),t(16,"mat-icon",7),n(17,"person"),i(),s(18,oe,2,0,"mat-error"),i(),t(19,"mat-form-field",5)(20,"mat-label"),n(21,"Password"),i(),p(22,"input",8),t(23,"mat-icon",7),n(24,"lock"),i(),t(25,"button",9),f("click",function(){return o.hidePassword=!o.hidePassword}),t(26,"mat-icon"),n(27),i()(),s(28,ae,2,0,"mat-error"),i(),t(29,"button",10),s(30,me,1,0,"mat-spinner",11)(31,se,1,0),i()()(),t(32,"mat-card-actions",12)(33,"a",13),n(34,"Forgot Password?"),i()()()()),m&2){let c,b;a(10),l(o.errorMessage?10:-1),a(),g("formGroup",o.loginForm),a(7),l((c=o.loginForm.get("username"))!=null&&c.hasError("required")?18:-1),a(4),g("type",o.hidePassword?"password":"text"),a(5),M(o.hidePassword?"visibility_off":"visibility"),a(),l((b=o.loginForm.get("password"))!=null&&b.hasError("required")?28:-1),a(),g("disabled",o.loading),a(),l(o.loading?30:31)}},dependencies:[S,T,k,y,x,E,F,I,P,w,Y,D,z,W,V,H,U,G,$,Z,J,K,Q,X,te,ee,j,R,O,A,q,N,re,ie],styles:[".login-container[_ngcontent-%COMP%]{min-height:100vh;display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg,#1976d2,#1565c0)}.login-card[_ngcontent-%COMP%]{width:100%;max-width:400px;margin:1rem}mat-card-header[_ngcontent-%COMP%]{margin-bottom:1rem}.form-field[_ngcontent-%COMP%]{width:100%;margin-bottom:.5rem}.login-button[_ngcontent-%COMP%]{width:100%;height:48px;font-size:1rem}.error-message[_ngcontent-%COMP%]{background:#ffebee;color:#c62828;padding:.75rem;border-radius:4px;margin-bottom:1rem}"]})}return r})();export{ke as LoginComponent};
