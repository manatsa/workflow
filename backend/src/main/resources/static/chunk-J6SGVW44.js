import{a as xe}from"./chunk-3U3ZRNJ5.js";import{a as _e}from"./chunk-KHA6H2VC.js";import{a as ne,c as re}from"./chunk-IVI3BL2S.js";import{h as oe}from"./chunk-ZLEDUOR5.js";import{b as te,c as ie}from"./chunk-C5XODKZL.js";import"./chunk-LU6VCXUA.js";import{b as Q,c as W,i as X,j as Y,l as Z,m as ee}from"./chunk-2AGPTHDJ.js";import{d as L,f as M,i as V,j as I,n as D,q as B,r as O,v as A,w as N,x as P}from"./chunk-QGDZCCER.js";import{a as ae,b as le,c as me,d as se,e as ce,f as de,g as pe,h as ue,i as Ce,j as ge,k as fe}from"./chunk-ZLHYE5PR.js";import{a as G,b as U,c as z,f as J,h as K}from"./chunk-BTSRKJZZ.js";import"./chunk-MNRHFUYD.js";import"./chunk-UF7Y5AYJ.js";import"./chunk-PMYQJTBZ.js";import{Aa as j,q as F,va as q,wa as R,xa as $,ya as H}from"./chunk-37H25STD.js";import{Eb as C,Jb as v,Ob as n,Pb as o,Qb as f,Rb as _,Sb as x,Ub as w,Yb as u,Zb as g,eb as s,gc as T,hc as r,ic as h,jb as y,jc as b,oa as c,pa as d,qb as k,wb as p}from"./chunk-UYCZSUYP.js";function he(t,l){t&1&&(n(0,"th",21),r(1,"Code"),o())}function ye(t,l){if(t&1&&(n(0,"td",22),r(1),o()),t&2){let e=l.$implicit;s(),h(e.code)}}function ve(t,l){t&1&&(n(0,"th",21),r(1,"Name"),o())}function Se(t,l){if(t&1&&(n(0,"td",22),r(1),o()),t&2){let e=l.$implicit;s(),h(e.name)}}function we(t,l){t&1&&(n(0,"th",21),r(1,"Description"),o())}function Ee(t,l){if(t&1&&(n(0,"td",22),r(1),o()),t&2){let e=l.$implicit;s(),h(e.description)}}function be(t,l){t&1&&(n(0,"th",21),r(1,"Status"),o())}function Me(t,l){if(t&1&&(n(0,"td",22)(1,"mat-chip",23),r(2),o()()),t&2){let e=l.$implicit;s(),C("color",e.isActive?"primary":"warn"),s(),b(" ",e.isActive?"Active":"Inactive"," ")}}function ke(t,l){t&1&&(n(0,"th",21),r(1,"Actions"),o())}function Te(t,l){if(t&1){let e=w();n(0,"td",22)(1,"button",24),u("click",function(){let i=c(e).$implicit,m=g();return d(m.editCategory(i))}),n(2,"mat-icon"),r(3,"edit"),o()(),n(4,"button",24),u("click",function(){let i=c(e).$implicit,m=g();return d(m.toggleStatus(i))}),n(5,"mat-icon"),r(6),o()(),n(7,"button",25),u("click",function(){let i=c(e).$implicit,m=g();return d(m.deleteCategory(i))}),n(8,"mat-icon"),r(9,"delete"),o()()()}if(t&2){let e=l.$implicit;s(6),h(e.isActive?"visibility_off":"visibility")}}function Fe(t,l){t&1&&f(0,"tr",26)}function Le(t,l){t&1&&f(0,"tr",27)}function Ve(t,l){t&1&&(n(0,"div",19)(1,"mat-icon"),r(2,"category"),o(),n(3,"p"),r(4,"No categories found. Add your first category."),o()())}function Ie(t,l){t&1&&(n(0,"mat-error"),r(1,"Code is required"),o())}function De(t,l){t&1&&(n(0,"mat-error"),r(1,"Name is required"),o())}function Be(t,l){if(t&1){let e=w();n(0,"mat-card",20)(1,"mat-card-header")(2,"mat-card-title"),r(3),o()(),n(4,"mat-card-content")(5,"form",28),u("ngSubmit",function(){c(e);let i=g();return d(i.saveCategory())}),n(6,"mat-form-field",29)(7,"mat-label"),r(8,"Code"),o(),f(9,"input",30),p(10,Ie,2,0,"mat-error"),o(),n(11,"mat-form-field",29)(12,"mat-label"),r(13,"Name"),o(),f(14,"input",31),p(15,De,2,0,"mat-error"),o(),n(16,"mat-form-field",29)(17,"mat-label"),r(18,"Description"),o(),f(19,"textarea",32),o(),n(20,"div",33)(21,"button",34),u("click",function(){c(e);let i=g();return d(i.showForm=!1)}),r(22,"Cancel"),o(),n(23,"button",35),r(24),o()()()()()}if(t&2){let e,a,i=g();s(3),h(i.editingCategory?"Edit Category":"Add Category"),s(2),C("formGroup",i.categoryForm),s(5),v((e=i.categoryForm.get("code"))!=null&&e.hasError("required")?10:-1),s(5),v((a=i.categoryForm.get("name"))!=null&&a.hasError("required")?15:-1),s(8),C("disabled",i.loading||i.categoryForm.invalid),s(),b(" ",i.editingCategory?"Update":"Create"," ")}}var nt=(()=>{class t{fb;userService;importExportService;snackBar;categories=[];displayedColumns=["code","name","description","status","actions"];showForm=!1;editingCategory=null;loading=!1;categoryForm;constructor(e,a,i,m){this.fb=e,this.userService=a,this.importExportService=i,this.snackBar=m,this.categoryForm=this.fb.group({code:["",M.required],name:["",M.required],description:[""]})}ngOnInit(){this.loadCategories()}loadCategories(){this.userService.getCategories().subscribe(e=>{e.success&&(this.categories=e.data)})}editCategory(e){this.editingCategory=e,this.showForm=!0,this.categoryForm.patchValue({code:e.code,name:e.name,description:e.description})}saveCategory(){if(this.categoryForm.invalid)return;this.loading=!0;let e=this.categoryForm.value;(this.editingCategory?this.userService.updateCategory(this.editingCategory.id,e):this.userService.createCategory(e)).subscribe({next:i=>{this.loading=!1,i.success&&(this.snackBar.open(this.editingCategory?"Category updated":"Category created","Close",{duration:3e3}),this.showForm=!1,this.editingCategory=null,this.categoryForm.reset(),this.loadCategories())},error:i=>{this.loading=!1,this.snackBar.open(i.error?.message||"Operation failed","Close",{duration:3e3})}})}toggleStatus(e){(e.isActive?this.userService.deactivateCategory(e.id):this.userService.activateCategory(e.id)).subscribe({next:()=>{this.snackBar.open(e.isActive?"Category deactivated":"Category activated","Close",{duration:3e3}),this.loadCategories()},error:i=>{this.snackBar.open(i.error?.message||"Operation failed","Close",{duration:3e3})}})}deleteCategory(e){confirm(`Are you sure you want to delete "${e.name}"?`)&&this.userService.deleteCategory(e.id).subscribe({next:()=>{this.snackBar.open("Category deleted","Close",{duration:3e3}),this.loadCategories()},error:a=>{this.snackBar.open(a.error?.message||"Failed to delete","Close",{duration:3e3})}})}downloadTemplate(){this.importExportService.downloadTemplate("categories").subscribe({next:e=>{this.importExportService.downloadFile(e,"Categories_Template.xlsx"),this.snackBar.open("Template downloaded","Close",{duration:3e3})},error:()=>this.snackBar.open("Failed to download template","Close",{duration:3e3})})}importFromExcel(e){let a=e.target;if(!a.files?.length)return;let i=a.files[0];this.importExportService.importFromExcel("categories",i).subscribe({next:m=>{m.success?(this.snackBar.open(m.message||"Categories imported","Close",{duration:3e3}),this.loadCategories()):this.snackBar.open(m.message||"Failed to import","Close",{duration:3e3}),a.value=""},error:m=>{this.snackBar.open(m.error?.message||"Failed to import","Close",{duration:3e3}),a.value=""}})}exportToExcel(){this.importExportService.exportToExcel("categories").subscribe({next:e=>{this.importExportService.downloadFile(e,"Categories_Export.xlsx"),this.snackBar.open("Categories exported","Close",{duration:3e3})},error:()=>this.snackBar.open("Failed to export","Close",{duration:3e3})})}static \u0275fac=function(a){return new(a||t)(y(A),y(_e),y(xe),y(te))};static \u0275cmp=k({type:t,selectors:[["app-category-list"]],decls:46,vars:5,consts:[["fileInput",""],[1,"category-list-container"],[1,"header"],[1,"header-actions"],["mat-stroked-button","",3,"click"],["hidden","","type","file","accept",".xlsx",3,"change"],["mat-raised-button","","color","primary",3,"click"],[1,"content-grid"],[1,"table-card"],["mat-table","",1,"full-width",3,"dataSource"],["matColumnDef","code"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","name"],["matColumnDef","description"],["matColumnDef","status"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[1,"no-data"],[1,"form-card"],["mat-header-cell",""],["mat-cell",""],["selected","",3,"color"],["mat-icon-button","",3,"click"],["mat-icon-button","","color","warn",3,"click"],["mat-header-row",""],["mat-row",""],[3,"ngSubmit","formGroup"],["appearance","outline",1,"form-field"],["matInput","","formControlName","code"],["matInput","","formControlName","name"],["matInput","","formControlName","description","rows","3"],[1,"form-actions"],["mat-button","","type","button",3,"click"],["mat-raised-button","","color","primary","type","submit",3,"disabled"]],template:function(a,i){if(a&1){let m=w();n(0,"div",1)(1,"div",2)(2,"h1"),r(3,"Categories (Industries)"),o(),n(4,"div",3)(5,"button",4),u("click",function(){return c(m),d(i.downloadTemplate())}),n(6,"mat-icon"),r(7,"description"),o(),r(8," Template "),o(),n(9,"button",4),u("click",function(){c(m);let E=T(14);return d(E.click())}),n(10,"mat-icon"),r(11,"upload"),o(),r(12," Import "),o(),n(13,"input",5,0),u("change",function(E){return c(m),d(i.importFromExcel(E))}),o(),n(15,"button",4),u("click",function(){return c(m),d(i.exportToExcel())}),n(16,"mat-icon"),r(17,"download"),o(),r(18," Export "),o(),n(19,"button",6),u("click",function(){return c(m),i.showForm=!0,i.editingCategory=null,d(i.categoryForm.reset())}),n(20,"mat-icon"),r(21,"add"),o(),r(22," Add Category "),o()()(),n(23,"div",7)(24,"mat-card",8)(25,"mat-card-content")(26,"table",9),_(27,10),p(28,he,2,0,"th",11)(29,ye,2,1,"td",12),x(),_(30,13),p(31,ve,2,0,"th",11)(32,Se,2,1,"td",12),x(),_(33,14),p(34,we,2,0,"th",11)(35,Ee,2,1,"td",12),x(),_(36,15),p(37,be,2,0,"th",11)(38,Me,3,2,"td",12),x(),_(39,16),p(40,ke,2,0,"th",11)(41,Te,10,1,"td",12),x(),p(42,Fe,1,0,"tr",17)(43,Le,1,0,"tr",18),o(),p(44,Ve,5,0,"div",19),o()(),p(45,Be,25,6,"mat-card",20),o()()}a&2&&(s(26),C("dataSource",i.categories),s(16),C("matHeaderRowDef",i.displayedColumns),s(),C("matRowDefColumns",i.displayedColumns),s(),v(i.categories.length===0?44:-1),s(),v(i.showForm?45:-1))},dependencies:[F,N,D,L,V,I,P,B,O,K,G,z,J,U,fe,ae,me,pe,se,le,ue,ce,de,Ce,ge,Y,X,Q,W,ee,Z,j,H,$,R,q,ie,re,ne,oe],styles:[".category-list-container[_ngcontent-%COMP%]{padding:1rem}.header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem}.header-actions[_ngcontent-%COMP%]{display:flex;gap:.5rem;align-items:center}.content-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 400px;gap:1rem}@media (max-width: 900px){.content-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}.full-width[_ngcontent-%COMP%]{width:100%}.no-data[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:2rem;color:#666}.no-data[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:48px;width:48px;height:48px;opacity:.5}.form-field[_ngcontent-%COMP%]{width:100%;margin-bottom:.5rem}.form-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:.5rem;margin-top:1rem}"]})}return t})();export{nt as CategoryListComponent};
