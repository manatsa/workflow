import{a as Ft}from"./chunk-DVQGFA7F.js";import"./chunk-F5X5MWHG.js";import{a as bt,b as yt}from"./chunk-4M7UJXFZ.js";import"./chunk-MS4AQ6UA.js";import{a as wt,b as Et}from"./chunk-B7S7HKPH.js";import{c as k}from"./chunk-RP3FIGZU.js";import{a as lt,b as dt}from"./chunk-LUBHRDD6.js";import"./chunk-22QFHSXK.js";import{a as st,b as ft,c as ut,d as _t,e as Ct,f as ht,g as Dt,h as gt,i as xt,j as Mt,k as St}from"./chunk-S7OVDIVJ.js";import"./chunk-KPLEND2O.js";import{a as vt}from"./chunk-3HKR6USX.js";import{a as pt,b as ct}from"./chunk-XQHIDIE5.js";import"./chunk-LETYTNCA.js";import"./chunk-M3GLKEYP.js";import{a as rt,c as ot,d as mt}from"./chunk-ZK2UDSKG.js";import{b as et,c as nt,d as it,i as at}from"./chunk-FHBRY4FZ.js";import{d as N,f as S,h as V,i as B,k as A,l as H,n as R,o as $,r as q,s as j,t as G}from"./chunk-JITRQZ7S.js";import{a as Q,b as X,c as Y,f as Z,h as tt}from"./chunk-LB6LFADN.js";import"./chunk-Q5RCCGFX.js";import"./chunk-W4XF3NOO.js";import{m as P,qa as W,ra as U,sa as z,ta as J,va as K}from"./chunk-LBWRLA47.js";import{Ab as c,Cb as I,Fb as h,Ib as w,Jb as E,Kb as i,Lb as n,Mb as s,Nb as _,Ob as C,Qb as b,Ub as f,Vb as D,bb as m,dc as a,ec as u,fc as y,gb as M,hc as T,ic as L,jc as O,na as g,nb as F,oa as x,tb as p}from"./chunk-5XIHPI6O.js";var It=(t,o)=>o.id;function Tt(t,o){if(t&1&&(i(0,"mat-option",7),a(1),n()),t&2){let e=o.$implicit;c("value",e.id),m(),u(e.name)}}function Lt(t,o){t&1&&(i(0,"th",24),a(1,"Code"),n())}function Ot(t,o){if(t&1&&(i(0,"td",25),a(1),n()),t&2){let e=o.$implicit;m(),u(e.code)}}function Pt(t,o){t&1&&(i(0,"th",24),a(1,"Name"),n())}function kt(t,o){if(t&1&&(i(0,"td",25),a(1),n()),t&2){let e=o.$implicit;m(),u(e.name)}}function Nt(t,o){t&1&&(i(0,"th",24),a(1,"Corporate"),n())}function Vt(t,o){if(t&1&&(i(0,"td",25),a(1),n()),t&2){let e=o.$implicit;m(),u(e.corporateName||"Global")}}function Bt(t,o){t&1&&(i(0,"th",24),a(1,"Head of Department"),n())}function At(t,o){if(t&1&&(i(0,"td",25),a(1),n()),t&2){let e=o.$implicit;m(),u(e.headOfDepartment||"-")}}function Ht(t,o){t&1&&(i(0,"th",24),a(1,"Status"),n())}function Rt(t,o){if(t&1&&(i(0,"td",25)(1,"mat-chip",26),a(2),n()()),t&2){let e=o.$implicit;m(),c("color",e.isActive?"primary":"warn"),m(),y(" ",e.isActive?"Active":"Inactive"," ")}}function $t(t,o){t&1&&(i(0,"th",24),a(1,"Actions"),n())}function qt(t,o){if(t&1){let e=b();i(0,"td",25)(1,"button",27),f("click",function(){let r=g(e).$implicit,l=D();return x(l.editDepartment(r))}),i(2,"mat-icon"),a(3,"edit"),n()(),i(4,"button",28),f("click",function(){let r=g(e).$implicit,l=D();return x(l.deleteDepartment(r))}),i(5,"mat-icon"),a(6,"delete"),n()()()}}function jt(t,o){t&1&&s(0,"tr",29)}function Gt(t,o){t&1&&s(0,"tr",30)}function Wt(t,o){t&1&&(i(0,"div",22)(1,"mat-icon"),a(2,"business"),n(),i(3,"p"),a(4,"No departments found. Add your first department."),n()())}function Ut(t,o){t&1&&(i(0,"mat-error"),a(1,"Code is required"),n())}function zt(t,o){t&1&&(i(0,"mat-error"),a(1,"Name is required"),n())}function Jt(t,o){if(t&1&&(i(0,"mat-option",7),a(1),n()),t&2){let e=o.$implicit;c("value",e.id),m(),u(e.name)}}function Kt(t,o){t&1&&(i(0,"mat-error"),a(1,"Invalid email format"),n())}function Qt(t,o){if(t&1){let e=b();i(0,"mat-card",23)(1,"mat-card-header")(2,"mat-card-title"),a(3),n()(),i(4,"mat-card-content")(5,"form",31),f("ngSubmit",function(){g(e);let r=D();return x(r.saveDepartment())}),i(6,"div",32)(7,"mat-form-field",33)(8,"mat-label"),a(9,"Code"),n(),s(10,"input",34),p(11,Ut,2,0,"mat-error"),n(),i(12,"mat-form-field",33)(13,"mat-label"),a(14,"Name"),n(),s(15,"input",35),p(16,zt,2,0,"mat-error"),n()(),i(17,"mat-form-field",36)(18,"mat-label"),a(19,"Corporate (Optional)"),n(),i(20,"mat-select",37)(21,"mat-option",7),a(22,"-- Global (All Corporates) --"),n(),w(23,Jt,2,2,"mat-option",7,It),n(),i(25,"mat-hint"),a(26,"Leave empty for global department accessible to all corporates"),n()(),i(27,"mat-form-field",36)(28,"mat-label"),a(29,"Description"),n(),s(30,"textarea",38),n(),i(31,"mat-form-field",36)(32,"mat-label"),a(33,"Head of Department"),n(),s(34,"input",39),n(),i(35,"div",32)(36,"mat-form-field",33)(37,"mat-label"),a(38,"Contact Email"),n(),s(39,"input",40),p(40,Kt,2,0,"mat-error"),n(),i(41,"mat-form-field",33)(42,"mat-label"),a(43,"Contact Phone"),n(),s(44,"input",41),n()(),i(45,"div",42)(46,"button",43),f("click",function(){g(e);let r=D();return x(r.showForm=!1)}),a(47,"Cancel"),n(),i(48,"button",44),a(49),n()()()()()}if(t&2){let e,d,r,l=D();m(3),u(l.editingDepartment?"Edit Department":"Add Department"),m(2),c("formGroup",l.departmentForm),m(6),h((e=l.departmentForm.get("code"))!=null&&e.hasError("required")?11:-1),m(5),h((d=l.departmentForm.get("name"))!=null&&d.hasError("required")?16:-1),m(5),c("value",null),m(2),E(l.corporates),m(17),h((r=l.departmentForm.get("contactEmail"))!=null&&r.hasError("email")?40:-1),m(8),c("disabled",l.loading||l.departmentForm.invalid),m(),y(" ",l.editingDepartment?"Update":"Create"," ")}}var ve=(()=>{class t{fb;departmentService;userService;snackBar;departments=[];displayedDepartments=[];corporates=[];displayedColumns=["code","name","corporate","headOfDepartment","status","actions"];showForm=!1;editingDepartment=null;loading=!1;departmentForm;filterCorporateId=null;constructor(e,d,r,l){this.fb=e,this.departmentService=d,this.userService=r,this.snackBar=l,this.departmentForm=this.fb.group({code:["",S.required],name:["",S.required],description:[""],corporateId:[null],headOfDepartment:[""],contactEmail:["",S.email],contactPhone:[""]})}ngOnInit(){this.loadDepartments(),this.loadCorporates()}loadDepartments(){this.departmentService.getDepartments().subscribe(e=>{e.success&&(this.departments=e.data,this.applyFilters())})}loadCorporates(){this.userService.getActiveCorporates().subscribe(e=>{e.success&&(this.corporates=e.data)})}applyFilters(){let e=[...this.departments];this.filterCorporateId&&(e=e.filter(d=>d.corporateId===this.filterCorporateId)),this.displayedDepartments=e}clearFilters(){this.filterCorporateId=null,this.applyFilters()}openNewForm(){this.showForm=!0,this.editingDepartment=null,this.departmentForm.reset()}editDepartment(e){this.editingDepartment=e,this.showForm=!0,this.departmentForm.patchValue({code:e.code,name:e.name,description:e.description,corporateId:e.corporateId||null,headOfDepartment:e.headOfDepartment,contactEmail:e.contactEmail,contactPhone:e.contactPhone})}saveDepartment(){if(this.departmentForm.invalid)return;this.loading=!0;let e=this.departmentForm.value;(this.editingDepartment?this.departmentService.updateDepartment(this.editingDepartment.id,e):this.departmentService.createDepartment(e)).subscribe({next:r=>{this.loading=!1,r.success&&(this.snackBar.open(this.editingDepartment?"Department updated":"Department created","Close",{duration:3e3}),this.showForm=!1,this.editingDepartment=null,this.departmentForm.reset(),this.loadDepartments())},error:r=>{this.loading=!1,this.snackBar.open(r.error?.message||"Operation failed","Close",{duration:3e3})}})}deleteDepartment(e){confirm(`Are you sure you want to delete "${e.name}"?`)&&this.departmentService.deleteDepartment(e.id).subscribe({next:()=>{this.snackBar.open("Department deleted","Close",{duration:3e3}),this.loadDepartments()},error:d=>{this.snackBar.open(d.error?.message||"Failed to delete","Close",{duration:3e3})}})}static \u0275fac=function(d){return new(d||t)(M(q),M(Ft),M(vt),M(pt))};static \u0275cmp=F({type:t,selectors:[["app-department-list"]],decls:49,vars:9,consts:[[1,"department-list-container"],[1,"header"],["mat-raised-button","","color","primary",3,"click"],[1,"filter-card"],[1,"filter-row"],["appearance","outline"],[3,"ngModelChange","selectionChange","ngModel"],[3,"value"],["mat-button","",3,"click"],[1,"content-grid"],[1,"table-card"],["mat-table","",1,"full-width",3,"dataSource"],["matColumnDef","code"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","name"],["matColumnDef","corporate"],["matColumnDef","headOfDepartment"],["matColumnDef","status"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[1,"no-data"],[1,"form-card"],["mat-header-cell",""],["mat-cell",""],["selected","",3,"color"],["mat-icon-button","","matTooltip","Edit",3,"click"],["mat-icon-button","","color","warn","matTooltip","Delete",3,"click"],["mat-header-row",""],["mat-row",""],[3,"ngSubmit","formGroup"],[1,"form-row"],["appearance","outline",1,"form-field"],["matInput","","formControlName","code"],["matInput","","formControlName","name"],["appearance","outline",1,"form-field","full-width"],["formControlName","corporateId"],["matInput","","formControlName","description","rows","2"],["matInput","","formControlName","headOfDepartment"],["matInput","","formControlName","contactEmail","type","email"],["matInput","","formControlName","contactPhone"],[1,"form-actions"],["mat-button","","type","button",3,"click"],["mat-raised-button","","color","primary","type","submit",3,"disabled"]],template:function(d,r){d&1&&(i(0,"div",0)(1,"div",1)(2,"h1"),a(3,"Departments"),n(),i(4,"button",2),f("click",function(){return r.openNewForm()}),i(5,"mat-icon"),a(6,"add"),n(),a(7," Add Department "),n()(),i(8,"mat-card",3)(9,"mat-card-content")(10,"div",4)(11,"mat-form-field",5)(12,"mat-label"),a(13,"Filter by Corporate"),n(),i(14,"mat-select",6),O("ngModelChange",function(v){return L(r.filterCorporateId,v)||(r.filterCorporateId=v),v}),f("selectionChange",function(){return r.applyFilters()}),i(15,"mat-option",7),a(16,"-- All Corporates --"),n(),w(17,Tt,2,2,"mat-option",7,It),n()(),i(19,"button",8),f("click",function(){return r.clearFilters()}),i(20,"mat-icon"),a(21,"clear"),n(),a(22," Clear Filters "),n()()()(),i(23,"div",9)(24,"mat-card",10)(25,"mat-card-content")(26,"table",11),_(27,12),p(28,Lt,2,0,"th",13)(29,Ot,2,1,"td",14),C(),_(30,15),p(31,Pt,2,0,"th",13)(32,kt,2,1,"td",14),C(),_(33,16),p(34,Nt,2,0,"th",13)(35,Vt,2,1,"td",14),C(),_(36,17),p(37,Bt,2,0,"th",13)(38,At,2,1,"td",14),C(),_(39,18),p(40,Ht,2,0,"th",13)(41,Rt,3,2,"td",14),C(),_(42,19),p(43,$t,2,0,"th",13)(44,qt,7,0,"td",14),C(),p(45,jt,1,0,"tr",20)(46,Gt,1,0,"tr",21),n(),p(47,Wt,5,0,"div",22),n()(),p(48,Qt,50,8,"mat-card",23),n()()),d&2&&(m(14),T("ngModel",r.filterCorporateId),m(),c("value",null),m(2),E(r.corporates),m(6),I("with-form",r.showForm),m(3),c("dataSource",r.displayedDepartments),m(19),c("matHeaderRowDef",r.displayedColumns),m(),c("matRowDefColumns",r.displayedColumns),m(),h(r.displayedDepartments.length===0?47:-1),m(),h(r.showForm?48:-1))},dependencies:[P,j,H,N,V,B,A,G,R,$,tt,Q,Y,Z,X,St,st,ut,Dt,_t,ft,gt,Ct,ht,xt,Mt,rt,at,et,it,nt,mt,ot,K,J,z,U,W,ct,dt,lt,Et,wt,k,yt,bt],styles:[".department-list-container[_ngcontent-%COMP%]{padding:1rem}.header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem}.filter-card[_ngcontent-%COMP%]{margin-bottom:1rem}.filter-row[_ngcontent-%COMP%]{display:flex;gap:1rem;align-items:center;flex-wrap:wrap}.filter-row[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{min-width:200px}.content-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr;gap:1rem}.content-grid.with-form[_ngcontent-%COMP%]{grid-template-columns:1fr 500px}@media (max-width: 1100px){.content-grid.with-form[_ngcontent-%COMP%]{grid-template-columns:1fr}}.full-width[_ngcontent-%COMP%]{width:100%}.no-data[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:2rem;color:#666}.no-data[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:48px;width:48px;height:48px;opacity:.5}.form-row[_ngcontent-%COMP%]{display:flex;gap:1rem}.form-field[_ngcontent-%COMP%]{flex:1;margin-bottom:.5rem}.form-field.full-width[_ngcontent-%COMP%]{width:100%}.form-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:.5rem;margin-top:1rem}table[_ngcontent-%COMP%]{width:100%}.mat-column-actions[_ngcontent-%COMP%]{width:120px;text-align:center}"]})}return t})();export{ve as DepartmentListComponent};
