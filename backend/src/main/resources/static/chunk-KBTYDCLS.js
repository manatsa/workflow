import{b as ne,c as ae}from"./chunk-C5XODKZL.js";import"./chunk-LU6VCXUA.js";import{a as te,b as re}from"./chunk-CDWC6WKW.js";import{b as $,c as J,e as K,f as Q,i as W,j as X,l as Y,m as ee}from"./chunk-2AGPTHDJ.js";import{d as y,f as P,i as x,j as F,n as k,q as N,r as O,v as q,x as I}from"./chunk-QGDZCCER.js";import{a as z,b as D,c as G,d as U,f as R,g as H,h as Z}from"./chunk-BTSRKJZZ.js";import"./chunk-PMYQJTBZ.js";import{a as V}from"./chunk-W7JX3HPD.js";import{c as E}from"./chunk-M6HZK7Y7.js";import{Aa as j,q as S,va as T,wa as A,xa as B,ya as L}from"./chunk-37H25STD.js";import{Eb as u,Gb as p,Jb as d,Ob as t,Pb as r,Qb as h,Yb as g,Zb as v,eb as a,hc as n,ic as f,jb as w,qb as b,wb as c}from"./chunk-UYCZSUYP.js";function ie(i,l){if(i&1&&(t(0,"div",3),n(1),r()),i&2){let o=v();a(),f(o.errorMessage)}}function oe(i,l){i&1&&(t(0,"mat-error"),n(1,"Current password is required"),r())}function se(i,l){i&1&&(t(0,"mat-error"),n(1,"New password is required"),r())}function me(i,l){i&1&&(t(0,"mat-error"),n(1,"Password must be at least 8 characters"),r())}function de(i,l){i&1&&(t(0,"mat-error"),n(1,"Please confirm your new password"),r())}function le(i,l){i&1&&(t(0,"mat-error"),n(1,"Passwords do not match"),r())}function ce(i,l){i&1&&h(0,"mat-spinner",13)}function ue(i,l){i&1&&n(0," Change Password ")}var Ie=(()=>{class i{fb;authService;router;snackBar;changePasswordForm;loading=!1;hideCurrentPassword=!0;hideNewPassword=!0;hideConfirmPassword=!0;errorMessage="";constructor(o,s,e,m){this.fb=o,this.authService=s,this.router=e,this.snackBar=m,this.changePasswordForm=this.fb.group({currentPassword:["",P.required],newPassword:["",[P.required,P.minLength(8)]],confirmPassword:["",P.required]},{validators:this.passwordMatchValidator})}passwordMatchValidator(o){let s=o.get("newPassword")?.value,e=o.get("confirmPassword")?.value;return s===e?null:{passwordMismatch:!0}}get newPassword(){return this.changePasswordForm.get("newPassword")?.value||""}get hasMinLength(){return this.newPassword.length>=8}get hasUppercase(){return/[A-Z]/.test(this.newPassword)}get hasLowercase(){return/[a-z]/.test(this.newPassword)}get hasNumber(){return/[0-9]/.test(this.newPassword)}get hasSpecial(){return/[!@#$%^&*(),.?":{}|<>]/.test(this.newPassword)}onSubmit(){if(this.changePasswordForm.invalid)return;this.loading=!0,this.errorMessage="";let{currentPassword:o,newPassword:s}=this.changePasswordForm.value;this.authService.changePassword(o,s).subscribe({next:e=>{this.loading=!1,e.success?(this.snackBar.open("Password changed successfully","Close",{duration:3e3}),this.router.navigate(["/dashboard"])):this.errorMessage=e.message||"Failed to change password"},error:e=>{this.loading=!1,this.errorMessage=e.error?.message||"An error occurred. Please try again."}})}static \u0275fac=function(s){return new(s||i)(w(q),w(V),w(E),w(ne))};static \u0275cmp=b({type:i,selectors:[["app-change-password"]],decls:61,vars:25,consts:[[1,"change-password-container"],[1,"change-password-card"],["mat-card-avatar",""],[1,"error-message"],[3,"ngSubmit","formGroup"],["appearance","outline",1,"form-field"],["matInput","","formControlName","currentPassword","autocomplete","current-password",3,"type"],["matPrefix",""],["mat-icon-button","","matSuffix","","type","button",3,"click"],["matInput","","formControlName","newPassword","autocomplete","new-password",3,"type"],["matInput","","formControlName","confirmPassword","autocomplete","new-password",3,"type"],[1,"password-requirements"],["mat-raised-button","","color","primary","type","submit",1,"submit-button",3,"disabled"],["diameter","20"]],template:function(s,e){if(s&1&&(t(0,"div",0)(1,"mat-card",1)(2,"mat-card-header")(3,"mat-icon",2),n(4,"lock"),r(),t(5,"mat-card-title"),n(6,"Change Password"),r(),t(7,"mat-card-subtitle"),n(8,"Update your account password"),r()(),t(9,"mat-card-content"),c(10,ie,2,1,"div",3),t(11,"form",4),g("ngSubmit",function(){return e.onSubmit()}),t(12,"mat-form-field",5)(13,"mat-label"),n(14,"Current Password"),r(),h(15,"input",6),t(16,"mat-icon",7),n(17,"lock"),r(),t(18,"button",8),g("click",function(){return e.hideCurrentPassword=!e.hideCurrentPassword}),t(19,"mat-icon"),n(20),r()(),c(21,oe,2,0,"mat-error"),r(),t(22,"mat-form-field",5)(23,"mat-label"),n(24,"New Password"),r(),h(25,"input",9),t(26,"mat-icon",7),n(27,"lock_outline"),r(),t(28,"button",8),g("click",function(){return e.hideNewPassword=!e.hideNewPassword}),t(29,"mat-icon"),n(30),r()(),c(31,se,2,0,"mat-error")(32,me,2,0,"mat-error"),r(),t(33,"mat-form-field",5)(34,"mat-label"),n(35,"Confirm New Password"),r(),h(36,"input",10),t(37,"mat-icon",7),n(38,"lock_outline"),r(),t(39,"button",8),g("click",function(){return e.hideConfirmPassword=!e.hideConfirmPassword}),t(40,"mat-icon"),n(41),r()(),c(42,de,2,0,"mat-error")(43,le,2,0,"mat-error"),r(),t(44,"div",11)(45,"h4"),n(46,"Password Requirements:"),r(),t(47,"ul")(48,"li"),n(49,"At least 8 characters"),r(),t(50,"li"),n(51,"At least one uppercase letter"),r(),t(52,"li"),n(53,"At least one lowercase letter"),r(),t(54,"li"),n(55,"At least one number"),r(),t(56,"li"),n(57,"At least one special character"),r()()(),t(58,"button",12),c(59,ce,1,0,"mat-spinner",13)(60,ue,1,0),r()()()()()),s&2){let m,C,_,M;a(10),d(e.errorMessage?10:-1),a(),u("formGroup",e.changePasswordForm),a(4),u("type",e.hideCurrentPassword?"password":"text"),a(5),f(e.hideCurrentPassword?"visibility_off":"visibility"),a(),d((m=e.changePasswordForm.get("currentPassword"))!=null&&m.hasError("required")?21:-1),a(4),u("type",e.hideNewPassword?"password":"text"),a(5),f(e.hideNewPassword?"visibility_off":"visibility"),a(),d((C=e.changePasswordForm.get("newPassword"))!=null&&C.hasError("required")?31:-1),a(),d((_=e.changePasswordForm.get("newPassword"))!=null&&_.hasError("minlength")?32:-1),a(4),u("type",e.hideConfirmPassword?"password":"text"),a(5),f(e.hideConfirmPassword?"visibility_off":"visibility"),a(),d((M=e.changePasswordForm.get("confirmPassword"))!=null&&M.hasError("required")?42:-1),a(),d(e.changePasswordForm.hasError("passwordMismatch")?43:-1),a(5),p("met",e.hasMinLength),a(2),p("met",e.hasUppercase),a(2),p("met",e.hasLowercase),a(2),p("met",e.hasNumber),a(2),p("met",e.hasSpecial),a(2),u("disabled",e.loading),a(),d(e.loading?59:60)}},dependencies:[S,I,k,y,x,F,N,O,Z,z,H,G,R,U,D,X,W,$,J,K,Q,ee,Y,j,L,B,A,T,re,te,ae],styles:['@charset "UTF-8";.change-password-container[_ngcontent-%COMP%]{padding:1rem;display:flex;justify-content:center}.change-password-card[_ngcontent-%COMP%]{width:100%;max-width:500px}mat-card-header[_ngcontent-%COMP%]{margin-bottom:1rem}.form-field[_ngcontent-%COMP%]{width:100%;margin-bottom:.5rem}.submit-button[_ngcontent-%COMP%]{width:100%;height:48px;font-size:1rem}.error-message[_ngcontent-%COMP%]{background:#ffebee;color:#c62828;padding:.75rem;border-radius:4px;margin-bottom:1rem}.password-requirements[_ngcontent-%COMP%]{background:#f5f5f5;padding:1rem;border-radius:4px;margin-bottom:1rem}.password-requirements[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 .5rem;font-size:.875rem}.password-requirements[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{margin:0;padding-left:1.25rem;font-size:.8rem}.password-requirements[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{color:#666;margin-bottom:.25rem}.password-requirements[_ngcontent-%COMP%]   li.met[_ngcontent-%COMP%]{color:#2e7d32}.password-requirements[_ngcontent-%COMP%]   li.met[_ngcontent-%COMP%]::marker{content:"\\2713  "}']})}return i})();export{Ie as ChangePasswordComponent};
